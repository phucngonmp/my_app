const cd=()=>{};var fa={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uu=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let o=i.charCodeAt(n);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},fd=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const o=i[t++];if(o<128)e[n++]=String.fromCharCode(o);else if(o>191&&o<224){const r=i[t++];e[n++]=String.fromCharCode((o&31)<<6|r&63)}else if(o>239&&o<365){const r=i[t++],l=i[t++],c=i[t++],d=((o&7)<<18|(r&63)<<12|(l&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const r=i[t++],l=i[t++];e[n++]=String.fromCharCode((o&15)<<12|(r&63)<<6|l&63)}}return e.join("")},Ou={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let o=0;o<i.length;o+=3){const r=i[o],l=o+1<i.length,c=l?i[o+1]:0,d=o+2<i.length,f=d?i[o+2]:0,p=r>>2,g=(r&3)<<4|c>>4;let y=(c&15)<<2|f>>6,A=f&63;d||(A=64,l||(y=64)),n.push(t[p],t[g],t[y],t[A])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(Uu(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):fd(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let o=0;o<i.length;){const r=t[i.charAt(o++)],c=o<i.length?t[i.charAt(o)]:0;++o;const f=o<i.length?t[i.charAt(o)]:64;++o;const g=o<i.length?t[i.charAt(o)]:64;if(++o,r==null||c==null||f==null||g==null)throw new dd;const y=r<<2|c>>4;if(n.push(y),f!==64){const A=c<<4&240|f>>2;if(n.push(A),g!==64){const w=f<<6&192|g;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class dd extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const hd=function(i){const e=Uu(i);return Ou.encodeByteArray(e,!0)},bi=function(i){return hd(i).replace(/\./g,"")},pd=function(i){try{return Ou.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function md(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gd=()=>md().__FIREBASE_DEFAULTS__,yd=()=>{if(typeof process>"u"||typeof fa>"u")return;const i=fa.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},_d=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&pd(i[1]);return e&&JSON.parse(e)},Lr=()=>{try{return cd()||gd()||yd()||_d()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},vd=i=>{var e,t;return(t=(e=Lr())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[i]},Td=i=>{const e=vd(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},Bu=()=>{var i;return(i=Lr())===null||i===void 0?void 0:i.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(i){return i.endsWith(".cloudworkstations.dev")}async function Ed(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",o=i.iat||0,r=i.sub||i.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:o,exp:o+3600,auth_time:o,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},i);return[bi(JSON.stringify(t)),bi(JSON.stringify(l)),""].join(".")}const Ln={};function Id(){const i={prod:[],emulator:[]};for(const e of Object.keys(Ln))Ln[e]?i.emulator.push(e):i.prod.push(e);return i}function Sd(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let da=!1;function wd(i,e){if(typeof window>"u"||typeof document>"u"||!br(window.location.host)||Ln[i]===e||Ln[i]||da)return;Ln[i]=e;function t(y){return`__firebase__banner__${y}`}const n="__firebase__banner",r=Id().prod.length>0;function l(){const y=document.getElementById(n);y&&y.remove()}function c(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function d(y,A){y.setAttribute("width","24"),y.setAttribute("id",A),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function f(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{da=!0,l()},y}function p(y,A){y.setAttribute("id",A),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function g(){const y=Sd(n),A=t("text"),w=document.getElementById(A)||document.createElement("span"),M=t("learnmore"),D=document.getElementById(M)||document.createElement("a"),F=t("preprendIcon"),b=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const O=y.element;c(O),p(D,M);const q=f();d(b,F),O.append(b,w,D,q),document.body.appendChild(O)}r?(w.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rd(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Pd(){var i;const e=(i=Lr())===null||i===void 0?void 0:i.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function xd(){return!Pd()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Md(){try{return typeof indexedDB=="object"}catch{return!1}}function Dd(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(n);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var r;e(((r=o.error)===null||r===void 0?void 0:r.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd="FirebaseError";class un extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=Nd,Object.setPrototypeOf(this,un.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$u.prototype.create)}}class $u{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},o=`${this.service}/${e}`,r=this.errors[e],l=r?Vd(r,n):"Error",c=`${this.serviceName}: ${l} (${o}).`;return new un(o,c,n)}}function Vd(i,e){return i.replace(kd,(t,n)=>{const o=e[n];return o!=null?String(o):`<${n}?>`})}const kd=/\{\$([^}]+)}/g;function Fi(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const o of t){if(!n.includes(o))return!1;const r=i[o],l=e[o];if(ha(r)&&ha(l)){if(!Fi(r,l))return!1}else if(r!==l)return!1}for(const o of n)if(!t.includes(o))return!1;return!0}function ha(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ui(i){return i&&i._delegate?i._delegate:i}class $n{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Cd;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&n.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e?.identifier),o=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(o)return null;throw r}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Fd(e))try{this.getOrInitializeService({instanceIdentifier:St})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:o});n.resolve(r)}catch{}}}}clearInstance(e=St){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=St){return this.instances.has(e)}getOptions(e=St){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[r,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(r);n===c&&l.resolve(o)}return o}onInit(e,t){var n;const o=this.normalizeInstanceIdentifier(t),r=(n=this.onInitCallbacks.get(o))!==null&&n!==void 0?n:new Set;r.add(e),this.onInitCallbacks.set(o,r);const l=this.instances.get(o);return l&&e(l,o),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const o of n)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:bd(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=St){return this.component?this.component.multipleInstances?e:St:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bd(i){return i===St?void 0:i}function Fd(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Ld(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var te;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(te||(te={}));const Od={debug:te.DEBUG,verbose:te.VERBOSE,info:te.INFO,warn:te.WARN,error:te.ERROR,silent:te.SILENT},Bd=te.INFO,$d={[te.DEBUG]:"log",[te.VERBOSE]:"log",[te.INFO]:"info",[te.WARN]:"warn",[te.ERROR]:"error"},Gd=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),o=$d[e];if(o)console[o](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Gu{constructor(e){this.name=e,this._logLevel=Bd,this._logHandler=Gd,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in te))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Od[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,te.DEBUG,...e),this._logHandler(this,te.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,te.VERBOSE,...e),this._logHandler(this,te.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,te.INFO,...e),this._logHandler(this,te.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,te.WARN,...e),this._logHandler(this,te.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,te.ERROR,...e),this._logHandler(this,te.ERROR,...e)}}const qd=(i,e)=>e.some(t=>i instanceof t);let pa,ma;function Hd(){return pa||(pa=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function zd(){return ma||(ma=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qu=new WeakMap,er=new WeakMap,Hu=new WeakMap,zo=new WeakMap,Fr=new WeakMap;function Kd(i){const e=new Promise((t,n)=>{const o=()=>{i.removeEventListener("success",r),i.removeEventListener("error",l)},r=()=>{t(ft(i.result)),o()},l=()=>{n(i.error),o()};i.addEventListener("success",r),i.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&qu.set(t,i)}).catch(()=>{}),Fr.set(e,i),e}function Wd(i){if(er.has(i))return;const e=new Promise((t,n)=>{const o=()=>{i.removeEventListener("complete",r),i.removeEventListener("error",l),i.removeEventListener("abort",l)},r=()=>{t(),o()},l=()=>{n(i.error||new DOMException("AbortError","AbortError")),o()};i.addEventListener("complete",r),i.addEventListener("error",l),i.addEventListener("abort",l)});er.set(i,e)}let tr={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return er.get(i);if(e==="objectStoreNames")return i.objectStoreNames||Hu.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ft(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function Jd(i){tr=i(tr)}function Yd(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(Ko(this),e,...t);return Hu.set(n,e.sort?e.sort():[e]),ft(n)}:zd().includes(i)?function(...e){return i.apply(Ko(this),e),ft(qu.get(this))}:function(...e){return ft(i.apply(Ko(this),e))}}function Zd(i){return typeof i=="function"?Yd(i):(i instanceof IDBTransaction&&Wd(i),qd(i,Hd())?new Proxy(i,tr):i)}function ft(i){if(i instanceof IDBRequest)return Kd(i);if(zo.has(i))return zo.get(i);const e=Zd(i);return e!==i&&(zo.set(i,e),Fr.set(e,i)),e}const Ko=i=>Fr.get(i);function Qd(i,e,{blocked:t,upgrade:n,blocking:o,terminated:r}={}){const l=indexedDB.open(i,e),c=ft(l);return n&&l.addEventListener("upgradeneeded",d=>{n(ft(l.result),d.oldVersion,d.newVersion,ft(l.transaction),d)}),t&&l.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),c.then(d=>{r&&d.addEventListener("close",()=>r()),o&&d.addEventListener("versionchange",f=>o(f.oldVersion,f.newVersion,f))}).catch(()=>{}),c}const Xd=["get","getKey","getAll","getAllKeys","count"],jd=["put","add","delete","clear"],Wo=new Map;function ga(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(Wo.get(e))return Wo.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,o=jd.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(o||Xd.includes(t)))return;const r=async function(l,...c){const d=this.transaction(l,o?"readwrite":"readonly");let f=d.store;return n&&(f=f.index(c.shift())),(await Promise.all([f[t](...c),o&&d.done]))[0]};return Wo.set(e,r),r}Jd(i=>({...i,get:(e,t,n)=>ga(e,t)||i.get(e,t,n),has:(e,t)=>!!ga(e,t)||i.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(th(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function th(i){const e=i.getComponent();return e?.type==="VERSION"}const nr="@firebase/app",ya="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const it=new Gu("@firebase/app"),nh="@firebase/app-compat",ih="@firebase/analytics-compat",oh="@firebase/analytics",rh="@firebase/app-check-compat",sh="@firebase/app-check",ah="@firebase/auth",lh="@firebase/auth-compat",uh="@firebase/database",ch="@firebase/data-connect",fh="@firebase/database-compat",dh="@firebase/functions",hh="@firebase/functions-compat",ph="@firebase/installations",mh="@firebase/installations-compat",gh="@firebase/messaging",yh="@firebase/messaging-compat",_h="@firebase/performance",vh="@firebase/performance-compat",Th="@firebase/remote-config",Ch="@firebase/remote-config-compat",Eh="@firebase/storage",Ah="@firebase/storage-compat",Ih="@firebase/firestore",Sh="@firebase/ai",wh="@firebase/firestore-compat",Rh="firebase",Ph="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir="[DEFAULT]",xh={[nr]:"fire-core",[nh]:"fire-core-compat",[oh]:"fire-analytics",[ih]:"fire-analytics-compat",[sh]:"fire-app-check",[rh]:"fire-app-check-compat",[ah]:"fire-auth",[lh]:"fire-auth-compat",[uh]:"fire-rtdb",[ch]:"fire-data-connect",[fh]:"fire-rtdb-compat",[dh]:"fire-fn",[hh]:"fire-fn-compat",[ph]:"fire-iid",[mh]:"fire-iid-compat",[gh]:"fire-fcm",[yh]:"fire-fcm-compat",[_h]:"fire-perf",[vh]:"fire-perf-compat",[Th]:"fire-rc",[Ch]:"fire-rc-compat",[Eh]:"fire-gcs",[Ah]:"fire-gcs-compat",[Ih]:"fire-fst",[wh]:"fire-fst-compat",[Sh]:"fire-vertex","fire-js":"fire-js",[Rh]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi=new Map,Mh=new Map,or=new Map;function _a(i,e){try{i.container.addComponent(e)}catch(t){it.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function Bi(i){const e=i.name;if(or.has(e))return it.debug(`There were multiple attempts to register component ${e}.`),!1;or.set(e,i);for(const t of Oi.values())_a(t,i);for(const t of Mh.values())_a(t,i);return!0}function Dh(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function Nh(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vh={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},dt=new $u("app","Firebase",Vh);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new $n("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw dt.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh=Ph;function zu(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ir,automaticDataCollectionEnabled:!0},e),o=n.name;if(typeof o!="string"||!o)throw dt.create("bad-app-name",{appName:String(o)});if(t||(t=Bu()),!t)throw dt.create("no-options");const r=Oi.get(o);if(r){if(Fi(t,r.options)&&Fi(n,r.config))return r;throw dt.create("duplicate-app",{appName:o})}const l=new Ud(o);for(const d of or.values())l.addComponent(d);const c=new kh(t,n,l);return Oi.set(o,c),c}function bh(i=ir){const e=Oi.get(i);if(!e&&i===ir&&Bu())return zu();if(!e)throw dt.create("no-app",{appName:i});return e}function Wt(i,e,t){var n;let o=(n=xh[i])!==null&&n!==void 0?n:i;t&&(o+=`-${t}`);const r=o.match(/\s|\//),l=e.match(/\s|\//);if(r||l){const c=[`Unable to register library "${o}" with version "${e}":`];r&&c.push(`library name "${o}" contains illegal characters (whitespace or "/")`),r&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),it.warn(c.join(" "));return}Bi(new $n(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh="firebase-heartbeat-database",Uh=1,Gn="firebase-heartbeat-store";let Jo=null;function Ku(){return Jo||(Jo=Qd(Fh,Uh,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(Gn)}catch(t){console.warn(t)}}}}).catch(i=>{throw dt.create("idb-open",{originalErrorMessage:i.message})})),Jo}async function Oh(i){try{const t=(await Ku()).transaction(Gn),n=await t.objectStore(Gn).get(Wu(i));return await t.done,n}catch(e){if(e instanceof un)it.warn(e.message);else{const t=dt.create("idb-get",{originalErrorMessage:e?.message});it.warn(t.message)}}}async function va(i,e){try{const n=(await Ku()).transaction(Gn,"readwrite");await n.objectStore(Gn).put(e,Wu(i)),await n.done}catch(t){if(t instanceof un)it.warn(t.message);else{const n=dt.create("idb-set",{originalErrorMessage:t?.message});it.warn(n.message)}}}function Wu(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bh=1024,$h=30;class Gh{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Hh(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ta();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(l=>l.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:o}),this._heartbeatsCache.heartbeats.length>$h){const l=zh(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){it.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Ta(),{heartbeatsToSend:n,unsentEntries:o}=qh(this._heartbeatsCache.heartbeats),r=bi(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return it.warn(t),""}}}function Ta(){return new Date().toISOString().substring(0,10)}function qh(i,e=Bh){const t=[];let n=i.slice();for(const o of i){const r=t.find(l=>l.agent===o.agent);if(r){if(r.dates.push(o.date),Ca(t)>e){r.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),Ca(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class Hh{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Md()?Dd().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Oh(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return va(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return va(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function Ca(i){return bi(JSON.stringify({version:2,heartbeats:i})).length}function zh(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kh(i){Bi(new $n("platform-logger",e=>new eh(e),"PRIVATE")),Bi(new $n("heartbeat",e=>new Gh(e),"PRIVATE")),Wt(nr,ya,i),Wt(nr,ya,"esm2017"),Wt("fire-js","")}Kh("");var Wh="firebase",Jh="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wt(Wh,Jh,"app");var Ea=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ur;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,T){function v(){}v.prototype=T.prototype,I.D=T.prototype,I.prototype=new v,I.prototype.constructor=I,I.C=function(E,S,P){for(var C=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)C[ge-2]=arguments[ge];return T.prototype[S].apply(E,C)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(I,T,v){v||(v=0);var E=Array(16);if(typeof T=="string")for(var S=0;16>S;++S)E[S]=T.charCodeAt(v++)|T.charCodeAt(v++)<<8|T.charCodeAt(v++)<<16|T.charCodeAt(v++)<<24;else for(S=0;16>S;++S)E[S]=T[v++]|T[v++]<<8|T[v++]<<16|T[v++]<<24;T=I.g[0],v=I.g[1],S=I.g[2];var P=I.g[3],C=T+(P^v&(S^P))+E[0]+3614090360&4294967295;T=v+(C<<7&4294967295|C>>>25),C=P+(S^T&(v^S))+E[1]+3905402710&4294967295,P=T+(C<<12&4294967295|C>>>20),C=S+(v^P&(T^v))+E[2]+606105819&4294967295,S=P+(C<<17&4294967295|C>>>15),C=v+(T^S&(P^T))+E[3]+3250441966&4294967295,v=S+(C<<22&4294967295|C>>>10),C=T+(P^v&(S^P))+E[4]+4118548399&4294967295,T=v+(C<<7&4294967295|C>>>25),C=P+(S^T&(v^S))+E[5]+1200080426&4294967295,P=T+(C<<12&4294967295|C>>>20),C=S+(v^P&(T^v))+E[6]+2821735955&4294967295,S=P+(C<<17&4294967295|C>>>15),C=v+(T^S&(P^T))+E[7]+4249261313&4294967295,v=S+(C<<22&4294967295|C>>>10),C=T+(P^v&(S^P))+E[8]+1770035416&4294967295,T=v+(C<<7&4294967295|C>>>25),C=P+(S^T&(v^S))+E[9]+2336552879&4294967295,P=T+(C<<12&4294967295|C>>>20),C=S+(v^P&(T^v))+E[10]+4294925233&4294967295,S=P+(C<<17&4294967295|C>>>15),C=v+(T^S&(P^T))+E[11]+2304563134&4294967295,v=S+(C<<22&4294967295|C>>>10),C=T+(P^v&(S^P))+E[12]+1804603682&4294967295,T=v+(C<<7&4294967295|C>>>25),C=P+(S^T&(v^S))+E[13]+4254626195&4294967295,P=T+(C<<12&4294967295|C>>>20),C=S+(v^P&(T^v))+E[14]+2792965006&4294967295,S=P+(C<<17&4294967295|C>>>15),C=v+(T^S&(P^T))+E[15]+1236535329&4294967295,v=S+(C<<22&4294967295|C>>>10),C=T+(S^P&(v^S))+E[1]+4129170786&4294967295,T=v+(C<<5&4294967295|C>>>27),C=P+(v^S&(T^v))+E[6]+3225465664&4294967295,P=T+(C<<9&4294967295|C>>>23),C=S+(T^v&(P^T))+E[11]+643717713&4294967295,S=P+(C<<14&4294967295|C>>>18),C=v+(P^T&(S^P))+E[0]+3921069994&4294967295,v=S+(C<<20&4294967295|C>>>12),C=T+(S^P&(v^S))+E[5]+3593408605&4294967295,T=v+(C<<5&4294967295|C>>>27),C=P+(v^S&(T^v))+E[10]+38016083&4294967295,P=T+(C<<9&4294967295|C>>>23),C=S+(T^v&(P^T))+E[15]+3634488961&4294967295,S=P+(C<<14&4294967295|C>>>18),C=v+(P^T&(S^P))+E[4]+3889429448&4294967295,v=S+(C<<20&4294967295|C>>>12),C=T+(S^P&(v^S))+E[9]+568446438&4294967295,T=v+(C<<5&4294967295|C>>>27),C=P+(v^S&(T^v))+E[14]+3275163606&4294967295,P=T+(C<<9&4294967295|C>>>23),C=S+(T^v&(P^T))+E[3]+4107603335&4294967295,S=P+(C<<14&4294967295|C>>>18),C=v+(P^T&(S^P))+E[8]+1163531501&4294967295,v=S+(C<<20&4294967295|C>>>12),C=T+(S^P&(v^S))+E[13]+2850285829&4294967295,T=v+(C<<5&4294967295|C>>>27),C=P+(v^S&(T^v))+E[2]+4243563512&4294967295,P=T+(C<<9&4294967295|C>>>23),C=S+(T^v&(P^T))+E[7]+1735328473&4294967295,S=P+(C<<14&4294967295|C>>>18),C=v+(P^T&(S^P))+E[12]+2368359562&4294967295,v=S+(C<<20&4294967295|C>>>12),C=T+(v^S^P)+E[5]+4294588738&4294967295,T=v+(C<<4&4294967295|C>>>28),C=P+(T^v^S)+E[8]+2272392833&4294967295,P=T+(C<<11&4294967295|C>>>21),C=S+(P^T^v)+E[11]+1839030562&4294967295,S=P+(C<<16&4294967295|C>>>16),C=v+(S^P^T)+E[14]+4259657740&4294967295,v=S+(C<<23&4294967295|C>>>9),C=T+(v^S^P)+E[1]+2763975236&4294967295,T=v+(C<<4&4294967295|C>>>28),C=P+(T^v^S)+E[4]+1272893353&4294967295,P=T+(C<<11&4294967295|C>>>21),C=S+(P^T^v)+E[7]+4139469664&4294967295,S=P+(C<<16&4294967295|C>>>16),C=v+(S^P^T)+E[10]+3200236656&4294967295,v=S+(C<<23&4294967295|C>>>9),C=T+(v^S^P)+E[13]+681279174&4294967295,T=v+(C<<4&4294967295|C>>>28),C=P+(T^v^S)+E[0]+3936430074&4294967295,P=T+(C<<11&4294967295|C>>>21),C=S+(P^T^v)+E[3]+3572445317&4294967295,S=P+(C<<16&4294967295|C>>>16),C=v+(S^P^T)+E[6]+76029189&4294967295,v=S+(C<<23&4294967295|C>>>9),C=T+(v^S^P)+E[9]+3654602809&4294967295,T=v+(C<<4&4294967295|C>>>28),C=P+(T^v^S)+E[12]+3873151461&4294967295,P=T+(C<<11&4294967295|C>>>21),C=S+(P^T^v)+E[15]+530742520&4294967295,S=P+(C<<16&4294967295|C>>>16),C=v+(S^P^T)+E[2]+3299628645&4294967295,v=S+(C<<23&4294967295|C>>>9),C=T+(S^(v|~P))+E[0]+4096336452&4294967295,T=v+(C<<6&4294967295|C>>>26),C=P+(v^(T|~S))+E[7]+1126891415&4294967295,P=T+(C<<10&4294967295|C>>>22),C=S+(T^(P|~v))+E[14]+2878612391&4294967295,S=P+(C<<15&4294967295|C>>>17),C=v+(P^(S|~T))+E[5]+4237533241&4294967295,v=S+(C<<21&4294967295|C>>>11),C=T+(S^(v|~P))+E[12]+1700485571&4294967295,T=v+(C<<6&4294967295|C>>>26),C=P+(v^(T|~S))+E[3]+2399980690&4294967295,P=T+(C<<10&4294967295|C>>>22),C=S+(T^(P|~v))+E[10]+4293915773&4294967295,S=P+(C<<15&4294967295|C>>>17),C=v+(P^(S|~T))+E[1]+2240044497&4294967295,v=S+(C<<21&4294967295|C>>>11),C=T+(S^(v|~P))+E[8]+1873313359&4294967295,T=v+(C<<6&4294967295|C>>>26),C=P+(v^(T|~S))+E[15]+4264355552&4294967295,P=T+(C<<10&4294967295|C>>>22),C=S+(T^(P|~v))+E[6]+2734768916&4294967295,S=P+(C<<15&4294967295|C>>>17),C=v+(P^(S|~T))+E[13]+1309151649&4294967295,v=S+(C<<21&4294967295|C>>>11),C=T+(S^(v|~P))+E[4]+4149444226&4294967295,T=v+(C<<6&4294967295|C>>>26),C=P+(v^(T|~S))+E[11]+3174756917&4294967295,P=T+(C<<10&4294967295|C>>>22),C=S+(T^(P|~v))+E[2]+718787259&4294967295,S=P+(C<<15&4294967295|C>>>17),C=v+(P^(S|~T))+E[9]+3951481745&4294967295,I.g[0]=I.g[0]+T&4294967295,I.g[1]=I.g[1]+(S+(C<<21&4294967295|C>>>11))&4294967295,I.g[2]=I.g[2]+S&4294967295,I.g[3]=I.g[3]+P&4294967295}n.prototype.u=function(I,T){T===void 0&&(T=I.length);for(var v=T-this.blockSize,E=this.B,S=this.h,P=0;P<T;){if(S==0)for(;P<=v;)o(this,I,P),P+=this.blockSize;if(typeof I=="string"){for(;P<T;)if(E[S++]=I.charCodeAt(P++),S==this.blockSize){o(this,E),S=0;break}}else for(;P<T;)if(E[S++]=I[P++],S==this.blockSize){o(this,E),S=0;break}}this.h=S,this.o+=T},n.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var T=1;T<I.length-8;++T)I[T]=0;var v=8*this.o;for(T=I.length-8;T<I.length;++T)I[T]=v&255,v/=256;for(this.u(I),I=Array(16),T=v=0;4>T;++T)for(var E=0;32>E;E+=8)I[v++]=this.g[T]>>>E&255;return I};function r(I,T){var v=c;return Object.prototype.hasOwnProperty.call(v,I)?v[I]:v[I]=T(I)}function l(I,T){this.h=T;for(var v=[],E=!0,S=I.length-1;0<=S;S--){var P=I[S]|0;E&&P==T||(v[S]=P,E=!1)}this.g=v}var c={};function d(I){return-128<=I&&128>I?r(I,function(T){return new l([T|0],0>T?-1:0)}):new l([I|0],0>I?-1:0)}function f(I){if(isNaN(I)||!isFinite(I))return g;if(0>I)return D(f(-I));for(var T=[],v=1,E=0;I>=v;E++)T[E]=I/v|0,v*=4294967296;return new l(T,0)}function p(I,T){if(I.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(I.charAt(0)=="-")return D(p(I.substring(1),T));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=f(Math.pow(T,8)),E=g,S=0;S<I.length;S+=8){var P=Math.min(8,I.length-S),C=parseInt(I.substring(S,S+P),T);8>P?(P=f(Math.pow(T,P)),E=E.j(P).add(f(C))):(E=E.j(v),E=E.add(f(C)))}return E}var g=d(0),y=d(1),A=d(16777216);i=l.prototype,i.m=function(){if(M(this))return-D(this).m();for(var I=0,T=1,v=0;v<this.g.length;v++){var E=this.i(v);I+=(0<=E?E:4294967296+E)*T,T*=4294967296}return I},i.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(w(this))return"0";if(M(this))return"-"+D(this).toString(I);for(var T=f(Math.pow(I,6)),v=this,E="";;){var S=q(v,T).g;v=F(v,S.j(T));var P=((0<v.g.length?v.g[0]:v.h)>>>0).toString(I);if(v=S,w(v))return P+E;for(;6>P.length;)P="0"+P;E=P+E}},i.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function w(I){if(I.h!=0)return!1;for(var T=0;T<I.g.length;T++)if(I.g[T]!=0)return!1;return!0}function M(I){return I.h==-1}i.l=function(I){return I=F(this,I),M(I)?-1:w(I)?0:1};function D(I){for(var T=I.g.length,v=[],E=0;E<T;E++)v[E]=~I.g[E];return new l(v,~I.h).add(y)}i.abs=function(){return M(this)?D(this):this},i.add=function(I){for(var T=Math.max(this.g.length,I.g.length),v=[],E=0,S=0;S<=T;S++){var P=E+(this.i(S)&65535)+(I.i(S)&65535),C=(P>>>16)+(this.i(S)>>>16)+(I.i(S)>>>16);E=C>>>16,P&=65535,C&=65535,v[S]=C<<16|P}return new l(v,v[v.length-1]&-2147483648?-1:0)};function F(I,T){return I.add(D(T))}i.j=function(I){if(w(this)||w(I))return g;if(M(this))return M(I)?D(this).j(D(I)):D(D(this).j(I));if(M(I))return D(this.j(D(I)));if(0>this.l(A)&&0>I.l(A))return f(this.m()*I.m());for(var T=this.g.length+I.g.length,v=[],E=0;E<2*T;E++)v[E]=0;for(E=0;E<this.g.length;E++)for(var S=0;S<I.g.length;S++){var P=this.i(E)>>>16,C=this.i(E)&65535,ge=I.i(S)>>>16,Xe=I.i(S)&65535;v[2*E+2*S]+=C*Xe,b(v,2*E+2*S),v[2*E+2*S+1]+=P*Xe,b(v,2*E+2*S+1),v[2*E+2*S+1]+=C*ge,b(v,2*E+2*S+1),v[2*E+2*S+2]+=P*ge,b(v,2*E+2*S+2)}for(E=0;E<T;E++)v[E]=v[2*E+1]<<16|v[2*E];for(E=T;E<2*T;E++)v[E]=0;return new l(v,0)};function b(I,T){for(;(I[T]&65535)!=I[T];)I[T+1]+=I[T]>>>16,I[T]&=65535,T++}function O(I,T){this.g=I,this.h=T}function q(I,T){if(w(T))throw Error("division by zero");if(w(I))return new O(g,g);if(M(I))return T=q(D(I),T),new O(D(T.g),D(T.h));if(M(T))return T=q(I,D(T)),new O(D(T.g),T.h);if(30<I.g.length){if(M(I)||M(T))throw Error("slowDivide_ only works with positive integers.");for(var v=y,E=T;0>=E.l(I);)v=Y(v),E=Y(E);var S=H(v,1),P=H(E,1);for(E=H(E,2),v=H(v,2);!w(E);){var C=P.add(E);0>=C.l(I)&&(S=S.add(v),P=C),E=H(E,1),v=H(v,1)}return T=F(I,S.j(T)),new O(S,T)}for(S=g;0<=I.l(T);){for(v=Math.max(1,Math.floor(I.m()/T.m())),E=Math.ceil(Math.log(v)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),P=f(v),C=P.j(T);M(C)||0<C.l(I);)v-=E,P=f(v),C=P.j(T);w(P)&&(P=y),S=S.add(P),I=F(I,C)}return new O(S,I)}i.A=function(I){return q(this,I).h},i.and=function(I){for(var T=Math.max(this.g.length,I.g.length),v=[],E=0;E<T;E++)v[E]=this.i(E)&I.i(E);return new l(v,this.h&I.h)},i.or=function(I){for(var T=Math.max(this.g.length,I.g.length),v=[],E=0;E<T;E++)v[E]=this.i(E)|I.i(E);return new l(v,this.h|I.h)},i.xor=function(I){for(var T=Math.max(this.g.length,I.g.length),v=[],E=0;E<T;E++)v[E]=this.i(E)^I.i(E);return new l(v,this.h^I.h)};function Y(I){for(var T=I.g.length+1,v=[],E=0;E<T;E++)v[E]=I.i(E)<<1|I.i(E-1)>>>31;return new l(v,I.h)}function H(I,T){var v=T>>5;T%=32;for(var E=I.g.length-v,S=[],P=0;P<E;P++)S[P]=0<T?I.i(P+v)>>>T|I.i(P+v+1)<<32-T:I.i(P+v);return new l(S,I.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=f,l.fromString=p,Ur=l}).apply(typeof Ea<"u"?Ea:typeof self<"u"?self:typeof window<"u"?window:{});var Ei=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ju,Nn,Yu,xi,rr,Zu,Qu,Xu;(function(){var i,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,h,m){return u==Array.prototype||u==Object.prototype||(u[h]=m.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ei=="object"&&Ei];for(var h=0;h<u.length;++h){var m=u[h];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var n=t(this);function o(u,h){if(h)e:{var m=n;u=u.split(".");for(var _=0;_<u.length-1;_++){var R=u[_];if(!(R in m))break e;m=m[R]}u=u[u.length-1],_=m[u],h=h(_),h!=_&&h!=null&&e(m,u,{configurable:!0,writable:!0,value:h})}}function r(u,h){u instanceof String&&(u+="");var m=0,_=!1,R={next:function(){if(!_&&m<u.length){var x=m++;return{value:h(x,u[x]),done:!1}}return _=!0,{done:!0,value:void 0}}};return R[Symbol.iterator]=function(){return R},R}o("Array.prototype.values",function(u){return u||function(){return r(this,function(h,m){return m})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function d(u){var h=typeof u;return h=h!="object"?h:u?Array.isArray(u)?"array":h:"null",h=="array"||h=="object"&&typeof u.length=="number"}function f(u){var h=typeof u;return h=="object"&&u!=null||h=="function"}function p(u,h,m){return u.call.apply(u.bind,arguments)}function g(u,h,m){if(!u)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var R=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(R,_),u.apply(h,R)}}return function(){return u.apply(h,arguments)}}function y(u,h,m){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,y.apply(null,arguments)}function A(u,h){var m=Array.prototype.slice.call(arguments,1);return function(){var _=m.slice();return _.push.apply(_,arguments),u.apply(this,_)}}function w(u,h){function m(){}m.prototype=h.prototype,u.aa=h.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(_,R,x){for(var L=Array(arguments.length-2),re=2;re<arguments.length;re++)L[re-2]=arguments[re];return h.prototype[R].apply(_,L)}}function M(u){const h=u.length;if(0<h){const m=Array(h);for(let _=0;_<h;_++)m[_]=u[_];return m}return[]}function D(u,h){for(let m=1;m<arguments.length;m++){const _=arguments[m];if(d(_)){const R=u.length||0,x=_.length||0;u.length=R+x;for(let L=0;L<x;L++)u[R+L]=_[L]}else u.push(_)}}class F{constructor(h,m){this.i=h,this.j=m,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function b(u){return/^[\s\xa0]*$/.test(u)}function O(){var u=c.navigator;return u&&(u=u.userAgent)?u:""}function q(u){return q[" "](u),u}q[" "]=function(){};var Y=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function H(u,h,m){for(const _ in u)h.call(m,u[_],_,u)}function I(u,h){for(const m in u)h.call(void 0,u[m],m,u)}function T(u){const h={};for(const m in u)h[m]=u[m];return h}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(u,h){let m,_;for(let R=1;R<arguments.length;R++){_=arguments[R];for(m in _)u[m]=_[m];for(let x=0;x<v.length;x++)m=v[x],Object.prototype.hasOwnProperty.call(_,m)&&(u[m]=_[m])}}function S(u){var h=1;u=u.split(":");const m=[];for(;0<h&&u.length;)m.push(u.shift()),h--;return u.length&&m.push(u.join(":")),m}function P(u){c.setTimeout(()=>{throw u},0)}function C(){var u=Co;let h=null;return u.g&&(h=u.g,u.g=u.g.next,u.g||(u.h=null),h.next=null),h}class ge{constructor(){this.h=this.g=null}add(h,m){const _=Xe.get();_.set(h,m),this.h?this.h.next=_:this.g=_,this.h=_}}var Xe=new F(()=>new xf,u=>u.reset());class xf{constructor(){this.next=this.g=this.h=null}set(h,m){this.h=h,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let pn,mn=!1,Co=new ge,fs=()=>{const u=c.Promise.resolve(void 0);pn=()=>{u.then(Mf)}};var Mf=()=>{for(var u;u=C();){try{u.h.call(u.g)}catch(m){P(m)}var h=Xe;h.j(u),100>h.h&&(h.h++,u.next=h.g,h.g=u)}mn=!1};function st(){this.s=this.s,this.C=this.C}st.prototype.s=!1,st.prototype.ma=function(){this.s||(this.s=!0,this.N())},st.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Se(u,h){this.type=u,this.g=this.target=h,this.defaultPrevented=!1}Se.prototype.h=function(){this.defaultPrevented=!0};var Df=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var u=!1,h=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const m=()=>{};c.addEventListener("test",m,h),c.removeEventListener("test",m,h)}catch{}return u}();function gn(u,h){if(Se.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,_=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=h,h=u.relatedTarget){if(Y){e:{try{q(h.nodeName);var R=!0;break e}catch{}R=!1}R||(h=null)}}else m=="mouseover"?h=u.fromElement:m=="mouseout"&&(h=u.toElement);this.relatedTarget=h,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Nf[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&gn.aa.h.call(this)}}w(gn,Se);var Nf={2:"touch",3:"pen",4:"mouse"};gn.prototype.h=function(){gn.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var ii="closure_listenable_"+(1e6*Math.random()|0),Vf=0;function kf(u,h,m,_,R){this.listener=u,this.proxy=null,this.src=h,this.type=m,this.capture=!!_,this.ha=R,this.key=++Vf,this.da=this.fa=!1}function oi(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ri(u){this.src=u,this.g={},this.h=0}ri.prototype.add=function(u,h,m,_,R){var x=u.toString();u=this.g[x],u||(u=this.g[x]=[],this.h++);var L=Ao(u,h,_,R);return-1<L?(h=u[L],m||(h.fa=!1)):(h=new kf(h,this.src,x,!!_,R),h.fa=m,u.push(h)),h};function Eo(u,h){var m=h.type;if(m in u.g){var _=u.g[m],R=Array.prototype.indexOf.call(_,h,void 0),x;(x=0<=R)&&Array.prototype.splice.call(_,R,1),x&&(oi(h),u.g[m].length==0&&(delete u.g[m],u.h--))}}function Ao(u,h,m,_){for(var R=0;R<u.length;++R){var x=u[R];if(!x.da&&x.listener==h&&x.capture==!!m&&x.ha==_)return R}return-1}var Io="closure_lm_"+(1e6*Math.random()|0),So={};function ds(u,h,m,_,R){if(Array.isArray(h)){for(var x=0;x<h.length;x++)ds(u,h[x],m,_,R);return null}return m=ms(m),u&&u[ii]?u.K(h,m,f(_)?!!_.capture:!1,R):Lf(u,h,m,!1,_,R)}function Lf(u,h,m,_,R,x){if(!h)throw Error("Invalid event type");var L=f(R)?!!R.capture:!!R,re=Ro(u);if(re||(u[Io]=re=new ri(u)),m=re.add(h,m,_,L,x),m.proxy)return m;if(_=bf(),m.proxy=_,_.src=u,_.listener=m,u.addEventListener)Df||(R=L),R===void 0&&(R=!1),u.addEventListener(h.toString(),_,R);else if(u.attachEvent)u.attachEvent(ps(h.toString()),_);else if(u.addListener&&u.removeListener)u.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return m}function bf(){function u(m){return h.call(u.src,u.listener,m)}const h=Ff;return u}function hs(u,h,m,_,R){if(Array.isArray(h))for(var x=0;x<h.length;x++)hs(u,h[x],m,_,R);else _=f(_)?!!_.capture:!!_,m=ms(m),u&&u[ii]?(u=u.i,h=String(h).toString(),h in u.g&&(x=u.g[h],m=Ao(x,m,_,R),-1<m&&(oi(x[m]),Array.prototype.splice.call(x,m,1),x.length==0&&(delete u.g[h],u.h--)))):u&&(u=Ro(u))&&(h=u.g[h.toString()],u=-1,h&&(u=Ao(h,m,_,R)),(m=-1<u?h[u]:null)&&wo(m))}function wo(u){if(typeof u!="number"&&u&&!u.da){var h=u.src;if(h&&h[ii])Eo(h.i,u);else{var m=u.type,_=u.proxy;h.removeEventListener?h.removeEventListener(m,_,u.capture):h.detachEvent?h.detachEvent(ps(m),_):h.addListener&&h.removeListener&&h.removeListener(_),(m=Ro(h))?(Eo(m,u),m.h==0&&(m.src=null,h[Io]=null)):oi(u)}}}function ps(u){return u in So?So[u]:So[u]="on"+u}function Ff(u,h){if(u.da)u=!0;else{h=new gn(h,this);var m=u.listener,_=u.ha||u.src;u.fa&&wo(u),u=m.call(_,h)}return u}function Ro(u){return u=u[Io],u instanceof ri?u:null}var Po="__closure_events_fn_"+(1e9*Math.random()>>>0);function ms(u){return typeof u=="function"?u:(u[Po]||(u[Po]=function(h){return u.handleEvent(h)}),u[Po])}function we(){st.call(this),this.i=new ri(this),this.M=this,this.F=null}w(we,st),we.prototype[ii]=!0,we.prototype.removeEventListener=function(u,h,m,_){hs(this,u,h,m,_)};function Ne(u,h){var m,_=u.F;if(_)for(m=[];_;_=_.F)m.push(_);if(u=u.M,_=h.type||h,typeof h=="string")h=new Se(h,u);else if(h instanceof Se)h.target=h.target||u;else{var R=h;h=new Se(_,u),E(h,R)}if(R=!0,m)for(var x=m.length-1;0<=x;x--){var L=h.g=m[x];R=si(L,_,!0,h)&&R}if(L=h.g=u,R=si(L,_,!0,h)&&R,R=si(L,_,!1,h)&&R,m)for(x=0;x<m.length;x++)L=h.g=m[x],R=si(L,_,!1,h)&&R}we.prototype.N=function(){if(we.aa.N.call(this),this.i){var u=this.i,h;for(h in u.g){for(var m=u.g[h],_=0;_<m.length;_++)oi(m[_]);delete u.g[h],u.h--}}this.F=null},we.prototype.K=function(u,h,m,_){return this.i.add(String(u),h,!1,m,_)},we.prototype.L=function(u,h,m,_){return this.i.add(String(u),h,!0,m,_)};function si(u,h,m,_){if(h=u.i.g[String(h)],!h)return!0;h=h.concat();for(var R=!0,x=0;x<h.length;++x){var L=h[x];if(L&&!L.da&&L.capture==m){var re=L.listener,Te=L.ha||L.src;L.fa&&Eo(u.i,L),R=re.call(Te,_)!==!1&&R}}return R&&!_.defaultPrevented}function gs(u,h,m){if(typeof u=="function")m&&(u=y(u,m));else if(u&&typeof u.handleEvent=="function")u=y(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(u,h||0)}function ys(u){u.g=gs(()=>{u.g=null,u.i&&(u.i=!1,ys(u))},u.l);const h=u.h;u.h=null,u.m.apply(null,h)}class Uf extends st{constructor(h,m){super(),this.m=h,this.l=m,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:ys(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yn(u){st.call(this),this.h=u,this.g={}}w(yn,st);var _s=[];function vs(u){H(u.g,function(h,m){this.g.hasOwnProperty(m)&&wo(h)},u),u.g={}}yn.prototype.N=function(){yn.aa.N.call(this),vs(this)},yn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xo=c.JSON.stringify,Of=c.JSON.parse,Bf=class{stringify(u){return c.JSON.stringify(u,void 0)}parse(u){return c.JSON.parse(u,void 0)}};function Mo(){}Mo.prototype.h=null;function Ts(u){return u.h||(u.h=u.i())}function Cs(){}var _n={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Do(){Se.call(this,"d")}w(Do,Se);function No(){Se.call(this,"c")}w(No,Se);var Tt={},Es=null;function ai(){return Es=Es||new we}Tt.La="serverreachability";function As(u){Se.call(this,Tt.La,u)}w(As,Se);function vn(u){const h=ai();Ne(h,new As(h))}Tt.STAT_EVENT="statevent";function Is(u,h){Se.call(this,Tt.STAT_EVENT,u),this.stat=h}w(Is,Se);function Ve(u){const h=ai();Ne(h,new Is(h,u))}Tt.Ma="timingevent";function Ss(u,h){Se.call(this,Tt.Ma,u),this.size=h}w(Ss,Se);function Tn(u,h){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){u()},h)}function Cn(){this.g=!0}Cn.prototype.xa=function(){this.g=!1};function $f(u,h,m,_,R,x){u.info(function(){if(u.g)if(x)for(var L="",re=x.split("&"),Te=0;Te<re.length;Te++){var ie=re[Te].split("=");if(1<ie.length){var Re=ie[0];ie=ie[1];var Pe=Re.split("_");L=2<=Pe.length&&Pe[1]=="type"?L+(Re+"="+ie+"&"):L+(Re+"=redacted&")}}else L=null;else L=x;return"XMLHTTP REQ ("+_+") [attempt "+R+"]: "+h+`
`+m+`
`+L})}function Gf(u,h,m,_,R,x,L){u.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+R+"]: "+h+`
`+m+`
`+x+" "+L})}function Ut(u,h,m,_){u.info(function(){return"XMLHTTP TEXT ("+h+"): "+Hf(u,m)+(_?" "+_:"")})}function qf(u,h){u.info(function(){return"TIMEOUT: "+h})}Cn.prototype.info=function(){};function Hf(u,h){if(!u.g)return h;if(!h)return null;try{var m=JSON.parse(h);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var _=m[u];if(!(2>_.length)){var R=_[1];if(Array.isArray(R)&&!(1>R.length)){var x=R[0];if(x!="noop"&&x!="stop"&&x!="close")for(var L=1;L<R.length;L++)R[L]=""}}}}return xo(m)}catch{return h}}var li={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ws={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Vo;function ui(){}w(ui,Mo),ui.prototype.g=function(){return new XMLHttpRequest},ui.prototype.i=function(){return{}},Vo=new ui;function at(u,h,m,_){this.j=u,this.i=h,this.l=m,this.R=_||1,this.U=new yn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Rs}function Rs(){this.i=null,this.g="",this.h=!1}var Ps={},ko={};function Lo(u,h,m){u.L=1,u.v=hi(je(h)),u.m=m,u.P=!0,xs(u,null)}function xs(u,h){u.F=Date.now(),ci(u),u.A=je(u.v);var m=u.A,_=u.R;Array.isArray(_)||(_=[String(_)]),qs(m.i,"t",_),u.C=0,m=u.j.J,u.h=new Rs,u.g=aa(u.j,m?h:null,!u.m),0<u.O&&(u.M=new Uf(y(u.Y,u,u.g),u.O)),h=u.U,m=u.g,_=u.ca;var R="readystatechange";Array.isArray(R)||(R&&(_s[0]=R.toString()),R=_s);for(var x=0;x<R.length;x++){var L=ds(m,R[x],_||h.handleEvent,!1,h.h||h);if(!L)break;h.g[L.key]=L}h=u.H?T(u.H):{},u.m?(u.u||(u.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,h)):(u.u="GET",u.g.ea(u.A,u.u,null,h)),vn(),$f(u.i,u.u,u.A,u.l,u.R,u.m)}at.prototype.ca=function(u){u=u.target;const h=this.M;h&&et(u)==3?h.j():this.Y(u)},at.prototype.Y=function(u){try{if(u==this.g)e:{const Pe=et(this.g);var h=this.g.Ba();const $t=this.g.Z();if(!(3>Pe)&&(Pe!=3||this.g&&(this.h.h||this.g.oa()||Zs(this.g)))){this.J||Pe!=4||h==7||(h==8||0>=$t?vn(3):vn(2)),bo(this);var m=this.g.Z();this.X=m;t:if(Ms(this)){var _=Zs(this.g);u="";var R=_.length,x=et(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ct(this),En(this);var L="";break t}this.h.i=new c.TextDecoder}for(h=0;h<R;h++)this.h.h=!0,u+=this.h.i.decode(_[h],{stream:!(x&&h==R-1)});_.length=0,this.h.g+=u,this.C=0,L=this.h.g}else L=this.g.oa();if(this.o=m==200,Gf(this.i,this.u,this.A,this.l,this.R,Pe,m),this.o){if(this.T&&!this.K){t:{if(this.g){var re,Te=this.g;if((re=Te.g?Te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(re)){var ie=re;break t}}ie=null}if(m=ie)Ut(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fo(this,m);else{this.o=!1,this.s=3,Ve(12),Ct(this),En(this);break e}}if(this.P){m=!0;let Be;for(;!this.J&&this.C<L.length;)if(Be=zf(this,L),Be==ko){Pe==4&&(this.s=4,Ve(14),m=!1),Ut(this.i,this.l,null,"[Incomplete Response]");break}else if(Be==Ps){this.s=4,Ve(15),Ut(this.i,this.l,L,"[Invalid Chunk]"),m=!1;break}else Ut(this.i,this.l,Be,null),Fo(this,Be);if(Ms(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pe!=4||L.length!=0||this.h.h||(this.s=1,Ve(16),m=!1),this.o=this.o&&m,!m)Ut(this.i,this.l,L,"[Invalid Chunked Response]"),Ct(this),En(this);else if(0<L.length&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.ba&&!Re.M&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),qo(Re),Re.M=!0,Ve(11))}}else Ut(this.i,this.l,L,null),Fo(this,L);Pe==4&&Ct(this),this.o&&!this.J&&(Pe==4?ia(this.j,this):(this.o=!1,ci(this)))}else ld(this.g),m==400&&0<L.indexOf("Unknown SID")?(this.s=3,Ve(12)):(this.s=0,Ve(13)),Ct(this),En(this)}}}catch{}finally{}};function Ms(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function zf(u,h){var m=u.C,_=h.indexOf(`
`,m);return _==-1?ko:(m=Number(h.substring(m,_)),isNaN(m)?Ps:(_+=1,_+m>h.length?ko:(h=h.slice(_,_+m),u.C=_+m,h)))}at.prototype.cancel=function(){this.J=!0,Ct(this)};function ci(u){u.S=Date.now()+u.I,Ds(u,u.I)}function Ds(u,h){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Tn(y(u.ba,u),h)}function bo(u){u.B&&(c.clearTimeout(u.B),u.B=null)}at.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(qf(this.i,this.A),this.L!=2&&(vn(),Ve(17)),Ct(this),this.s=2,En(this)):Ds(this,this.S-u)};function En(u){u.j.G==0||u.J||ia(u.j,u)}function Ct(u){bo(u);var h=u.M;h&&typeof h.ma=="function"&&h.ma(),u.M=null,vs(u.U),u.g&&(h=u.g,u.g=null,h.abort(),h.ma())}function Fo(u,h){try{var m=u.j;if(m.G!=0&&(m.g==u||Uo(m.h,u))){if(!u.K&&Uo(m.h,u)&&m.G==3){try{var _=m.Da.g.parse(h)}catch{_=null}if(Array.isArray(_)&&_.length==3){var R=_;if(R[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)vi(m),yi(m);else break e;Go(m),Ve(18)}}else m.za=R[1],0<m.za-m.T&&37500>R[2]&&m.F&&m.v==0&&!m.C&&(m.C=Tn(y(m.Za,m),6e3));if(1>=ks(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else At(m,11)}else if((u.K||m.g==u)&&vi(m),!b(h))for(R=m.Da.g.parse(h),h=0;h<R.length;h++){let ie=R[h];if(m.T=ie[0],ie=ie[1],m.G==2)if(ie[0]=="c"){m.K=ie[1],m.ia=ie[2];const Re=ie[3];Re!=null&&(m.la=Re,m.j.info("VER="+m.la));const Pe=ie[4];Pe!=null&&(m.Aa=Pe,m.j.info("SVER="+m.Aa));const $t=ie[5];$t!=null&&typeof $t=="number"&&0<$t&&(_=1.5*$t,m.L=_,m.j.info("backChannelRequestTimeoutMs_="+_)),_=m;const Be=u.g;if(Be){const Ci=Be.g?Be.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ci){var x=_.h;x.g||Ci.indexOf("spdy")==-1&&Ci.indexOf("quic")==-1&&Ci.indexOf("h2")==-1||(x.j=x.l,x.g=new Set,x.h&&(Oo(x,x.h),x.h=null))}if(_.D){const Ho=Be.g?Be.g.getResponseHeader("X-HTTP-Session-Id"):null;Ho&&(_.ya=Ho,le(_.I,_.D,Ho))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),_=m;var L=u;if(_.qa=sa(_,_.J?_.ia:null,_.W),L.K){Ls(_.h,L);var re=L,Te=_.L;Te&&(re.I=Te),re.B&&(bo(re),ci(re)),_.g=L}else ta(_);0<m.i.length&&_i(m)}else ie[0]!="stop"&&ie[0]!="close"||At(m,7);else m.G==3&&(ie[0]=="stop"||ie[0]=="close"?ie[0]=="stop"?At(m,7):$o(m):ie[0]!="noop"&&m.l&&m.l.ta(ie),m.v=0)}}vn(4)}catch{}}var Kf=class{constructor(u,h){this.g=u,this.map=h}};function Ns(u){this.l=u||10,c.PerformanceNavigationTiming?(u=c.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Vs(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function ks(u){return u.h?1:u.g?u.g.size:0}function Uo(u,h){return u.h?u.h==h:u.g?u.g.has(h):!1}function Oo(u,h){u.g?u.g.add(h):u.h=h}function Ls(u,h){u.h&&u.h==h?u.h=null:u.g&&u.g.has(h)&&u.g.delete(h)}Ns.prototype.cancel=function(){if(this.i=bs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function bs(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let h=u.i;for(const m of u.g.values())h=h.concat(m.D);return h}return M(u.i)}function Wf(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(d(u)){for(var h=[],m=u.length,_=0;_<m;_++)h.push(u[_]);return h}h=[],m=0;for(_ in u)h[m++]=u[_];return h}function Jf(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(d(u)||typeof u=="string"){var h=[];u=u.length;for(var m=0;m<u;m++)h.push(m);return h}h=[],m=0;for(const _ in u)h[m++]=_;return h}}}function Fs(u,h){if(u.forEach&&typeof u.forEach=="function")u.forEach(h,void 0);else if(d(u)||typeof u=="string")Array.prototype.forEach.call(u,h,void 0);else for(var m=Jf(u),_=Wf(u),R=_.length,x=0;x<R;x++)h.call(void 0,_[x],m&&m[x],u)}var Us=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yf(u,h){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var _=u[m].indexOf("="),R=null;if(0<=_){var x=u[m].substring(0,_);R=u[m].substring(_+1)}else x=u[m];h(x,R?decodeURIComponent(R.replace(/\+/g," ")):"")}}}function Et(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Et){this.h=u.h,fi(this,u.j),this.o=u.o,this.g=u.g,di(this,u.s),this.l=u.l;var h=u.i,m=new Sn;m.i=h.i,h.g&&(m.g=new Map(h.g),m.h=h.h),Os(this,m),this.m=u.m}else u&&(h=String(u).match(Us))?(this.h=!1,fi(this,h[1]||"",!0),this.o=An(h[2]||""),this.g=An(h[3]||"",!0),di(this,h[4]),this.l=An(h[5]||"",!0),Os(this,h[6]||"",!0),this.m=An(h[7]||"")):(this.h=!1,this.i=new Sn(null,this.h))}Et.prototype.toString=function(){var u=[],h=this.j;h&&u.push(In(h,Bs,!0),":");var m=this.g;return(m||h=="file")&&(u.push("//"),(h=this.o)&&u.push(In(h,Bs,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(In(m,m.charAt(0)=="/"?Xf:Qf,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",In(m,ed)),u.join("")};function je(u){return new Et(u)}function fi(u,h,m){u.j=m?An(h,!0):h,u.j&&(u.j=u.j.replace(/:$/,""))}function di(u,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);u.s=h}else u.s=null}function Os(u,h,m){h instanceof Sn?(u.i=h,td(u.i,u.h)):(m||(h=In(h,jf)),u.i=new Sn(h,u.h))}function le(u,h,m){u.i.set(h,m)}function hi(u){return le(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function An(u,h){return u?h?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function In(u,h,m){return typeof u=="string"?(u=encodeURI(u).replace(h,Zf),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Zf(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Bs=/[#\/\?@]/g,Qf=/[#\?:]/g,Xf=/[#\?]/g,jf=/[#\?@]/g,ed=/#/g;function Sn(u,h){this.h=this.g=null,this.i=u||null,this.j=!!h}function lt(u){u.g||(u.g=new Map,u.h=0,u.i&&Yf(u.i,function(h,m){u.add(decodeURIComponent(h.replace(/\+/g," ")),m)}))}i=Sn.prototype,i.add=function(u,h){lt(this),this.i=null,u=Ot(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(h),this.h+=1,this};function $s(u,h){lt(u),h=Ot(u,h),u.g.has(h)&&(u.i=null,u.h-=u.g.get(h).length,u.g.delete(h))}function Gs(u,h){return lt(u),h=Ot(u,h),u.g.has(h)}i.forEach=function(u,h){lt(this),this.g.forEach(function(m,_){m.forEach(function(R){u.call(h,R,_,this)},this)},this)},i.na=function(){lt(this);const u=Array.from(this.g.values()),h=Array.from(this.g.keys()),m=[];for(let _=0;_<h.length;_++){const R=u[_];for(let x=0;x<R.length;x++)m.push(h[_])}return m},i.V=function(u){lt(this);let h=[];if(typeof u=="string")Gs(this,u)&&(h=h.concat(this.g.get(Ot(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)h=h.concat(u[m])}return h},i.set=function(u,h){return lt(this),this.i=null,u=Ot(this,u),Gs(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[h]),this.h+=1,this},i.get=function(u,h){return u?(u=this.V(u),0<u.length?String(u[0]):h):h};function qs(u,h,m){$s(u,h),0<m.length&&(u.i=null,u.g.set(Ot(u,h),M(m)),u.h+=m.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],h=Array.from(this.g.keys());for(var m=0;m<h.length;m++){var _=h[m];const x=encodeURIComponent(String(_)),L=this.V(_);for(_=0;_<L.length;_++){var R=x;L[_]!==""&&(R+="="+encodeURIComponent(String(L[_]))),u.push(R)}}return this.i=u.join("&")};function Ot(u,h){return h=String(h),u.j&&(h=h.toLowerCase()),h}function td(u,h){h&&!u.j&&(lt(u),u.i=null,u.g.forEach(function(m,_){var R=_.toLowerCase();_!=R&&($s(this,_),qs(this,R,m))},u)),u.j=h}function nd(u,h){const m=new Cn;if(c.Image){const _=new Image;_.onload=A(ut,m,"TestLoadImage: loaded",!0,h,_),_.onerror=A(ut,m,"TestLoadImage: error",!1,h,_),_.onabort=A(ut,m,"TestLoadImage: abort",!1,h,_),_.ontimeout=A(ut,m,"TestLoadImage: timeout",!1,h,_),c.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=u}else h(!1)}function id(u,h){const m=new Cn,_=new AbortController,R=setTimeout(()=>{_.abort(),ut(m,"TestPingServer: timeout",!1,h)},1e4);fetch(u,{signal:_.signal}).then(x=>{clearTimeout(R),x.ok?ut(m,"TestPingServer: ok",!0,h):ut(m,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(R),ut(m,"TestPingServer: error",!1,h)})}function ut(u,h,m,_,R){try{R&&(R.onload=null,R.onerror=null,R.onabort=null,R.ontimeout=null),_(m)}catch{}}function od(){this.g=new Bf}function rd(u,h,m){const _=m||"";try{Fs(u,function(R,x){let L=R;f(R)&&(L=xo(R)),h.push(_+x+"="+encodeURIComponent(L))})}catch(R){throw h.push(_+"type="+encodeURIComponent("_badmap")),R}}function pi(u){this.l=u.Ub||null,this.j=u.eb||!1}w(pi,Mo),pi.prototype.g=function(){return new mi(this.l,this.j)},pi.prototype.i=function(u){return function(){return u}}({});function mi(u,h){we.call(this),this.D=u,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(mi,we),i=mi.prototype,i.open=function(u,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=h,this.readyState=1,Rn(this)},i.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(h.body=u),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,wn(this)),this.readyState=0},i.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Rn(this)),this.g&&(this.readyState=3,Rn(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Hs(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Hs(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}i.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var h=u.value?u.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!u.done}))&&(this.response=this.responseText+=h)}u.done?wn(this):Rn(this),this.readyState==3&&Hs(this)}},i.Ra=function(u){this.g&&(this.response=this.responseText=u,wn(this))},i.Qa=function(u){this.g&&(this.response=u,wn(this))},i.ga=function(){this.g&&wn(this)};function wn(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Rn(u)}i.setRequestHeader=function(u,h){this.u.append(u,h)},i.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],h=this.h.entries();for(var m=h.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=h.next();return u.join(`\r
`)};function Rn(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(mi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function zs(u){let h="";return H(u,function(m,_){h+=_,h+=":",h+=m,h+=`\r
`}),h}function Bo(u,h,m){e:{for(_ in m){var _=!1;break e}_=!0}_||(m=zs(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):le(u,h,m))}function fe(u){we.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(fe,we);var sd=/^https?$/i,ad=["POST","PUT"];i=fe.prototype,i.Ha=function(u){this.J=u},i.ea=function(u,h,m,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);h=h?h.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Vo.g(),this.v=this.o?Ts(this.o):Ts(Vo),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(h,String(u),!0),this.B=!1}catch(x){Ks(this,x);return}if(u=m||"",m=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var R in _)m.set(R,_[R]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const x of _.keys())m.set(x,_.get(x));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(m.keys()).find(x=>x.toLowerCase()=="content-type"),R=c.FormData&&u instanceof c.FormData,!(0<=Array.prototype.indexOf.call(ad,h,void 0))||_||R||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[x,L]of m)this.g.setRequestHeader(x,L);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ys(this),this.u=!0,this.g.send(u),this.u=!1}catch(x){Ks(this,x)}};function Ks(u,h){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=h,u.m=5,Ws(u),gi(u)}function Ws(u){u.A||(u.A=!0,Ne(u,"complete"),Ne(u,"error"))}i.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ne(this,"complete"),Ne(this,"abort"),gi(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),gi(this,!0)),fe.aa.N.call(this)},i.Ea=function(){this.s||(this.B||this.u||this.j?Js(this):this.bb())},i.bb=function(){Js(this)};function Js(u){if(u.h&&typeof l<"u"&&(!u.v[1]||et(u)!=4||u.Z()!=2)){if(u.u&&et(u)==4)gs(u.Ea,0,u);else if(Ne(u,"readystatechange"),et(u)==4){u.h=!1;try{const L=u.Z();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var m;if(!(m=h)){var _;if(_=L===0){var R=String(u.D).match(Us)[1]||null;!R&&c.self&&c.self.location&&(R=c.self.location.protocol.slice(0,-1)),_=!sd.test(R?R.toLowerCase():"")}m=_}if(m)Ne(u,"complete"),Ne(u,"success");else{u.m=6;try{var x=2<et(u)?u.g.statusText:""}catch{x=""}u.l=x+" ["+u.Z()+"]",Ws(u)}}finally{gi(u)}}}}function gi(u,h){if(u.g){Ys(u);const m=u.g,_=u.v[0]?()=>{}:null;u.g=null,u.v=null,h||Ne(u,"ready");try{m.onreadystatechange=_}catch{}}}function Ys(u){u.I&&(c.clearTimeout(u.I),u.I=null)}i.isActive=function(){return!!this.g};function et(u){return u.g?u.g.readyState:0}i.Z=function(){try{return 2<et(this)?this.g.status:-1}catch{return-1}},i.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.Oa=function(u){if(this.g){var h=this.g.responseText;return u&&h.indexOf(u)==0&&(h=h.substring(u.length)),Of(h)}};function Zs(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function ld(u){const h={};u=(u.g&&2<=et(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<u.length;_++){if(b(u[_]))continue;var m=S(u[_]);const R=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();const x=h[R]||[];h[R]=x,x.push(m)}I(h,function(_){return _.join(", ")})}i.Ba=function(){return this.m},i.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pn(u,h,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||h}function Qs(u){this.Aa=0,this.i=[],this.j=new Cn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Pn("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Pn("baseRetryDelayMs",5e3,u),this.cb=Pn("retryDelaySeedMs",1e4,u),this.Wa=Pn("forwardChannelMaxRetries",2,u),this.wa=Pn("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Ns(u&&u.concurrentRequestLimit),this.Da=new od,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}i=Qs.prototype,i.la=8,i.G=1,i.connect=function(u,h,m,_){Ve(0),this.W=u,this.H=h||{},m&&_!==void 0&&(this.H.OSID=m,this.H.OAID=_),this.F=this.X,this.I=sa(this,null,this.W),_i(this)};function $o(u){if(Xs(u),u.G==3){var h=u.U++,m=je(u.I);if(le(m,"SID",u.K),le(m,"RID",h),le(m,"TYPE","terminate"),xn(u,m),h=new at(u,u.j,h),h.L=2,h.v=hi(je(m)),m=!1,c.navigator&&c.navigator.sendBeacon)try{m=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!m&&c.Image&&(new Image().src=h.v,m=!0),m||(h.g=aa(h.j,null),h.g.ea(h.v)),h.F=Date.now(),ci(h)}ra(u)}function yi(u){u.g&&(qo(u),u.g.cancel(),u.g=null)}function Xs(u){yi(u),u.u&&(c.clearTimeout(u.u),u.u=null),vi(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&c.clearTimeout(u.s),u.s=null)}function _i(u){if(!Vs(u.h)&&!u.s){u.s=!0;var h=u.Ga;pn||fs(),mn||(pn(),mn=!0),Co.add(h,u),u.B=0}}function ud(u,h){return ks(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=h.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Tn(y(u.Ga,u,h),oa(u,u.B)),u.B++,!0)}i.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const R=new at(this,this.j,u);let x=this.o;if(this.S&&(x?(x=T(x),E(x,this.S)):x=this.S),this.m!==null||this.O||(R.H=x,x=null),this.P)e:{for(var h=0,m=0;m<this.i.length;m++){t:{var _=this.i[m];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(h+=_,4096<h){h=m;break e}if(h===4096||m===this.i.length-1){h=m+1;break e}}h=1e3}else h=1e3;h=ea(this,R,h),m=je(this.I),le(m,"RID",u),le(m,"CVER",22),this.D&&le(m,"X-HTTP-Session-Id",this.D),xn(this,m),x&&(this.O?h="headers="+encodeURIComponent(String(zs(x)))+"&"+h:this.m&&Bo(m,this.m,x)),Oo(this.h,R),this.Ua&&le(m,"TYPE","init"),this.P?(le(m,"$req",h),le(m,"SID","null"),R.T=!0,Lo(R,m,null)):Lo(R,m,h),this.G=2}}else this.G==3&&(u?js(this,u):this.i.length==0||Vs(this.h)||js(this))};function js(u,h){var m;h?m=h.l:m=u.U++;const _=je(u.I);le(_,"SID",u.K),le(_,"RID",m),le(_,"AID",u.T),xn(u,_),u.m&&u.o&&Bo(_,u.m,u.o),m=new at(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),h&&(u.i=h.D.concat(u.i)),h=ea(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Oo(u.h,m),Lo(m,_,h)}function xn(u,h){u.H&&H(u.H,function(m,_){le(h,_,m)}),u.l&&Fs({},function(m,_){le(h,_,m)})}function ea(u,h,m){m=Math.min(u.i.length,m);var _=u.l?y(u.l.Na,u.l,u):null;e:{var R=u.i;let x=-1;for(;;){const L=["count="+m];x==-1?0<m?(x=R[0].g,L.push("ofs="+x)):x=0:L.push("ofs="+x);let re=!0;for(let Te=0;Te<m;Te++){let ie=R[Te].g;const Re=R[Te].map;if(ie-=x,0>ie)x=Math.max(0,R[Te].g-100),re=!1;else try{rd(Re,L,"req"+ie+"_")}catch{_&&_(Re)}}if(re){_=L.join("&");break e}}}return u=u.i.splice(0,m),h.D=u,_}function ta(u){if(!u.g&&!u.u){u.Y=1;var h=u.Fa;pn||fs(),mn||(pn(),mn=!0),Co.add(h,u),u.v=0}}function Go(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Tn(y(u.Fa,u),oa(u,u.v)),u.v++,!0)}i.Fa=function(){if(this.u=null,na(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Tn(y(this.ab,this),u)}},i.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ve(10),yi(this),na(this))};function qo(u){u.A!=null&&(c.clearTimeout(u.A),u.A=null)}function na(u){u.g=new at(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var h=je(u.qa);le(h,"RID","rpc"),le(h,"SID",u.K),le(h,"AID",u.T),le(h,"CI",u.F?"0":"1"),!u.F&&u.ja&&le(h,"TO",u.ja),le(h,"TYPE","xmlhttp"),xn(u,h),u.m&&u.o&&Bo(h,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=hi(je(h)),m.m=null,m.P=!0,xs(m,u)}i.Za=function(){this.C!=null&&(this.C=null,yi(this),Go(this),Ve(19))};function vi(u){u.C!=null&&(c.clearTimeout(u.C),u.C=null)}function ia(u,h){var m=null;if(u.g==h){vi(u),qo(u),u.g=null;var _=2}else if(Uo(u.h,h))m=h.D,Ls(u.h,h),_=1;else return;if(u.G!=0){if(h.o)if(_==1){m=h.m?h.m.length:0,h=Date.now()-h.F;var R=u.B;_=ai(),Ne(_,new Ss(_,m)),_i(u)}else ta(u);else if(R=h.s,R==3||R==0&&0<h.X||!(_==1&&ud(u,h)||_==2&&Go(u)))switch(m&&0<m.length&&(h=u.h,h.i=h.i.concat(m)),R){case 1:At(u,5);break;case 4:At(u,10);break;case 3:At(u,6);break;default:At(u,2)}}}function oa(u,h){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*h}function At(u,h){if(u.j.info("Error code "+h),h==2){var m=y(u.fb,u),_=u.Xa;const R=!_;_=new Et(_||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||fi(_,"https"),hi(_),R?nd(_.toString(),m):id(_.toString(),m)}else Ve(2);u.G=0,u.l&&u.l.sa(h),ra(u),Xs(u)}i.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Ve(2)):(this.j.info("Failed to ping google.com"),Ve(1))};function ra(u){if(u.G=0,u.ka=[],u.l){const h=bs(u.h);(h.length!=0||u.i.length!=0)&&(D(u.ka,h),D(u.ka,u.i),u.h.i.length=0,M(u.i),u.i.length=0),u.l.ra()}}function sa(u,h,m){var _=m instanceof Et?je(m):new Et(m);if(_.g!="")h&&(_.g=h+"."+_.g),di(_,_.s);else{var R=c.location;_=R.protocol,h=h?h+"."+R.hostname:R.hostname,R=+R.port;var x=new Et(null);_&&fi(x,_),h&&(x.g=h),R&&di(x,R),m&&(x.l=m),_=x}return m=u.D,h=u.ya,m&&h&&le(_,m,h),le(_,"VER",u.la),xn(u,_),_}function aa(u,h,m){if(h&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=u.Ca&&!u.pa?new fe(new pi({eb:m})):new fe(u.pa),h.Ha(u.J),h}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function la(){}i=la.prototype,i.ua=function(){},i.ta=function(){},i.sa=function(){},i.ra=function(){},i.isActive=function(){return!0},i.Na=function(){};function Ti(){}Ti.prototype.g=function(u,h){return new Ue(u,h)};function Ue(u,h){we.call(this),this.g=new Qs(h),this.l=u,this.h=h&&h.messageUrlParams||null,u=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(u?u["X-WebChannel-Content-Type"]=h.messageContentType:u={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(u?u["X-WebChannel-Client-Profile"]=h.va:u={"X-WebChannel-Client-Profile":h.va}),this.g.S=u,(u=h&&h.Sb)&&!b(u)&&(this.g.m=u),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!b(h)&&(this.g.D=h,u=this.h,u!==null&&h in u&&(u=this.h,h in u&&delete u[h])),this.j=new Bt(this)}w(Ue,we),Ue.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ue.prototype.close=function(){$o(this.g)},Ue.prototype.o=function(u){var h=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=xo(u),u=m);h.i.push(new Kf(h.Ya++,u)),h.G==3&&_i(h)},Ue.prototype.N=function(){this.g.l=null,delete this.j,$o(this.g),delete this.g,Ue.aa.N.call(this)};function ua(u){Do.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var h=u.__sm__;if(h){e:{for(const m in h){u=m;break e}u=void 0}(this.i=u)&&(u=this.i,h=h!==null&&u in h?h[u]:void 0),this.data=h}else this.data=u}w(ua,Do);function ca(){No.call(this),this.status=1}w(ca,No);function Bt(u){this.g=u}w(Bt,la),Bt.prototype.ua=function(){Ne(this.g,"a")},Bt.prototype.ta=function(u){Ne(this.g,new ua(u))},Bt.prototype.sa=function(u){Ne(this.g,new ca)},Bt.prototype.ra=function(){Ne(this.g,"b")},Ti.prototype.createWebChannel=Ti.prototype.g,Ue.prototype.send=Ue.prototype.o,Ue.prototype.open=Ue.prototype.m,Ue.prototype.close=Ue.prototype.close,Xu=function(){return new Ti},Qu=function(){return ai()},Zu=Tt,rr={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},li.NO_ERROR=0,li.TIMEOUT=8,li.HTTP_ERROR=6,xi=li,ws.COMPLETE="complete",Yu=ws,Cs.EventType=_n,_n.OPEN="a",_n.CLOSE="b",_n.ERROR="c",_n.MESSAGE="d",we.prototype.listen=we.prototype.K,Nn=Cs,fe.prototype.listenOnce=fe.prototype.L,fe.prototype.getLastError=fe.prototype.Ka,fe.prototype.getLastErrorCode=fe.prototype.Ba,fe.prototype.getStatus=fe.prototype.Z,fe.prototype.getResponseJson=fe.prototype.Oa,fe.prototype.getResponseText=fe.prototype.oa,fe.prototype.send=fe.prototype.ea,fe.prototype.setWithCredentials=fe.prototype.Ha,Ju=fe}).apply(typeof Ei<"u"?Ei:typeof self<"u"?self:typeof window<"u"?window:{});const Aa="@firebase/firestore",Ia="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Me.UNAUTHENTICATED=new Me(null),Me.GOOGLE_CREDENTIALS=new Me("google-credentials-uid"),Me.FIRST_PARTY=new Me("first-party-uid"),Me.MOCK_USER=new Me("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cn="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xt=new Gu("@firebase/firestore");function qt(){return xt.logLevel}function $(i,...e){if(xt.logLevel<=te.DEBUG){const t=e.map(Or);xt.debug(`Firestore (${cn}): ${i}`,...t)}}function Mt(i,...e){if(xt.logLevel<=te.ERROR){const t=e.map(Or);xt.error(`Firestore (${cn}): ${i}`,...t)}}function lo(i,...e){if(xt.logLevel<=te.WARN){const t=e.map(Or);xt.warn(`Firestore (${cn}): ${i}`,...t)}}function Or(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(i,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,ju(i,n,t)}function ju(i,e,t){let n=`FIRESTORE (${cn}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Mt(n),new Error(n)}function de(i,e,t,n){let o="Unexpected state";typeof t=="string"?o=t:n=t,i||ju(e,o,n)}function se(i,e){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends un{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Yh{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Me.UNAUTHENTICATED))}shutdown(){}}class Zh{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Qh{constructor(e){this.t=e,this.currentUser=Me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){de(this.o===void 0,42304);let n=this.i;const o=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let r=new Rt;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Rt,e.enqueueRetryable(()=>o(this.currentUser))};const l=()=>{const d=r;e.enqueueRetryable(async()=>{await d.promise,await o(this.currentUser)})},c=d=>{$("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(d=>c(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):($("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Rt)}},0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?($("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(de(typeof n.accessToken=="string",31837,{l:n}),new ec(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return de(e===null||typeof e=="string",2055,{h:e}),new Me(e)}}class Xh{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Me.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class jh{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new Xh(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Me.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Sa{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ep{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Nh(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){de(this.o===void 0,3512);const n=r=>{r.error!=null&&$("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const l=r.token!==this.m;return this.m=r.token,$("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>n(r))};const o=r=>{$("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(r=>o(r)),setTimeout(()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?o(r):$("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Sa(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(de(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Sa(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tp(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function np(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const o=tp(40);for(let r=0;r<o.length;++r)n.length<20&&o[r]<t&&(n+=e.charAt(o[r]%62))}return n}}function ne(i,e){return i<e?-1:i>e?1:0}function sr(i,e){let t=0;for(;t<i.length&&t<e.length;){const n=i.codePointAt(t),o=e.codePointAt(t);if(n!==o){if(n<128&&o<128)return ne(n,o);{const r=np(),l=ip(r.encode(wa(i,t)),r.encode(wa(e,t)));return l!==0?l:ne(n,o)}}t+=n>65535?2:1}return ne(i.length,e.length)}function wa(i,e){return i.codePointAt(e)>65535?i.substring(e,e+2):i.substring(e,e+1)}function ip(i,e){for(let t=0;t<i.length&&t<e.length;++t)if(i[t]!==e[t])return ne(i[t],e[t]);return ne(i.length,e.length)}function Qt(i,e,t){return i.length===e.length&&i.every((n,o)=>t(n,e[o]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=-62135596800,Pa=1e6;class ye{static now(){return ye.fromMillis(Date.now())}static fromDate(e){return ye.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Pa);return new ye(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new K(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new K(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Ra)throw new K(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Pa}_compareTo(e){return this.seconds===e.seconds?ne(this.nanoseconds,e.nanoseconds):ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Ra;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{static fromTimestamp(e){return new ce(e)}static min(){return new ce(new ye(0,0))}static max(){return new ce(new ye(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xa="__name__";class ze{constructor(e,t,n){t===void 0?t=0:t>e.length&&X(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&X(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return ze.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ze?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let o=0;o<n;o++){const r=ze.compareSegments(e.get(o),t.get(o));if(r!==0)return r}return ne(e.length,t.length)}static compareSegments(e,t){const n=ze.isNumericId(e),o=ze.isNumericId(t);return n&&!o?-1:!n&&o?1:n&&o?ze.extractNumericId(e).compare(ze.extractNumericId(t)):sr(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ur.fromString(e.substring(4,e.length-2))}}class me extends ze{construct(e,t,n){return new me(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new K(V.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(o=>o.length>0))}return new me(t)}static emptyPath(){return new me([])}}const op=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ae extends ze{construct(e,t,n){return new Ae(e,t,n)}static isValidIdentifier(e){return op.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ae.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===xa}static keyField(){return new Ae([xa])}static fromServerFormat(e){const t=[];let n="",o=0;const r=()=>{if(n.length===0)throw new K(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let l=!1;for(;o<e.length;){const c=e[o];if(c==="\\"){if(o+1===e.length)throw new K(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[o+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new K(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,o+=2}else c==="`"?(l=!l,o++):c!=="."||l?(n+=c,o++):(r(),o++)}if(r(),l)throw new K(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ae(t)}static emptyPath(){return new Ae([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.path=e}static fromPath(e){return new Q(me.fromString(e))}static fromName(e){return new Q(me.fromString(e).popFirst(5))}static empty(){return new Q(me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return me.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Q(new me(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn=-1;function rp(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,o=ce.fromTimestamp(n===1e9?new ye(t+1,0):new ye(t,n));return new pt(o,Q.empty(),e)}function sp(i){return new pt(i.readTime,i.key,qn)}class pt{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new pt(ce.min(),Q.empty(),qn)}static max(){return new pt(ce.max(),Q.empty(),qn)}}function ap(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=Q.comparator(i.documentKey,e.documentKey),t!==0?t:ne(i.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lp="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class up{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Br(i){if(i.code!==V.FAILED_PRECONDITION||i.message!==lp)throw i;$("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&X(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new N((n,o)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(n,o)},this.catchCallback=r=>{this.wrapFailure(t,r).next(n,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof N?t:N.resolve(t)}catch(t){return N.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):N.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):N.reject(t)}static resolve(e){return new N((t,n)=>{t(e)})}static reject(e){return new N((t,n)=>{n(e)})}static waitFor(e){return new N((t,n)=>{let o=0,r=0,l=!1;e.forEach(c=>{++o,c.next(()=>{++r,l&&r===o&&t()},d=>n(d))}),l=!0,r===o&&t()})}static or(e){let t=N.resolve(!1);for(const n of e)t=t.next(o=>o?N.resolve(o):n());return t}static forEach(e,t){const n=[];return e.forEach((o,r)=>{n.push(t.call(this,o,r))}),this.waitFor(n)}static mapArray(e,t){return new N((n,o)=>{const r=e.length,l=new Array(r);let c=0;for(let d=0;d<r;d++){const f=d;t(e[f]).next(p=>{l[f]=p,++c,c===r&&n(l)},p=>o(p))}})}static doWhile(e,t){return new N((n,o)=>{const r=()=>{e()===!0?t().next(()=>{r()},o):n()};r()})}}function cp(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Zn(i){return i.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ue(n),this.ce=n=>t.writeSequenceNumber(n))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}$r.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gr=-1;function qr(i){return i==null}function $i(i){return i===0&&1/i==-1/0}function fp(i){return typeof i=="number"&&Number.isInteger(i)&&!$i(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nc="";function dp(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=Ma(e)),e=hp(i.get(t),e);return Ma(e)}function hp(i,e){let t=e;const n=i.length;for(let o=0;o<n;o++){const r=i.charAt(o);switch(r){case"\0":t+="";break;case nc:t+="";break;default:t+=r}}return t}function Ma(i){return i+nc+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Da(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function fn(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function ic(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e,t){this.comparator=e,this.root=t||Ce.EMPTY}insert(e,t){return new Fe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ce.BLACK,null,null))}remove(e){return new Fe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ce.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const o=this.comparator(e,n.key);if(o===0)return t+n.left.size;o<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ai(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ai(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ai(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ai(this.root,e,this.comparator,!0)}}class Ai{constructor(e,t,n,o){this.isReverse=o,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&o&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ce{constructor(e,t,n,o,r){this.key=e,this.value=t,this.color=n??Ce.RED,this.left=o??Ce.EMPTY,this.right=r??Ce.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,o,r){return new Ce(e??this.key,t??this.value,n??this.color,o??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let o=this;const r=n(e,o.key);return o=r<0?o.copy(null,null,null,o.left.insert(e,t,n),null):r===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,n)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Ce.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Ce.EMPTY;n=o.right.min(),o=o.copy(n.key,n.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ce.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ce.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw X(43730,{key:this.key,value:this.value});if(this.right.isRed())throw X(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw X(27949);return e+(this.isRed()?0:1)}}Ce.EMPTY=null,Ce.RED=!0,Ce.BLACK=!1;Ce.EMPTY=new class{constructor(){this.size=0}get key(){throw X(57766)}get value(){throw X(16141)}get color(){throw X(16727)}get left(){throw X(29726)}get right(){throw X(36894)}copy(e,t,n,o,r){return this}insert(e,t,n){return new Ce(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.comparator=e,this.data=new Fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const o=n.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Na(this.data.getIterator())}getIteratorFrom(e){return new Na(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Ie)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,r=n.getNext().key;if(this.comparator(o,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ie(this.comparator);return t.data=e,t}}class Na{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.fields=e,e.sort(Ae.comparator)}static empty(){return new qe([])}unionWith(e){let t=new Ie(Ae.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new qe(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Qt(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new pp("Invalid base64 string: "+r):r}}(e);return new Ye(t)}static fromUint8Array(e){const t=function(o){let r="";for(let l=0;l<o.length;++l)r+=String.fromCharCode(o[l]);return r}(e);return new Ye(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let o=0;o<t.length;o++)n[o]=t.charCodeAt(o);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ye.EMPTY_BYTE_STRING=new Ye("");const mp=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Dt(i){if(de(!!i,39018),typeof i=="string"){let e=0;const t=mp.exec(i);if(de(!!t,46558,{timestamp:i}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ee(i.seconds),nanos:Ee(i.nanos)}}function Ee(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function Xt(i){return typeof i=="string"?Ye.fromBase64String(i):Ye.fromUint8Array(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oc="server_timestamp",rc="__type__",sc="__previous_value__",ac="__local_write_time__";function Hr(i){var e,t;return((t=(((e=i?.mapValue)===null||e===void 0?void 0:e.fields)||{})[rc])===null||t===void 0?void 0:t.stringValue)===oc}function zr(i){const e=i.mapValue.fields[sc];return Hr(e)?zr(e):e}function Gi(i){const e=Dt(i.mapValue.fields[ac].timestampValue);return new ye(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(e,t,n,o,r,l,c,d,f,p){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=o,this.ssl=r,this.forceLongPolling=l,this.autoDetectLongPolling=c,this.longPollingOptions=d,this.useFetchStreams=f,this.isUsingEmulator=p}}const qi="(default)";class Hi{constructor(e,t){this.projectId=e,this.database=t||qi}static empty(){return new Hi("","")}get isDefaultDatabase(){return this.database===qi}isEqual(e){return e instanceof Hi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc="__type__",yp="__max__",Ii={mapValue:{}},uc="__vector__",ar="value";function Nt(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?Hr(i)?4:vp(i)?9007199254740991:_p(i)?10:11:X(28295,{value:i})}function Ze(i,e){if(i===e)return!0;const t=Nt(i);if(t!==Nt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return Gi(i).isEqual(Gi(e));case 3:return function(o,r){if(typeof o.timestampValue=="string"&&typeof r.timestampValue=="string"&&o.timestampValue.length===r.timestampValue.length)return o.timestampValue===r.timestampValue;const l=Dt(o.timestampValue),c=Dt(r.timestampValue);return l.seconds===c.seconds&&l.nanos===c.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return function(o,r){return Xt(o.bytesValue).isEqual(Xt(r.bytesValue))}(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return function(o,r){return Ee(o.geoPointValue.latitude)===Ee(r.geoPointValue.latitude)&&Ee(o.geoPointValue.longitude)===Ee(r.geoPointValue.longitude)}(i,e);case 2:return function(o,r){if("integerValue"in o&&"integerValue"in r)return Ee(o.integerValue)===Ee(r.integerValue);if("doubleValue"in o&&"doubleValue"in r){const l=Ee(o.doubleValue),c=Ee(r.doubleValue);return l===c?$i(l)===$i(c):isNaN(l)&&isNaN(c)}return!1}(i,e);case 9:return Qt(i.arrayValue.values||[],e.arrayValue.values||[],Ze);case 10:case 11:return function(o,r){const l=o.mapValue.fields||{},c=r.mapValue.fields||{};if(Da(l)!==Da(c))return!1;for(const d in l)if(l.hasOwnProperty(d)&&(c[d]===void 0||!Ze(l[d],c[d])))return!1;return!0}(i,e);default:return X(52216,{left:i})}}function Hn(i,e){return(i.values||[]).find(t=>Ze(t,e))!==void 0}function jt(i,e){if(i===e)return 0;const t=Nt(i),n=Nt(e);if(t!==n)return ne(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return ne(i.booleanValue,e.booleanValue);case 2:return function(r,l){const c=Ee(r.integerValue||r.doubleValue),d=Ee(l.integerValue||l.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1}(i,e);case 3:return Va(i.timestampValue,e.timestampValue);case 4:return Va(Gi(i),Gi(e));case 5:return sr(i.stringValue,e.stringValue);case 6:return function(r,l){const c=Xt(r),d=Xt(l);return c.compareTo(d)}(i.bytesValue,e.bytesValue);case 7:return function(r,l){const c=r.split("/"),d=l.split("/");for(let f=0;f<c.length&&f<d.length;f++){const p=ne(c[f],d[f]);if(p!==0)return p}return ne(c.length,d.length)}(i.referenceValue,e.referenceValue);case 8:return function(r,l){const c=ne(Ee(r.latitude),Ee(l.latitude));return c!==0?c:ne(Ee(r.longitude),Ee(l.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return ka(i.arrayValue,e.arrayValue);case 10:return function(r,l){var c,d,f,p;const g=r.fields||{},y=l.fields||{},A=(c=g[ar])===null||c===void 0?void 0:c.arrayValue,w=(d=y[ar])===null||d===void 0?void 0:d.arrayValue,M=ne(((f=A?.values)===null||f===void 0?void 0:f.length)||0,((p=w?.values)===null||p===void 0?void 0:p.length)||0);return M!==0?M:ka(A,w)}(i.mapValue,e.mapValue);case 11:return function(r,l){if(r===Ii.mapValue&&l===Ii.mapValue)return 0;if(r===Ii.mapValue)return 1;if(l===Ii.mapValue)return-1;const c=r.fields||{},d=Object.keys(c),f=l.fields||{},p=Object.keys(f);d.sort(),p.sort();for(let g=0;g<d.length&&g<p.length;++g){const y=sr(d[g],p[g]);if(y!==0)return y;const A=jt(c[d[g]],f[p[g]]);if(A!==0)return A}return ne(d.length,p.length)}(i.mapValue,e.mapValue);default:throw X(23264,{Pe:t})}}function Va(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return ne(i,e);const t=Dt(i),n=Dt(e),o=ne(t.seconds,n.seconds);return o!==0?o:ne(t.nanos,n.nanos)}function ka(i,e){const t=i.values||[],n=e.values||[];for(let o=0;o<t.length&&o<n.length;++o){const r=jt(t[o],n[o]);if(r)return r}return ne(t.length,n.length)}function en(i){return lr(i)}function lr(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(t){const n=Dt(t);return`time(${n.seconds},${n.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?function(t){return Xt(t).toBase64()}(i.bytesValue):"referenceValue"in i?function(t){return Q.fromName(t).toString()}(i.referenceValue):"geoPointValue"in i?function(t){return`geo(${t.latitude},${t.longitude})`}(i.geoPointValue):"arrayValue"in i?function(t){let n="[",o=!0;for(const r of t.values||[])o?o=!1:n+=",",n+=lr(r);return n+"]"}(i.arrayValue):"mapValue"in i?function(t){const n=Object.keys(t.fields||{}).sort();let o="{",r=!0;for(const l of n)r?r=!1:o+=",",o+=`${l}:${lr(t.fields[l])}`;return o+"}"}(i.mapValue):X(61005,{value:i})}function Mi(i){switch(Nt(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=zr(i);return e?16+Mi(e):16;case 5:return 2*i.stringValue.length;case 6:return Xt(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((o,r)=>o+Mi(r),0)}(i.arrayValue);case 10:case 11:return function(n){let o=0;return fn(n.fields,(r,l)=>{o+=r.length+Mi(l)}),o}(i.mapValue);default:throw X(13486,{value:i})}}function ur(i){return!!i&&"integerValue"in i}function Kr(i){return!!i&&"arrayValue"in i}function Di(i){return!!i&&"mapValue"in i}function _p(i){var e,t;return((t=(((e=i?.mapValue)===null||e===void 0?void 0:e.fields)||{})[lc])===null||t===void 0?void 0:t.stringValue)===uc}function bn(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const e={mapValue:{fields:{}}};return fn(i.mapValue.fields,(t,n)=>e.mapValue.fields[t]=bn(n)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=bn(i.arrayValue.values[t]);return e}return Object.assign({},i)}function vp(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===yp}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e){this.value=e}static empty(){return new Ge({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Di(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=bn(t)}setAll(e){let t=Ae.emptyPath(),n={},o=[];e.forEach((l,c)=>{if(!t.isImmediateParentOf(c)){const d=this.getFieldsMap(t);this.applyChanges(d,n,o),n={},o=[],t=c.popLast()}l?n[c.lastSegment()]=bn(l):o.push(c.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,n,o)}delete(e){const t=this.field(e.popLast());Di(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ze(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let o=t.mapValue.fields[e.get(n)];Di(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,n){fn(t,(o,r)=>e[o]=r);for(const o of n)delete e[o]}clone(){return new Ge(bn(this.value))}}function cc(i){const e=[];return fn(i.fields,(t,n)=>{const o=new Ae([t]);if(Di(n)){const r=cc(n.mapValue).fields;if(r.length===0)e.push(o);else for(const l of r)e.push(o.child(l))}else e.push(o)}),new qe(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e,t,n,o,r,l,c){this.key=e,this.documentType=t,this.version=n,this.readTime=o,this.createTime=r,this.data=l,this.documentState=c}static newInvalidDocument(e){return new $e(e,0,ce.min(),ce.min(),ce.min(),Ge.empty(),0)}static newFoundDocument(e,t,n,o){return new $e(e,1,t,ce.min(),n,o,0)}static newNoDocument(e,t){return new $e(e,2,t,ce.min(),ce.min(),Ge.empty(),0)}static newUnknownDocument(e,t){return new $e(e,3,t,ce.min(),ce.min(),Ge.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ge.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ge.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof $e&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e,t){this.position=e,this.inclusive=t}}function La(i,e,t){let n=0;for(let o=0;o<i.position.length;o++){const r=e[o],l=i.position[o];if(r.field.isKeyField()?n=Q.comparator(Q.fromName(l.referenceValue),t.key):n=jt(l,t.data.field(r.field)),r.dir==="desc"&&(n*=-1),n!==0)break}return n}function ba(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Ze(i.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e,t="asc"){this.field=e,this.dir=t}}function Tp(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{}class ve extends fc{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Ep(e,t,n):t==="array-contains"?new Sp(e,n):t==="in"?new wp(e,n):t==="not-in"?new Rp(e,n):t==="array-contains-any"?new Pp(e,n):new ve(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Ap(e,n):new Ip(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(jt(t,this.value)):t!==null&&Nt(this.value)===Nt(t)&&this.matchesComparison(jt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return X(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mt extends fc{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new mt(e,t)}matches(e){return dc(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function dc(i){return i.op==="and"}function hc(i){return Cp(i)&&dc(i)}function Cp(i){for(const e of i.filters)if(e instanceof mt)return!1;return!0}function cr(i){if(i instanceof ve)return i.field.canonicalString()+i.op.toString()+en(i.value);if(hc(i))return i.filters.map(e=>cr(e)).join(",");{const e=i.filters.map(t=>cr(t)).join(",");return`${i.op}(${e})`}}function pc(i,e){return i instanceof ve?function(n,o){return o instanceof ve&&n.op===o.op&&n.field.isEqual(o.field)&&Ze(n.value,o.value)}(i,e):i instanceof mt?function(n,o){return o instanceof mt&&n.op===o.op&&n.filters.length===o.filters.length?n.filters.reduce((r,l,c)=>r&&pc(l,o.filters[c]),!0):!1}(i,e):void X(19439)}function mc(i){return i instanceof ve?function(t){return`${t.field.canonicalString()} ${t.op} ${en(t.value)}`}(i):i instanceof mt?function(t){return t.op.toString()+" {"+t.getFilters().map(mc).join(" ,")+"}"}(i):"Filter"}class Ep extends ve{constructor(e,t,n){super(e,t,n),this.key=Q.fromName(n.referenceValue)}matches(e){const t=Q.comparator(e.key,this.key);return this.matchesComparison(t)}}class Ap extends ve{constructor(e,t){super(e,"in",t),this.keys=gc("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Ip extends ve{constructor(e,t){super(e,"not-in",t),this.keys=gc("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function gc(i,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>Q.fromName(n.referenceValue))}class Sp extends ve{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Kr(t)&&Hn(t.arrayValue,this.value)}}class wp extends ve{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Hn(this.value.arrayValue,t)}}class Rp extends ve{constructor(e,t){super(e,"not-in",t)}matches(e){if(Hn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Hn(this.value.arrayValue,t)}}class Pp extends ve{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Kr(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Hn(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e,t=null,n=[],o=[],r=null,l=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=o,this.limit=r,this.startAt=l,this.endAt=c,this.Ie=null}}function Fa(i,e=null,t=[],n=[],o=null,r=null,l=null){return new xp(i,e,t,n,o,r,l)}function Wr(i){const e=se(i);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>cr(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(r){return r.field.canonicalString()+r.dir}(n)).join(","),qr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>en(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>en(n)).join(",")),e.Ie=t}return e.Ie}function Jr(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!Tp(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!pc(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!ba(i.startAt,e.startAt)&&ba(i.endAt,e.endAt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e,t=null,n=[],o=[],r=null,l="F",c=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=o,this.limit=r,this.limitType=l,this.startAt=c,this.endAt=d,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function Mp(i,e,t,n,o,r,l,c){return new uo(i,e,t,n,o,r,l,c)}function Dp(i){return new uo(i)}function Ua(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function Np(i){return i.collectionGroup!==null}function Fn(i){const e=se(i);if(e.Ee===null){e.Ee=[];const t=new Set;for(const r of e.explicitOrderBy)e.Ee.push(r),t.add(r.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let c=new Ie(Ae.comparator);return l.filters.forEach(d=>{d.getFlattenedFilters().forEach(f=>{f.isInequality()&&(c=c.add(f.field))})}),c})(e).forEach(r=>{t.has(r.canonicalString())||r.isKeyField()||e.Ee.push(new Ki(r,n))}),t.has(Ae.keyField().canonicalString())||e.Ee.push(new Ki(Ae.keyField(),n))}return e.Ee}function Pt(i){const e=se(i);return e.de||(e.de=Vp(e,Fn(i))),e.de}function Vp(i,e){if(i.limitType==="F")return Fa(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map(o=>{const r=o.dir==="desc"?"asc":"desc";return new Ki(o.field,r)});const t=i.endAt?new zi(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new zi(i.startAt.position,i.startAt.inclusive):null;return Fa(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function fr(i,e,t){return new uo(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function yc(i,e){return Jr(Pt(i),Pt(e))&&i.limitType===e.limitType}function _c(i){return`${Wr(Pt(i))}|lt:${i.limitType}`}function Mn(i){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(o=>mc(o)).join(", ")}]`),qr(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(o=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(o)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(o=>en(o)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(o=>en(o)).join(",")),`Target(${n})`}(Pt(i))}; limitType=${i.limitType})`}function Yr(i,e){return e.isFoundDocument()&&function(n,o){const r=o.key.path;return n.collectionGroup!==null?o.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):Q.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)}(i,e)&&function(n,o){for(const r of Fn(n))if(!r.field.isKeyField()&&o.data.field(r.field)===null)return!1;return!0}(i,e)&&function(n,o){for(const r of n.filters)if(!r.matches(o))return!1;return!0}(i,e)&&function(n,o){return!(n.startAt&&!function(l,c,d){const f=La(l,c,d);return l.inclusive?f<=0:f<0}(n.startAt,Fn(n),o)||n.endAt&&!function(l,c,d){const f=La(l,c,d);return l.inclusive?f>=0:f>0}(n.endAt,Fn(n),o))}(i,e)}function kp(i){return(e,t)=>{let n=!1;for(const o of Fn(i)){const r=Lp(o,e,t);if(r!==0)return r;n=n||o.field.isKeyField()}return 0}}function Lp(i,e,t){const n=i.field.isKeyField()?Q.comparator(e.key,t.key):function(r,l,c){const d=l.data.field(r),f=c.data.field(r);return d!==null&&f!==null?jt(d,f):X(42886)}(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return X(19790,{direction:i.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[o,r]of n)if(this.equalsFn(o,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),o=this.inner[n];if(o===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let r=0;r<o.length;r++)if(this.equalsFn(o[r][0],e))return void(o[r]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let o=0;o<n.length;o++)if(this.equalsFn(n[o][0],e))return n.length===1?delete this.inner[t]:n.splice(o,1),this.innerSize--,!0;return!1}forEach(e){fn(this.inner,(t,n)=>{for(const[o,r]of n)e(o,r)})}isEmpty(){return ic(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp=new Fe(Q.comparator);function Wi(){return bp}const vc=new Fe(Q.comparator);function Si(...i){let e=vc;for(const t of i)e=e.insert(t.key,t);return e}function Tc(i){let e=vc;return i.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function wt(){return Un()}function Cc(){return Un()}function Un(){return new bt(i=>i.toString(),(i,e)=>i.isEqual(e))}const Fp=new Fe(Q.comparator),Up=new Ie(Q.comparator);function De(...i){let e=Up;for(const t of i)e=e.add(t);return e}const Op=new Ie(ne);function Bp(){return Op}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$i(e)?"-0":e}}function Ec(i){return{integerValue:""+i}}function $p(i,e){return fp(e)?Ec(e):Zr(i,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(){this._=void 0}}function Gp(i,e,t){return i instanceof Ji?function(o,r){const l={fields:{[rc]:{stringValue:oc},[ac]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return r&&Hr(r)&&(r=zr(r)),r&&(l.fields[sc]=r),{mapValue:l}}(t,e):i instanceof zn?Ic(i,e):i instanceof Kn?Sc(i,e):function(o,r){const l=Ac(o,r),c=Oa(l)+Oa(o.Re);return ur(l)&&ur(o.Re)?Ec(c):Zr(o.serializer,c)}(i,e)}function qp(i,e,t){return i instanceof zn?Ic(i,e):i instanceof Kn?Sc(i,e):t}function Ac(i,e){return i instanceof Yi?function(n){return ur(n)||function(r){return!!r&&"doubleValue"in r}(n)}(e)?e:{integerValue:0}:null}class Ji extends co{}class zn extends co{constructor(e){super(),this.elements=e}}function Ic(i,e){const t=wc(e);for(const n of i.elements)t.some(o=>Ze(o,n))||t.push(n);return{arrayValue:{values:t}}}class Kn extends co{constructor(e){super(),this.elements=e}}function Sc(i,e){let t=wc(e);for(const n of i.elements)t=t.filter(o=>!Ze(o,n));return{arrayValue:{values:t}}}class Yi extends co{constructor(e,t){super(),this.serializer=e,this.Re=t}}function Oa(i){return Ee(i.integerValue||i.doubleValue)}function wc(i){return Kr(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function Hp(i,e){return i.field.isEqual(e.field)&&function(n,o){return n instanceof zn&&o instanceof zn||n instanceof Kn&&o instanceof Kn?Qt(n.elements,o.elements,Ze):n instanceof Yi&&o instanceof Yi?Ze(n.Re,o.Re):n instanceof Ji&&o instanceof Ji}(i.transform,e.transform)}class zp{constructor(e,t){this.version=e,this.transformResults=t}}class tt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new tt}static exists(e){return new tt(void 0,e)}static updateTime(e){return new tt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ni(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class fo{}function Rc(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new xc(i.key,tt.none()):new Qn(i.key,i.data,tt.none());{const t=i.data,n=Ge.empty();let o=new Ie(Ae.comparator);for(let r of e.fields)if(!o.has(r)){let l=t.field(r);l===null&&r.length>1&&(r=r.popLast(),l=t.field(r)),l===null?n.delete(r):n.set(r,l),o=o.add(r)}return new Ft(i.key,n,new qe(o.toArray()),tt.none())}}function Kp(i,e,t){i instanceof Qn?function(o,r,l){const c=o.value.clone(),d=$a(o.fieldTransforms,r,l.transformResults);c.setAll(d),r.convertToFoundDocument(l.version,c).setHasCommittedMutations()}(i,e,t):i instanceof Ft?function(o,r,l){if(!Ni(o.precondition,r))return void r.convertToUnknownDocument(l.version);const c=$a(o.fieldTransforms,r,l.transformResults),d=r.data;d.setAll(Pc(o)),d.setAll(c),r.convertToFoundDocument(l.version,d).setHasCommittedMutations()}(i,e,t):function(o,r,l){r.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,t)}function On(i,e,t,n){return i instanceof Qn?function(r,l,c,d){if(!Ni(r.precondition,l))return c;const f=r.value.clone(),p=Ga(r.fieldTransforms,d,l);return f.setAll(p),l.convertToFoundDocument(l.version,f).setHasLocalMutations(),null}(i,e,t,n):i instanceof Ft?function(r,l,c,d){if(!Ni(r.precondition,l))return c;const f=Ga(r.fieldTransforms,d,l),p=l.data;return p.setAll(Pc(r)),p.setAll(f),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),c===null?null:c.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(g=>g.field))}(i,e,t,n):function(r,l,c){return Ni(r.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):c}(i,e,t)}function Wp(i,e){let t=null;for(const n of i.fieldTransforms){const o=e.data.field(n.field),r=Ac(n.transform,o||null);r!=null&&(t===null&&(t=Ge.empty()),t.set(n.field,r))}return t||null}function Ba(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!function(n,o){return n===void 0&&o===void 0||!(!n||!o)&&Qt(n,o,(r,l)=>Hp(r,l))}(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class Qn extends fo{constructor(e,t,n,o=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Ft extends fo{constructor(e,t,n,o,r=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=o,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Pc(i){const e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}}),e}function $a(i,e,t){const n=new Map;de(i.length===t.length,32656,{Ve:t.length,me:i.length});for(let o=0;o<t.length;o++){const r=i[o],l=r.transform,c=e.data.field(r.field);n.set(r.field,qp(l,c,t[o]))}return n}function Ga(i,e,t){const n=new Map;for(const o of i){const r=o.transform,l=t.data.field(o.field);n.set(o.field,Gp(r,l,e))}return n}class xc extends fo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Jp extends fo{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e,t,n,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=o}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const r=this.mutations[o];r.key.isEqual(e.key)&&Kp(r,e,n[o])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=On(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=On(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Cc();return this.mutations.forEach(o=>{const r=e.get(o.key),l=r.overlayedDocument;let c=this.applyToLocalView(l,r.mutatedFields);c=t.has(o.key)?null:c;const d=Rc(l,c);d!==null&&n.set(o.key,d),l.isValidDocument()||l.convertToNoDocument(ce.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),De())}isEqual(e){return this.batchId===e.batchId&&Qt(this.mutations,e.mutations,(t,n)=>Ba(t,n))&&Qt(this.baseMutations,e.baseMutations,(t,n)=>Ba(t,n))}}class Qr{constructor(e,t,n,o){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=o}static from(e,t,n){de(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let o=function(){return Fp}();const r=e.mutations;for(let l=0;l<r.length;l++)o=o.insert(r[l].key,n[l].version);return new Qr(e,t,n,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var he,ee;function Qp(i){switch(i){case V.OK:return X(64938);case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0;default:return X(15467,{code:i})}}function Xp(i){if(i===void 0)return Mt("GRPC error has no .code"),V.UNKNOWN;switch(i){case he.OK:return V.OK;case he.CANCELLED:return V.CANCELLED;case he.UNKNOWN:return V.UNKNOWN;case he.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case he.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case he.INTERNAL:return V.INTERNAL;case he.UNAVAILABLE:return V.UNAVAILABLE;case he.UNAUTHENTICATED:return V.UNAUTHENTICATED;case he.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case he.NOT_FOUND:return V.NOT_FOUND;case he.ALREADY_EXISTS:return V.ALREADY_EXISTS;case he.PERMISSION_DENIED:return V.PERMISSION_DENIED;case he.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case he.ABORTED:return V.ABORTED;case he.OUT_OF_RANGE:return V.OUT_OF_RANGE;case he.UNIMPLEMENTED:return V.UNIMPLEMENTED;case he.DATA_LOSS:return V.DATA_LOSS;default:return X(39323,{code:i})}}(ee=he||(he={}))[ee.OK=0]="OK",ee[ee.CANCELLED=1]="CANCELLED",ee[ee.UNKNOWN=2]="UNKNOWN",ee[ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ee[ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ee[ee.NOT_FOUND=5]="NOT_FOUND",ee[ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",ee[ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",ee[ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",ee[ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ee[ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ee[ee.ABORTED=10]="ABORTED",ee[ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",ee[ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",ee[ee.INTERNAL=13]="INTERNAL",ee[ee.UNAVAILABLE=14]="UNAVAILABLE",ee[ee.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Ur([4294967295,4294967295],0);class jp{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function dr(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function em(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function tm(i,e){return dr(i,e.toTimestamp())}function Jt(i){return de(!!i,49232),ce.fromTimestamp(function(t){const n=Dt(t);return new ye(n.seconds,n.nanos)}(i))}function Mc(i,e){return hr(i,e).canonicalString()}function hr(i,e){const t=function(o){return new me(["projects",o.projectId,"databases",o.database])}(i).child("documents");return e===void 0?t:t.child(e)}function nm(i){const e=me.fromString(i);return de(cm(e),10190,{key:e.toString()}),e}function pr(i,e){return Mc(i.databaseId,e.path)}function im(i){const e=nm(i);return e.length===4?me.emptyPath():rm(e)}function om(i){return new me(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function rm(i){return de(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function qa(i,e,t){return{name:pr(i,e),fields:t.value.mapValue.fields}}function sm(i,e){let t;if(e instanceof Qn)t={update:qa(i,e.key,e.value)};else if(e instanceof xc)t={delete:pr(i,e.key)};else if(e instanceof Ft)t={update:qa(i,e.key,e.data),updateMask:um(e.fieldMask)};else{if(!(e instanceof Jp))return X(16599,{ft:e.type});t={verify:pr(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(r,l){const c=l.transform;if(c instanceof Ji)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof zn)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Kn)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Yi)return{fieldPath:l.field.canonicalString(),increment:c.Re};throw X(20930,{transform:l.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(o,r){return r.updateTime!==void 0?{updateTime:tm(o,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:X(27497)}(i,e.precondition)),t}function am(i,e){return i&&i.length>0?(de(e!==void 0,14353),i.map(t=>function(o,r){let l=o.updateTime?Jt(o.updateTime):Jt(r);return l.isEqual(ce.min())&&(l=Jt(r)),new zp(l,o.transformResults||[])}(t,e))):[]}function lm(i){let e=im(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let o=null;if(n>0){de(n===1,65062);const p=t.from[0];p.allDescendants?o=p.collectionId:e=e.child(p.collectionId)}let r=[];t.where&&(r=function(g){const y=Dc(g);return y instanceof mt&&hc(y)?y.getFilters():[y]}(t.where));let l=[];t.orderBy&&(l=function(g){return g.map(y=>function(w){return new Ki(Ht(w.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(y))}(t.orderBy));let c=null;t.limit&&(c=function(g){let y;return y=typeof g=="object"?g.value:g,qr(y)?null:y}(t.limit));let d=null;t.startAt&&(d=function(g){const y=!!g.before,A=g.values||[];return new zi(A,y)}(t.startAt));let f=null;return t.endAt&&(f=function(g){const y=!g.before,A=g.values||[];return new zi(A,y)}(t.endAt)),Mp(e,o,l,r,c,"F",d,f)}function Dc(i){return i.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Ht(t.unaryFilter.field);return ve.create(n,"==",{doubleValue:NaN});case"IS_NULL":const o=Ht(t.unaryFilter.field);return ve.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ht(t.unaryFilter.field);return ve.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Ht(t.unaryFilter.field);return ve.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return X(61313);default:return X(60726)}}(i):i.fieldFilter!==void 0?function(t){return ve.create(Ht(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return X(58110);default:return X(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(i):i.compositeFilter!==void 0?function(t){return mt.create(t.compositeFilter.filters.map(n=>Dc(n)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return X(1026)}}(t.compositeFilter.op))}(i):X(30097,{filter:i})}function Ht(i){return Ae.fromServerFormat(i.fieldPath)}function um(i){const e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function cm(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e){this.wt=e}}function dm(i){const e=lm({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?fr(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(){this.Cn=new pm}addToCollectionParentIndex(e,t){return this.Cn.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return N.resolve()}deleteFieldIndex(e,t){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,t){return N.resolve()}getDocumentsMatchingTarget(e,t){return N.resolve(null)}getIndexType(e,t){return N.resolve(0)}getFieldIndexes(e,t){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,t){return N.resolve(pt.min())}getMinOffsetFromCollectionGroup(e,t){return N.resolve(pt.min())}updateCollectionGroup(e,t,n){return N.resolve()}updateIndexEntries(e,t){return N.resolve()}}class pm{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),o=this.index[t]||new Ie(me.comparator),r=!o.has(n);return this.index[t]=o.add(n),r}has(e){const t=e.lastSegment(),n=e.popLast(),o=this.index[t];return o&&o.has(n)}getEntries(e){return(this.index[e]||new Ie(me.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ha={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Nc=41943040;class be{static withCacheSize(e){return new be(e,be.DEFAULT_COLLECTION_PERCENTILE,be.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */be.DEFAULT_COLLECTION_PERCENTILE=10,be.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,be.DEFAULT=new be(Nc,be.DEFAULT_COLLECTION_PERCENTILE,be.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),be.DISABLED=new be(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new tn(0)}static lr(){return new tn(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const za="LruGarbageCollector",mm=1048576;function Ka([i,e],[t,n]){const o=ne(i,t);return o===0?ne(e,n):o}class gm{constructor(e){this.Er=e,this.buffer=new Ie(Ka),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Ka(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ym{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){$(za,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Zn(t)?$(za,"Ignoring IndexedDB error during garbage collection: ",t):await Br(t)}await this.mr(3e5)})}}class _m{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return N.resolve($r.le);const n=new gm(t);return this.gr.forEachTarget(e,o=>n.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>n.Rr(o))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.gr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?($("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(Ha)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?($("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ha):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let n,o,r,l,c,d,f;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?($("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),o=this.params.maximumSequenceNumbersToCollect):o=g,l=Date.now(),this.nthSequenceNumber(e,o))).next(g=>(n=g,c=Date.now(),this.removeTargets(e,n,t))).next(g=>(r=g,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(g=>(f=Date.now(),qt()<=te.DEBUG&&$("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-p}ms
	Determined least recently used ${o} in `+(c-l)+`ms
	Removed ${r} targets in `+(d-c)+`ms
	Removed ${g} documents in `+(f-d)+`ms
Total Duration: ${f-p}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:r,documentsRemoved:g})))}}function vm(i,e){return new _m(i,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(){this.changes=new bt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$e.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?N.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(e,t,n,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=o}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(n=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(n!==null&&On(n.mutation,o,qe.empty(),ye.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,De()).next(()=>n))}getLocalViewOfDocuments(e,t,n=De()){const o=wt();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,n).next(r=>{let l=Si();return r.forEach((c,d)=>{l=l.insert(c,d.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const n=wt();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,De()))}populateOverlays(e,t,n){const o=[];return n.forEach(r=>{t.has(r)||o.push(r)}),this.documentOverlayCache.getOverlays(e,o).next(r=>{r.forEach((l,c)=>{t.set(l,c)})})}computeViews(e,t,n,o){let r=Wi();const l=Un(),c=function(){return Un()}();return t.forEach((d,f)=>{const p=n.get(f.key);o.has(f.key)&&(p===void 0||p.mutation instanceof Ft)?r=r.insert(f.key,f):p!==void 0?(l.set(f.key,p.mutation.getFieldMask()),On(p.mutation,f,p.mutation.getFieldMask(),ye.now())):l.set(f.key,qe.empty())}),this.recalculateAndSaveOverlays(e,r).next(d=>(d.forEach((f,p)=>l.set(f,p)),t.forEach((f,p)=>{var g;return c.set(f,new Cm(p,(g=l.get(f))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,t){const n=Un();let o=new Fe((l,c)=>l-c),r=De();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const c of l)c.keys().forEach(d=>{const f=t.get(d);if(f===null)return;let p=n.get(d)||qe.empty();p=c.applyToLocalView(f,p),n.set(d,p);const g=(o.get(c.batchId)||De()).add(d);o=o.insert(c.batchId,g)})}).next(()=>{const l=[],c=o.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),f=d.key,p=d.value,g=Cc();p.forEach(y=>{if(!r.has(y)){const A=Rc(t.get(y),n.get(y));A!==null&&g.set(y,A),r=r.add(y)}}),l.push(this.documentOverlayCache.saveOverlays(e,f,g))}return N.waitFor(l)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,o){return function(l){return Q.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Np(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,o):this.getDocumentsMatchingCollectionQuery(e,t,n,o)}getNextDocuments(e,t,n,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,o).next(r=>{const l=o-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,o-r.size):N.resolve(wt());let c=qn,d=r;return l.next(f=>N.forEach(f,(p,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),r.get(p)?N.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{d=d.insert(p,y)}))).next(()=>this.populateOverlays(e,f,r)).next(()=>this.computeViews(e,d,f,De())).next(p=>({batchId:c,changes:Tc(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Q(t)).next(n=>{let o=Si();return n.isFoundDocument()&&(o=o.insert(n.key,n)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,n,o){const r=t.collectionGroup;let l=Si();return this.indexManager.getCollectionParents(e,r).next(c=>N.forEach(c,d=>{const f=function(g,y){return new uo(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(t,d.child(r));return this.getDocumentsMatchingCollectionQuery(e,f,n,o).next(p=>{p.forEach((g,y)=>{l=l.insert(g,y)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,t,n,o){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(l=>(r=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r,o))).next(l=>{r.forEach((d,f)=>{const p=f.getKey();l.get(p)===null&&(l=l.insert(p,$e.newInvalidDocument(p)))});let c=Si();return l.forEach((d,f)=>{const p=r.get(d);p!==void 0&&On(p.mutation,f,qe.empty(),ye.now()),Yr(t,f)&&(c=c.insert(d,f))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return N.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:Jt(o.createTime)}}(t)),N.resolve()}getNamedQuery(e,t){return N.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:dm(o.bundledQuery),readTime:Jt(o.readTime)}}(t)),N.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(){this.overlays=new Fe(Q.comparator),this.Qr=new Map}getOverlay(e,t){return N.resolve(this.overlays.get(t))}getOverlays(e,t){const n=wt();return N.forEach(t,o=>this.getOverlay(e,o).next(r=>{r!==null&&n.set(o,r)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((o,r)=>{this.St(e,t,r)}),N.resolve()}removeOverlaysForBatchId(e,t,n){const o=this.Qr.get(n);return o!==void 0&&(o.forEach(r=>this.overlays=this.overlays.remove(r)),this.Qr.delete(n)),N.resolve()}getOverlaysForCollection(e,t,n){const o=wt(),r=t.length+1,l=new Q(t.child("")),c=this.overlays.getIteratorFrom(l);for(;c.hasNext();){const d=c.getNext().value,f=d.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===r&&d.largestBatchId>n&&o.set(d.getKey(),d)}return N.resolve(o)}getOverlaysForCollectionGroup(e,t,n,o){let r=new Fe((f,p)=>f-p);const l=this.overlays.getIterator();for(;l.hasNext();){const f=l.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>n){let p=r.get(f.largestBatchId);p===null&&(p=wt(),r=r.insert(f.largestBatchId,p)),p.set(f.getKey(),f)}}const c=wt(),d=r.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((f,p)=>c.set(f,p)),!(c.size()>=o)););return N.resolve(c)}St(e,t,n){const o=this.overlays.get(n.key);if(o!==null){const l=this.Qr.get(o.largestBatchId).delete(n.key);this.Qr.set(o.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new Zp(t,n));let r=this.Qr.get(t);r===void 0&&(r=De(),this.Qr.set(t,r)),this.Qr.set(t,r.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(){this.sessionToken=Ye.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,N.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(){this.$r=new Ie(_e.Ur),this.Kr=new Ie(_e.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const n=new _e(e,t);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.zr(new _e(e,t))}jr(e,t){e.forEach(n=>this.removeReference(n,t))}Hr(e){const t=new Q(new me([])),n=new _e(t,e),o=new _e(t,e+1),r=[];return this.Kr.forEachInRange([n,o],l=>{this.zr(l),r.push(l.key)}),r}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new Q(new me([])),n=new _e(t,e),o=new _e(t,e+1);let r=De();return this.Kr.forEachInRange([n,o],l=>{r=r.add(l.key)}),r}containsKey(e){const t=new _e(e,0),n=this.$r.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class _e{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return Q.comparator(e.key,t.key)||ne(e.Zr,t.Zr)}static Wr(e,t){return ne(e.Zr,t.Zr)||Q.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Ie(_e.Ur)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,o){const r=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new Yp(r,t,n,o);this.mutationQueue.push(l);for(const c of o)this.Xr=this.Xr.add(new _e(c.key,r)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return N.resolve(l)}lookupMutationBatch(e,t){return N.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,o=this.ti(n),r=o<0?0:o;return N.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?Gr:this.nr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new _e(t,0),o=new _e(t,Number.POSITIVE_INFINITY),r=[];return this.Xr.forEachInRange([n,o],l=>{const c=this.ei(l.Zr);r.push(c)}),N.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ie(ne);return t.forEach(o=>{const r=new _e(o,0),l=new _e(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([r,l],c=>{n=n.add(c.Zr)})}),N.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,o=n.length+1;let r=n;Q.isDocumentKey(r)||(r=r.child(""));const l=new _e(new Q(r),0);let c=new Ie(ne);return this.Xr.forEachWhile(d=>{const f=d.key.path;return!!n.isPrefixOf(f)&&(f.length===o&&(c=c.add(d.Zr)),!0)},l),N.resolve(this.ni(c))}ni(e){const t=[];return e.forEach(n=>{const o=this.ei(n);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){de(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Xr;return N.forEach(t.mutations,o=>{const r=new _e(o.key,t.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=n})}sr(e){}containsKey(e,t){const n=new _e(t,0),o=this.Xr.firstAfterOrEqual(n);return N.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(e){this.ii=e,this.docs=function(){return new Fe(Q.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,o=this.docs.get(n),r=o?o.size:0,l=this.ii(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:l}),this.size+=l-r,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return N.resolve(n?n.document.mutableCopy():$e.newInvalidDocument(t))}getEntries(e,t){let n=Wi();return t.forEach(o=>{const r=this.docs.get(o);n=n.insert(o,r?r.document.mutableCopy():$e.newInvalidDocument(o))}),N.resolve(n)}getDocumentsMatchingQuery(e,t,n,o){let r=Wi();const l=t.path,c=new Q(l.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(c);for(;d.hasNext();){const{key:f,value:{document:p}}=d.getNext();if(!l.isPrefixOf(f.path))break;f.path.length>l.length+1||ap(sp(p),n)<=0||(o.has(p.key)||Yr(t,p))&&(r=r.insert(p.key,p.mutableCopy()))}return N.resolve(r)}getAllFromCollectionGroup(e,t,n,o){X(9500)}si(e,t){return N.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Pm(this)}getSize(e){return N.resolve(this.size)}}class Pm extends Tm{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((n,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(n)}),N.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e){this.persistence=e,this.oi=new bt(t=>Wr(t),Jr),this.lastRemoteSnapshotVersion=ce.min(),this.highestTargetId=0,this._i=0,this.ai=new Xr,this.targetCount=0,this.ui=tn.cr()}forEachTarget(e,t){return this.oi.forEach((n,o)=>t(o)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this._i&&(this._i=t),N.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new tn(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.Tr(t),N.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,n){let o=0;const r=[];return this.oi.forEach((l,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.oi.delete(l),r.push(this.removeMatchingKeysForTargetId(e,c.targetId)),o++)}),N.waitFor(r).next(()=>o)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){const n=this.oi.get(t)||null;return N.resolve(n)}addMatchingKeys(e,t,n){return this.ai.Gr(t,n),N.resolve()}removeMatchingKeys(e,t,n){this.ai.jr(t,n);const o=this.persistence.referenceDelegate,r=[];return o&&t.forEach(l=>{r.push(o.markPotentiallyOrphaned(e,l))}),N.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),N.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ai.Yr(t);return N.resolve(n)}containsKey(e,t){return N.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e,t){this.ci={},this.overlays={},this.li=new $r(0),this.hi=!1,this.hi=!0,this.Pi=new Sm,this.referenceDelegate=e(this),this.Ti=new xm(this),this.indexManager=new hm,this.remoteDocumentCache=function(o){return new Rm(o)}(n=>this.referenceDelegate.Ii(n)),this.serializer=new fm(t),this.Ei=new Am(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Im,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ci[e.toKey()];return n||(n=new wm(t,this.referenceDelegate),this.ci[e.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,n){$("MemoryPersistence","Starting transaction:",e);const o=new Mm(this.li.next());return this.referenceDelegate.di(),n(o).next(r=>this.referenceDelegate.Ai(o).next(()=>r)).toPromise().then(r=>(o.raiseOnCommittedEvent(),r))}Ri(e,t){return N.or(Object.values(this.ci).map(n=>()=>n.containsKey(e,t)))}}class Mm extends up{constructor(e){super(),this.currentSequenceNumber=e}}class jr{constructor(e){this.persistence=e,this.Vi=new Xr,this.mi=null}static fi(e){return new jr(e)}get gi(){if(this.mi)return this.mi;throw X(60996)}addReference(e,t,n){return this.Vi.addReference(n,t),this.gi.delete(n.toString()),N.resolve()}removeReference(e,t,n){return this.Vi.removeReference(n,t),this.gi.add(n.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),N.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(r=>this.gi.add(r.toString()))}).next(()=>n.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.gi,n=>{const o=Q.fromPath(n);return this.pi(e,o).next(r=>{r||t.removeEntry(o,ce.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(n=>{n?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return N.or([()=>N.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Zi{constructor(e,t){this.persistence=e,this.yi=new bt(n=>dp(n.path),(n,o)=>n.isEqual(o)),this.garbageCollector=vm(this,t)}static fi(e,t){return new Zi(e,t)}di(){}Ai(e){return N.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(o=>n+o))}br(e){let t=0;return this.yr(e,n=>{t++}).next(()=>t)}yr(e,t){return N.forEach(this.yi,(n,o)=>this.Dr(e,n,o).next(r=>r?N.resolve():t(o)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const o=this.persistence.getRemoteDocumentCache(),r=o.newChangeBuffer();return o.si(e,l=>this.Dr(e,l,t).next(c=>{c||(n++,r.removeEntry(l,ce.min()))})).next(()=>r.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),N.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),N.resolve()}removeReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),N.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),N.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Mi(e.data.value)),t}Dr(e,t,n){return N.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return N.resolve(o!==void 0&&o>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e,t,n,o){this.targetId=e,this.fromCache=t,this.ds=n,this.As=o}static Rs(e,t){let n=De(),o=De();for(const r of t.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:o=o.add(r.doc.key)}return new es(e,t.fromCache,n,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return xd()?8:cp(Rd())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,n,o){const r={result:null};return this.ws(e,t).next(l=>{r.result=l}).next(()=>{if(!r.result)return this.bs(e,t,o,n).next(l=>{r.result=l})}).next(()=>{if(r.result)return;const l=new Dm;return this.Ss(e,t,l).next(c=>{if(r.result=c,this.fs)return this.Ds(e,t,l,c.size)})}).next(()=>r.result)}Ds(e,t,n,o){return n.documentReadCount<this.gs?(qt()<=te.DEBUG&&$("QueryEngine","SDK will not create cache indexes for query:",Mn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),N.resolve()):(qt()<=te.DEBUG&&$("QueryEngine","Query:",Mn(t),"scans",n.documentReadCount,"local documents and returns",o,"documents as results."),n.documentReadCount>this.ps*o?(qt()<=te.DEBUG&&$("QueryEngine","The SDK decides to create cache indexes for query:",Mn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Pt(t))):N.resolve())}ws(e,t){if(Ua(t))return N.resolve(null);let n=Pt(t);return this.indexManager.getIndexType(e,n).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=fr(t,null,"F"),n=Pt(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const l=De(...r);return this.ys.getDocuments(e,l).next(c=>this.indexManager.getMinOffset(e,n).next(d=>{const f=this.vs(t,c);return this.Cs(t,f,l,d.readTime)?this.ws(e,fr(t,null,"F")):this.Fs(e,f,t,d)}))})))}bs(e,t,n,o){return Ua(t)||o.isEqual(ce.min())?N.resolve(null):this.ys.getDocuments(e,n).next(r=>{const l=this.vs(t,r);return this.Cs(t,l,n,o)?N.resolve(null):(qt()<=te.DEBUG&&$("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Mn(t)),this.Fs(e,l,t,rp(o,qn)).next(c=>c))})}vs(e,t){let n=new Ie(kp(e));return t.forEach((o,r)=>{Yr(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,o){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const r=e.limitType==="F"?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(o)>0)}Ss(e,t,n){return qt()<=te.DEBUG&&$("QueryEngine","Using full collection scan to execute query:",Mn(t)),this.ys.getDocumentsMatchingQuery(e,t,pt.min(),n)}Fs(e,t,n,o){return this.ys.getDocumentsMatchingQuery(e,n,o).next(r=>(t.forEach(l=>{r=r.insert(l.key,l)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm="LocalStore";class km{constructor(e,t,n,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new Fe(ne),this.Os=new bt(r=>Wr(r),Jr),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(n)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Em(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function Lm(i,e,t,n){return new km(i,e,t,n)}async function kc(i,e){const t=se(i);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let o;return t.mutationQueue.getAllMutationBatches(n).next(r=>(o=r,t.Ls(e),t.mutationQueue.getAllMutationBatches(n))).next(r=>{const l=[],c=[];let d=De();for(const f of o){l.push(f.batchId);for(const p of f.mutations)d=d.add(p.key)}for(const f of r){c.push(f.batchId);for(const p of f.mutations)d=d.add(p.key)}return t.localDocuments.getDocuments(n,d).next(f=>({ks:f,removedBatchIds:l,addedBatchIds:c}))})})}function bm(i,e){const t=se(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const o=e.batch.keys(),r=t.Bs.newChangeBuffer({trackRemovals:!0});return function(c,d,f,p){const g=f.batch,y=g.keys();let A=N.resolve();return y.forEach(w=>{A=A.next(()=>p.getEntry(d,w)).next(M=>{const D=f.docVersions.get(w);de(D!==null,48541),M.version.compareTo(D)<0&&(g.applyToRemoteDocument(M,f),M.isValidDocument()&&(M.setReadTime(f.commitVersion),p.addEntry(M)))})}),A.next(()=>c.mutationQueue.removeMutationBatch(d,g))}(t,n,e,r).next(()=>r.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let d=De();for(let f=0;f<c.mutationResults.length;++f)c.mutationResults[f].transformResults.length>0&&(d=d.add(c.batch.mutations[f].key));return d}(e))).next(()=>t.localDocuments.getDocuments(n,o))})}function Fm(i){const e=se(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function Um(i,e){const t=se(i);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Gr),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}class Wa{constructor(){this.activeTargetIds=Bp()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Om{constructor(){this.xo=new Wa,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,n){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Wa,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja="ConnectivityMonitor";class Ya{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){$(Ja,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){$(Ja,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wi=null;function mr(){return wi===null?wi=function(){return 268435456+Math.round(2147483648*Math.random())}():wi++,"0x"+wi.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo="RestConnection",$m={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Gm{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${n}/databases/${o}`,this.Go=this.databaseId.database===qi?`project_id=${n}`:`project_id=${n}&database_id=${o}`}zo(e,t,n,o,r){const l=mr(),c=this.jo(e,t.toUriEncodedString());$(Yo,`Sending RPC '${e}' ${l}:`,c,n);const d={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(d,o,r);const{host:f}=new URL(c),p=br(f);return this.Jo(e,c,d,n,p).then(g=>($(Yo,`Received RPC '${e}' ${l}: `,g),g),g=>{throw lo(Yo,`RPC '${e}' ${l} failed with error: `,g,"url: ",c,"request:",n),g})}Yo(e,t,n,o,r,l){return this.zo(e,t,n,o,r)}Ho(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+cn}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,r)=>e[r]=o),n&&n.headers.forEach((o,r)=>e[r]=o)}jo(e,t){const n=$m[e];return`${this.Ko}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xe="WebChannelConnection";class Hm extends Gm{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,o,r){const l=mr();return new Promise((c,d)=>{const f=new Ju;f.setWithCredentials(!0),f.listenOnce(Yu.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case xi.NO_ERROR:const g=f.getResponseJson();$(xe,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(g)),c(g);break;case xi.TIMEOUT:$(xe,`RPC '${e}' ${l} timed out`),d(new K(V.DEADLINE_EXCEEDED,"Request time out"));break;case xi.HTTP_ERROR:const y=f.getStatus();if($(xe,`RPC '${e}' ${l} failed with status:`,y,"response text:",f.getResponseText()),y>0){let A=f.getResponseJson();Array.isArray(A)&&(A=A[0]);const w=A?.error;if(w&&w.status&&w.message){const M=function(F){const b=F.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(b)>=0?b:V.UNKNOWN}(w.status);d(new K(M,w.message))}else d(new K(V.UNKNOWN,"Server responded with status "+f.getStatus()))}else d(new K(V.UNAVAILABLE,"Connection failed."));break;default:X(9055,{h_:e,streamId:l,P_:f.getLastErrorCode(),T_:f.getLastError()})}}finally{$(xe,`RPC '${e}' ${l} completed.`)}});const p=JSON.stringify(o);$(xe,`RPC '${e}' ${l} sending request:`,o),f.send(t,"POST",p,n,15)})}I_(e,t,n){const o=mr(),r=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=Xu(),c=Qu(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Ho(d.initMessageHeaders,t,n),d.encodeInitMessageHeaders=!0;const p=r.join("");$(xe,`Creating RPC '${e}' stream ${o}: ${p}`,d);const g=l.createWebChannel(p,d);this.E_(g);let y=!1,A=!1;const w=new qm({Zo:D=>{A?$(xe,`Not sending because RPC '${e}' stream ${o} is closed:`,D):(y||($(xe,`Opening RPC '${e}' stream ${o} transport.`),g.open(),y=!0),$(xe,`RPC '${e}' stream ${o} sending:`,D),g.send(D))},Xo:()=>g.close()}),M=(D,F,b)=>{D.listen(F,O=>{try{b(O)}catch(q){setTimeout(()=>{throw q},0)}})};return M(g,Nn.EventType.OPEN,()=>{A||($(xe,`RPC '${e}' stream ${o} transport opened.`),w.__())}),M(g,Nn.EventType.CLOSE,()=>{A||(A=!0,$(xe,`RPC '${e}' stream ${o} transport closed`),w.u_(),this.d_(g))}),M(g,Nn.EventType.ERROR,D=>{A||(A=!0,lo(xe,`RPC '${e}' stream ${o} transport errored. Name:`,D.name,"Message:",D.message),w.u_(new K(V.UNAVAILABLE,"The operation could not be completed")))}),M(g,Nn.EventType.MESSAGE,D=>{var F;if(!A){const b=D.data[0];de(!!b,16349);const O=b,q=O?.error||((F=O[0])===null||F===void 0?void 0:F.error);if(q){$(xe,`RPC '${e}' stream ${o} received error:`,q);const Y=q.status;let H=function(v){const E=he[v];if(E!==void 0)return Xp(E)}(Y),I=q.message;H===void 0&&(H=V.INTERNAL,I="Unknown error status: "+Y+" with message "+q.message),A=!0,w.u_(new K(H,I)),g.close()}else $(xe,`RPC '${e}' stream ${o} received:`,b),w.c_(b)}}),M(c,Zu.STAT_EVENT,D=>{D.stat===rr.PROXY?$(xe,`RPC '${e}' stream ${o} detected buffering proxy`):D.stat===rr.NOPROXY&&$(xe,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{w.a_()},0),w}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}function Zo(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ho(i){return new jp(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(e,t,n=1e3,o=1.5,r=6e4){this.xi=e,this.timerId=t,this.A_=n,this.R_=o,this.V_=r,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-n);o>0&&$("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za="PersistentStream";class zm{constructor(e,t,n,o,r,l,c,d){this.xi=e,this.S_=n,this.D_=o,this.connection=r,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Lc(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===V.RESOURCE_EXHAUSTED?(Mt(t.toString()),Mt("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,o])=>{this.v_===t&&this.z_(n,o)},n=>{e(()=>{const o=new K(V.UNKNOWN,"Fetching auth token failed: "+n.message);return this.j_(o)})})}z_(e,t){const n=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{n(()=>this.listener.e_())}),this.stream.n_(()=>{n(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{n(()=>this.j_(o))}),this.stream.onMessage(o=>{n(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return $(Za,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():($(Za,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Km extends zm{constructor(e,t,n,o,r,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,o,l),this.serializer=r}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return de(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,de(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){de(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=am(e.writeResults,e.commitTime),n=Jt(e.commitTime);return this.listener.ra(n,t)}ia(){const e={};e.database=om(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>sm(this.serializer,n))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{}class Jm extends Wm{constructor(e,t,n,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new K(V.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,n,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,l])=>this.connection.zo(e,hr(t,n),o,r,l)).catch(r=>{throw r.name==="FirebaseError"?(r.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new K(V.UNKNOWN,r.toString())})}Yo(e,t,n,o,r){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,c])=>this.connection.Yo(e,hr(t,n),o,l,c,r)).catch(l=>{throw l.name==="FirebaseError"?(l.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new K(V.UNKNOWN,l.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class Ym{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Mt(t),this.ua=!1):$("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn="RemoteStore";class Zm{constructor(e,t,n,o,r){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=r,this.Ra.No(l=>{n.enqueueAndForget(async()=>{ei(this)&&($(Xn,"Restarting streams for network reachability change."),await async function(d){const f=se(d);f.da.add(4),await jn(f),f.Va.set("Unknown"),f.da.delete(4),await po(f)}(this))})}),this.Va=new Ym(n,o)}}async function po(i){if(ei(i))for(const e of i.Aa)await e(!0)}async function jn(i){for(const e of i.Aa)await e(!1)}function ei(i){return se(i).da.size===0}async function bc(i,e,t){if(!Zn(e))throw e;i.da.add(1),await jn(i),i.Va.set("Offline"),t||(t=()=>Fm(i.localStore)),i.asyncQueue.enqueueRetryable(async()=>{$(Xn,"Retrying IndexedDB access"),await t(),i.da.delete(1),await po(i)})}function Fc(i,e){return e().catch(t=>bc(i,t,e))}async function mo(i){const e=se(i),t=gt(e);let n=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Gr;for(;Qm(e);)try{const o=await Um(e.localStore,n);if(o===null){e.Ia.length===0&&t.k_();break}n=o.batchId,Xm(e,o)}catch(o){await bc(e,o)}Uc(e)&&Oc(e)}function Qm(i){return ei(i)&&i.Ia.length<10}function Xm(i,e){i.Ia.push(e);const t=gt(i);t.N_()&&t.ea&&t.ta(e.mutations)}function Uc(i){return ei(i)&&!gt(i).O_()&&i.Ia.length>0}function Oc(i){gt(i).start()}async function jm(i){gt(i).ia()}async function eg(i){const e=gt(i);for(const t of i.Ia)e.ta(t.mutations)}async function tg(i,e,t){const n=i.Ia.shift(),o=Qr.from(n,e,t);await Fc(i,()=>i.remoteSyncer.applySuccessfulWrite(o)),await mo(i)}async function ng(i,e){e&&gt(i).ea&&await async function(n,o){if(function(l){return Qp(l)&&l!==V.ABORTED}(o.code)){const r=n.Ia.shift();gt(n).L_(),await Fc(n,()=>n.remoteSyncer.rejectFailedWrite(r.batchId,o)),await mo(n)}}(i,e),Uc(i)&&Oc(i)}async function Qa(i,e){const t=se(i);t.asyncQueue.verifyOperationInProgress(),$(Xn,"RemoteStore received new credentials");const n=ei(t);t.da.add(3),await jn(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await po(t)}async function ig(i,e){const t=se(i);e?(t.da.delete(2),await po(t)):e||(t.da.add(2),await jn(t),t.Va.set("Unknown"))}function gt(i){return i.ga||(i.ga=function(t,n,o){const r=se(t);return r.oa(),new Km(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,o)}(i.datastore,i.asyncQueue,{e_:()=>Promise.resolve(),n_:jm.bind(null,i),i_:ng.bind(null,i),na:eg.bind(null,i),ra:tg.bind(null,i)}),i.Aa.push(async e=>{e?(i.ga.L_(),await mo(i)):(await i.ga.stop(),i.Ia.length>0&&($(Xn,`Stopping write stream with ${i.Ia.length} pending writes`),i.Ia=[]))})),i.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,t,n,o,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=o,this.removalCallback=r,this.deferred=new Rt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,o,r){const l=Date.now()+n,c=new ts(e,t,l,o,r);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bc(i,e){if(Mt("AsyncQueue",`${e}: ${i}`),Zn(i))return new K(V.UNAVAILABLE,`${e}: ${i}`);throw i}class og{constructor(){this.queries=Xa(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const o=se(t),r=o.queries;o.queries=Xa(),r.forEach((l,c)=>{for(const d of c.Sa)d.onError(n)})})(this,new K(V.ABORTED,"Firestore shutting down"))}}function Xa(){return new bt(i=>_c(i),yc)}function rg(i){i.Ca.forEach(e=>{e.next()})}var ja,el;(el=ja||(ja={})).xa="default",el.Cache="cache";const sg="SyncEngine";class ag{constructor(e,t,n,o,r,l){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=o,this.currentUser=r,this.maxConcurrentLimboResolutions=l,this.lu={},this.hu=new bt(c=>_c(c),yc),this.Pu=new Map,this.Tu=new Set,this.Iu=new Fe(Q.comparator),this.Eu=new Map,this.du=new Xr,this.Au={},this.Ru=new Map,this.Vu=tn.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function lg(i,e,t){const n=dg(i);try{const o=await function(l,c){const d=se(l),f=ye.now(),p=c.reduce((A,w)=>A.add(w.key),De());let g,y;return d.persistence.runTransaction("Locally write mutations","readwrite",A=>{let w=Wi(),M=De();return d.Bs.getEntries(A,p).next(D=>{w=D,w.forEach((F,b)=>{b.isValidDocument()||(M=M.add(F))})}).next(()=>d.localDocuments.getOverlayedDocuments(A,w)).next(D=>{g=D;const F=[];for(const b of c){const O=Wp(b,g.get(b.key).overlayedDocument);O!=null&&F.push(new Ft(b.key,O,cc(O.value.mapValue),tt.exists(!0)))}return d.mutationQueue.addMutationBatch(A,f,F,c)}).next(D=>{y=D;const F=D.applyToLocalDocumentSet(g,M);return d.documentOverlayCache.saveOverlays(A,D.batchId,F)})}).then(()=>({batchId:y.batchId,changes:Tc(g)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(o.batchId),function(l,c,d){let f=l.Au[l.currentUser.toKey()];f||(f=new Fe(ne)),f=f.insert(c,d),l.Au[l.currentUser.toKey()]=f}(n,o.batchId,t),await go(n,o.changes),await mo(n.remoteStore)}catch(o){const r=Bc(o,"Failed to persist write");t.reject(r)}}function tl(i,e,t){const n=se(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const o=[];n.hu.forEach((r,l)=>{const c=l.view.Fa(e);c.snapshot&&o.push(c.snapshot)}),function(l,c){const d=se(l);d.onlineState=c;let f=!1;d.queries.forEach((p,g)=>{for(const y of g.Sa)y.Fa(c)&&(f=!0)}),f&&rg(d)}(n.eventManager,e),o.length&&n.lu.Y_(o),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function ug(i,e){const t=se(i),n=e.batch.batchId;try{const o=await bm(t.localStore,e);Gc(t,n,null),$c(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await go(t,o)}catch(o){await Br(o)}}async function cg(i,e,t){const n=se(i);try{const o=await function(l,c){const d=se(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let p;return d.mutationQueue.lookupMutationBatch(f,c).next(g=>(de(g!==null,37113),p=g.keys(),d.mutationQueue.removeMutationBatch(f,g))).next(()=>d.mutationQueue.performConsistencyCheck(f)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(f,p,c)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,p)).next(()=>d.localDocuments.getDocuments(f,p))})}(n.localStore,e);Gc(n,e,t),$c(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await go(n,o)}catch(o){await Br(o)}}function $c(i,e){(i.Ru.get(e)||[]).forEach(t=>{t.resolve()}),i.Ru.delete(e)}function Gc(i,e,t){const n=se(i);let o=n.Au[n.currentUser.toKey()];if(o){const r=o.get(e);r&&(t?r.reject(t):r.resolve(),o=o.remove(e)),n.Au[n.currentUser.toKey()]=o}}async function go(i,e,t){const n=se(i),o=[],r=[],l=[];n.hu.isEmpty()||(n.hu.forEach((c,d)=>{l.push(n.fu(d,e,t).then(f=>{var p;if((f||t)&&n.isPrimaryClient){const g=f?!f.fromCache:(p=void 0)===null||p===void 0?void 0:p.current;n.sharedClientState.updateQueryState(d.targetId,g?"current":"not-current")}if(f){o.push(f);const g=es.Rs(d.targetId,f);r.push(g)}}))}),await Promise.all(l),n.lu.Y_(o),await async function(d,f){const p=se(d);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>N.forEach(f,y=>N.forEach(y.ds,A=>p.persistence.referenceDelegate.addReference(g,y.targetId,A)).next(()=>N.forEach(y.As,A=>p.persistence.referenceDelegate.removeReference(g,y.targetId,A)))))}catch(g){if(!Zn(g))throw g;$(Vm,"Failed to update sequence numbers: "+g)}for(const g of f){const y=g.targetId;if(!g.fromCache){const A=p.xs.get(y),w=A.snapshotVersion,M=A.withLastLimboFreeSnapshotVersion(w);p.xs=p.xs.insert(y,M)}}}(n.localStore,r))}async function fg(i,e){const t=se(i);if(!t.currentUser.isEqual(e)){$(sg,"User change. New user:",e.toKey());const n=await kc(t.localStore,e);t.currentUser=e,function(r,l){r.Ru.forEach(c=>{c.forEach(d=>{d.reject(new K(V.CANCELLED,l))})}),r.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await go(t,n.ks)}}function dg(i){const e=se(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ug.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=cg.bind(null,e),e}class Qi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ho(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return Lm(this.persistence,new Nm,e.initialUser,this.serializer)}Su(e){return new Vc(jr.fi,this.serializer)}bu(e){return new Om}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qi.provider={build:()=>new Qi};class hg extends Qi{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){de(this.persistence.referenceDelegate instanceof Zi,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new ym(n,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?be.withCacheSize(this.cacheSizeBytes):be.DEFAULT;return new Vc(n=>Zi.fi(n,t),this.serializer)}}class gr{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>tl(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=fg.bind(null,this.syncEngine),await ig(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new og}()}createDatastore(e){const t=ho(e.databaseInfo.databaseId),n=function(r){return new Hm(r)}(e.databaseInfo);return function(r,l,c,d){return new Jm(r,l,c,d)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,o,r,l,c){return new Zm(n,o,r,l,c)}(this.localStore,this.datastore,e.asyncQueue,t=>tl(this.syncEngine,t,0),function(){return Ya.C()?new Ya:new Bm}())}createSyncEngine(e,t){return function(o,r,l,c,d,f,p){const g=new ag(o,r,l,c,d,f);return p&&(g.mu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const r=se(o);$(Xn,"RemoteStore shutting down."),r.da.add(5),await jn(r),r.Ra.shutdown(),r.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}gr.provider={build:()=>new gr};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt="FirestoreClient";class pg{constructor(e,t,n,o,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=o,this.user=Me.UNAUTHENTICATED,this.clientId=tc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(n,async l=>{$(yt,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(n,l=>($(yt,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Rt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Bc(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Qo(i,e){i.asyncQueue.verifyOperationInProgress(),$(yt,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener(async o=>{n.isEqual(o)||(await kc(e.localStore,o),n=o)}),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i._offlineComponents=e}async function nl(i,e){i.asyncQueue.verifyOperationInProgress();const t=await mg(i);$(yt,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener(n=>Qa(e.remoteStore,n)),i.setAppCheckTokenChangeListener((n,o)=>Qa(e.remoteStore,o)),i._onlineComponents=e}async function mg(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){$(yt,"Using user provided OfflineComponentProvider");try{await Qo(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===V.FAILED_PRECONDITION||o.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;lo("Error using user provided cache. Falling back to memory cache: "+t),await Qo(i,new Qi)}}else $(yt,"Using default OfflineComponentProvider"),await Qo(i,new hg(void 0));return i._offlineComponents}async function gg(i){return i._onlineComponents||(i._uninitializedComponentsProvider?($(yt,"Using user provided OnlineComponentProvider"),await nl(i,i._uninitializedComponentsProvider._online)):($(yt,"Using default OnlineComponentProvider"),await nl(i,new gr))),i._onlineComponents}function yg(i){return gg(i).then(e=>e.syncEngine)}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const il=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _g(i,e,t){if(!t)throw new K(V.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function vg(i,e,t,n){if(e===!0&&n===!0)throw new K(V.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function ol(i){if(!Q.isDocumentKey(i))throw new K(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function ns(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":X(12329,{type:typeof i})}function yr(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new K(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ns(i);throw new K(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc="firestore.googleapis.com",rl=!0;class sl{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new K(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Hc,this.ssl=rl}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:rl;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Nc;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mm)throw new K(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vg("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qc((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new K(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new K(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new K(V.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,o){return n.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class is{constructor(e,t,n,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new K(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new K(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sl(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Yh;switch(n.type){case"firstParty":return new jh(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new K(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=il.get(t);n&&($("ComponentProvider","Removing Datastore"),il.delete(t),n.terminate())}(this),Promise.resolve()}}function Tg(i,e,t,n={}){var o;i=yr(i,is);const r=br(e),l=i._getSettings(),c=Object.assign(Object.assign({},l),{emulatorOptions:i._getEmulatorOptions()}),d=`${e}:${t}`;r&&(Ed(`https://${d}`),wd("Firestore",!0)),l.host!==Hc&&l.host!==d&&lo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f=Object.assign(Object.assign({},l),{host:d,ssl:r,emulatorOptions:n});if(!Fi(f,c)&&(i._setSettings(f),n.mockUserToken)){let p,g;if(typeof n.mockUserToken=="string")p=n.mockUserToken,g=Me.MOCK_USER;else{p=Ad(n.mockUserToken,(o=i._app)===null||o===void 0?void 0:o.options.projectId);const y=n.mockUserToken.sub||n.mockUserToken.user_id;if(!y)throw new K(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new Me(y)}i._authCredentials=new Zh(new ec(p,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new os(this.firestore,e,this._query)}}class nt{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new nt(this.firestore,e,this._key)}}class Wn extends os{constructor(e,t,n){super(e,t,Dp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new nt(this.firestore,null,new Q(e))}withConverter(e){return new Wn(this.firestore,e,this._path)}}function Cg(i,e,...t){if(i=Ui(i),arguments.length===1&&(e=tc.newId()),_g("doc","path",e),i instanceof is){const n=me.fromString(e,...t);return ol(n),new nt(i,null,new Q(n))}{if(!(i instanceof nt||i instanceof Wn))throw new K(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(me.fromString(e,...t));return ol(n),new nt(i.firestore,i instanceof Wn?i.converter:null,new Q(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const al="AsyncQueue";class ll{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Lc(this,"async_queue_retry"),this.rc=()=>{const n=Zo();n&&$(al,"Visibility state changed to "+n.visibilityState),this.x_.b_()},this.sc=e;const t=Zo();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Zo();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Rt;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!Zn(e))throw e;$(al,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(n=>{throw this.Xu=n,this.ec=!1,Mt("INTERNAL UNHANDLED ERROR: ",ul(n)),n}).then(n=>(this.ec=!1,n))));return this.sc=t,t}enqueueAfterDelay(e,t,n){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=ts.createAndSchedule(this,e,t,n,r=>this.uc(r));return this.Zu.push(o),o}oc(){this.Xu&&X(47125,{cc:ul(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function ul(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}class zc extends is{constructor(e,t,n,o){super(e,t,n,o),this.type="firestore",this._queue=new ll,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ll(e),this._firestoreClient=void 0,await e}}}function Eg(i,e){const t=typeof i=="object"?i:bh(),n=typeof i=="string"?i:qi,o=Dh(t,"firestore").getImmediate({identifier:n});if(!o._initialized){const r=Td("firestore");r&&Tg(o,...r)}return o}function Ag(i){if(i._terminated)throw new K(V.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||Ig(i),i._firestoreClient}function Ig(i){var e,t,n;const o=i._freezeSettings(),r=function(c,d,f,p){return new gp(c,d,f,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,qc(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)}(i._databaseId,((e=i._app)===null||e===void 0?void 0:e.options.appId)||"",i._persistenceKey,o);i._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=o.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(i._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),i._firestoreClient=new pg(i._authCredentials,i._appCheckCredentials,i._queue,r,i._componentsProvider&&function(c){const d=c?._online.build();return{_offline:c?._offline.build(d),_online:d}}(i._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Jn(Ye.fromBase64String(e))}catch(t){throw new K(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Jn(Ye.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new K(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ae(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new K(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new K(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ne(this._lat,e._lat)||ne(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,o){if(n.length!==o.length)return!1;for(let r=0;r<n.length;++r)if(n[r]!==o[r])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sg=/^__.*__$/;class wg{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Ft(e,this.data,this.fieldMask,t,this.fieldTransforms):new Qn(e,this.data,t,this.fieldTransforms)}}function Zc(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X(40011,{Ic:i})}}class rs{constructor(e,t,n,o,r,l){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=o,r===void 0&&this.Ec(),this.fieldTransforms=r||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new rs(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:n,Rc:!1});return o.Vc(e),o}mc(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:n,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Xi(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(Zc(this.Ic)&&Sg.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class Rg{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ho(e)}bc(e,t,n,o=!1){return new rs({Ic:e,methodName:t,wc:n,path:Ae.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pg(i){const e=i._freezeSettings(),t=ho(i._databaseId);return new Rg(i._databaseId,!!e.ignoreUndefinedProperties,t)}function xg(i,e,t,n,o,r={}){const l=i.bc(r.merge||r.mergeFields?2:0,e,t,o);ef("Data must be an object, but it was:",l,n);const c=Xc(n,l);let d,f;if(r.merge)d=new qe(l.fieldMask),f=l.fieldTransforms;else if(r.mergeFields){const p=[];for(const g of r.mergeFields){const y=Mg(e,g,t);if(!l.contains(y))throw new K(V.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Vg(p,y)||p.push(y)}d=new qe(p),f=l.fieldTransforms.filter(g=>d.covers(g.field))}else d=null,f=l.fieldTransforms;return new wg(new Ge(c),d,f)}function Qc(i,e){if(jc(i=Ui(i)))return ef("Unsupported field value:",e,i),Xc(i,e);if(i instanceof Wc)return function(n,o){if(!Zc(o.Ic))throw o.gc(`${n._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(o);r&&o.fieldTransforms.push(r)}(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(n,o){const r=[];let l=0;for(const c of n){let d=Qc(c,o.fc(l));d==null&&(d={nullValue:"NULL_VALUE"}),r.push(d),l++}return{arrayValue:{values:r}}}(i,e)}return function(n,o){if((n=Ui(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return $p(o.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=ye.fromDate(n);return{timestampValue:dr(o.serializer,r)}}if(n instanceof ye){const r=new ye(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:dr(o.serializer,r)}}if(n instanceof Jc)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Jn)return{bytesValue:em(o.serializer,n._byteString)};if(n instanceof nt){const r=o.databaseId,l=n.firestore._databaseId;if(!l.isEqual(r))throw o.gc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:Mc(n.firestore._databaseId||o.databaseId,n._key.path)}}if(n instanceof Yc)return function(l,c){return{mapValue:{fields:{[lc]:{stringValue:uc},[ar]:{arrayValue:{values:l.toArray().map(f=>{if(typeof f!="number")throw c.gc("VectorValues must only contain numeric values.");return Zr(c.serializer,f)})}}}}}}(n,o);throw o.gc(`Unsupported field value: ${ns(n)}`)}(i,e)}function Xc(i,e){const t={};return ic(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fn(i,(n,o)=>{const r=Qc(o,e.Ac(n));r!=null&&(t[n]=r)}),{mapValue:{fields:t}}}function jc(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof ye||i instanceof Jc||i instanceof Jn||i instanceof nt||i instanceof Wc||i instanceof Yc)}function ef(i,e,t){if(!jc(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const n=ns(t);throw n==="an object"?e.gc(i+" a custom object"):e.gc(i+" "+n)}}function Mg(i,e,t){if((e=Ui(e))instanceof Kc)return e._internalPath;if(typeof e=="string")return Ng(i,e);throw Xi("Field path arguments must be of type string or ",i,!1,void 0,t)}const Dg=new RegExp("[~\\*/\\[\\]]");function Ng(i,e,t){if(e.search(Dg)>=0)throw Xi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new Kc(...e.split("."))._internalPath}catch{throw Xi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function Xi(i,e,t,n,o){const r=n&&!n.isEmpty(),l=o!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let d="";return(r||l)&&(d+=" (found",r&&(d+=` in field ${n}`),l&&(d+=` in document ${o}`),d+=")"),new K(V.INVALID_ARGUMENT,c+i+d)}function Vg(i,e){return i.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kg(i,e,t){let n;return n=i?i.toFirestore(e):e,n}function Lg(i,e,t){i=yr(i,nt);const n=yr(i.firestore,zc),o=kg(i.converter,e);return bg(n,[xg(Pg(n),"setDoc",i._key,o,i.converter!==null,t).toMutation(i._key,tt.none())])}function bg(i,e){return function(n,o){const r=new Rt;return n.asyncQueue.enqueueAndForget(async()=>lg(await yg(n),o,r)),r.promise}(Ag(i),e)}(function(e,t=!0){(function(o){cn=o})(Lh),Bi(new $n("firestore",(n,{instanceIdentifier:o,options:r})=>{const l=n.getProvider("app").getImmediate(),c=new zc(new Qh(n.getProvider("auth-internal")),new ep(l,n.getProvider("app-check-internal")),function(f,p){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new K(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hi(f.options.projectId,p)}(l,o),l);return r=Object.assign({useFetchStreams:t},r),c._setSettings(r),c},"PUBLIC").setMultipleInstances(!0)),Wt(Aa,Ia,e),Wt(Aa,Ia,"esm2017")})();var oe;(function(i){i.assertEqual=o=>{};function e(o){}i.assertIs=e;function t(o){throw new Error}i.assertNever=t,i.arrayToEnum=o=>{const r={};for(const l of o)r[l]=l;return r},i.getValidEnumValues=o=>{const r=i.objectKeys(o).filter(c=>typeof o[o[c]]!="number"),l={};for(const c of r)l[c]=o[c];return i.objectValues(l)},i.objectValues=o=>i.objectKeys(o).map(function(r){return o[r]}),i.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{const r=[];for(const l in o)Object.prototype.hasOwnProperty.call(o,l)&&r.push(l);return r},i.find=(o,r)=>{for(const l of o)if(r(l))return l},i.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function n(o,r=" | "){return o.map(l=>typeof l=="string"?`'${l}'`:l).join(r)}i.joinValues=n,i.jsonStringifyReplacer=(o,r)=>typeof r=="bigint"?r.toString():r})(oe||(oe={}));var cl;(function(i){i.mergeShapes=(e,t)=>({...e,...t})})(cl||(cl={}));const B=oe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ct=i=>{switch(typeof i){case"undefined":return B.undefined;case"string":return B.string;case"number":return Number.isNaN(i)?B.nan:B.number;case"boolean":return B.boolean;case"function":return B.function;case"bigint":return B.bigint;case"symbol":return B.symbol;case"object":return Array.isArray(i)?B.array:i===null?B.null:i.then&&typeof i.then=="function"&&i.catch&&typeof i.catch=="function"?B.promise:typeof Map<"u"&&i instanceof Map?B.map:typeof Set<"u"&&i instanceof Set?B.set:typeof Date<"u"&&i instanceof Date?B.date:B.object;default:return B.unknown}},k=oe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ot extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(r){return r.message},n={_errors:[]},o=r=>{for(const l of r.issues)if(l.code==="invalid_union")l.unionErrors.map(o);else if(l.code==="invalid_return_type")o(l.returnTypeError);else if(l.code==="invalid_arguments")o(l.argumentsError);else if(l.path.length===0)n._errors.push(t(l));else{let c=n,d=0;for(;d<l.path.length;){const f=l.path[d];d===l.path.length-1?(c[f]=c[f]||{_errors:[]},c[f]._errors.push(t(l))):c[f]=c[f]||{_errors:[]},c=c[f],d++}}};return o(this),n}static assert(e){if(!(e instanceof ot))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,oe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const o of this.issues)o.path.length>0?(t[o.path[0]]=t[o.path[0]]||[],t[o.path[0]].push(e(o))):n.push(e(o));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}ot.create=i=>new ot(i);const _r=(i,e)=>{let t;switch(i.code){case k.invalid_type:i.received===B.undefined?t="Required":t=`Expected ${i.expected}, received ${i.received}`;break;case k.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(i.expected,oe.jsonStringifyReplacer)}`;break;case k.unrecognized_keys:t=`Unrecognized key(s) in object: ${oe.joinValues(i.keys,", ")}`;break;case k.invalid_union:t="Invalid input";break;case k.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${oe.joinValues(i.options)}`;break;case k.invalid_enum_value:t=`Invalid enum value. Expected ${oe.joinValues(i.options)}, received '${i.received}'`;break;case k.invalid_arguments:t="Invalid function arguments";break;case k.invalid_return_type:t="Invalid function return type";break;case k.invalid_date:t="Invalid date";break;case k.invalid_string:typeof i.validation=="object"?"includes"in i.validation?(t=`Invalid input: must include "${i.validation.includes}"`,typeof i.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${i.validation.position}`)):"startsWith"in i.validation?t=`Invalid input: must start with "${i.validation.startsWith}"`:"endsWith"in i.validation?t=`Invalid input: must end with "${i.validation.endsWith}"`:oe.assertNever(i.validation):i.validation!=="regex"?t=`Invalid ${i.validation}`:t="Invalid";break;case k.too_small:i.type==="array"?t=`Array must contain ${i.exact?"exactly":i.inclusive?"at least":"more than"} ${i.minimum} element(s)`:i.type==="string"?t=`String must contain ${i.exact?"exactly":i.inclusive?"at least":"over"} ${i.minimum} character(s)`:i.type==="number"?t=`Number must be ${i.exact?"exactly equal to ":i.inclusive?"greater than or equal to ":"greater than "}${i.minimum}`:i.type==="date"?t=`Date must be ${i.exact?"exactly equal to ":i.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(i.minimum))}`:t="Invalid input";break;case k.too_big:i.type==="array"?t=`Array must contain ${i.exact?"exactly":i.inclusive?"at most":"less than"} ${i.maximum} element(s)`:i.type==="string"?t=`String must contain ${i.exact?"exactly":i.inclusive?"at most":"under"} ${i.maximum} character(s)`:i.type==="number"?t=`Number must be ${i.exact?"exactly":i.inclusive?"less than or equal to":"less than"} ${i.maximum}`:i.type==="bigint"?t=`BigInt must be ${i.exact?"exactly":i.inclusive?"less than or equal to":"less than"} ${i.maximum}`:i.type==="date"?t=`Date must be ${i.exact?"exactly":i.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(i.maximum))}`:t="Invalid input";break;case k.custom:t="Invalid input";break;case k.invalid_intersection_types:t="Intersection results could not be merged";break;case k.not_multiple_of:t=`Number must be a multiple of ${i.multipleOf}`;break;case k.not_finite:t="Number must be finite";break;default:t=e.defaultError,oe.assertNever(i)}return{message:t}};let Fg=_r;function Ug(){return Fg}const Og=i=>{const{data:e,path:t,errorMaps:n,issueData:o}=i,r=[...t,...o.path||[]],l={...o,path:r};if(o.message!==void 0)return{...o,path:r,message:o.message};let c="";const d=n.filter(f=>!!f).slice().reverse();for(const f of d)c=f(l,{data:e,defaultError:c}).message;return{...o,path:r,message:c}};function U(i,e){const t=Ug(),n=Og({issueData:e,data:i.data,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,t,t===_r?void 0:_r].filter(o=>!!o)});i.common.issues.push(n)}class Le{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const o of t){if(o.status==="aborted")return J;o.status==="dirty"&&e.dirty(),n.push(o.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const o of t){const r=await o.key,l=await o.value;n.push({key:r,value:l})}return Le.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const o of t){const{key:r,value:l}=o;if(r.status==="aborted"||l.status==="aborted")return J;r.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),r.value!=="__proto__"&&(typeof l.value<"u"||o.alwaysSet)&&(n[r.value]=l.value)}return{status:e.value,value:n}}}const J=Object.freeze({status:"aborted"}),Vn=i=>({status:"dirty",value:i}),Oe=i=>({status:"valid",value:i}),fl=i=>i.status==="aborted",dl=i=>i.status==="dirty",nn=i=>i.status==="valid",ji=i=>typeof Promise<"u"&&i instanceof Promise;var G;(function(i){i.errToObj=e=>typeof e=="string"?{message:e}:e||{},i.toString=e=>typeof e=="string"?e:e?.message})(G||(G={}));class Qe{constructor(e,t,n,o){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const hl=(i,e)=>{if(nn(e))return{success:!0,data:e.value};if(!i.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ot(i.common.issues);return this._error=t,this._error}}};function Z(i){if(!i)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:o}=i;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:o}:{errorMap:(l,c)=>{const{message:d}=i;return l.code==="invalid_enum_value"?{message:d??c.defaultError}:typeof c.data>"u"?{message:d??n??c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:d??t??c.defaultError}},description:o}}class j{get description(){return this._def.description}_getType(e){return ct(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ct(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Le,ctx:{common:e.parent.common,data:e.data,parsedType:ct(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(ji(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){const n={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ct(e)},o=this._parseSync({data:e,path:n.path,parent:n});return hl(n,o)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ct(e)};if(!this["~standard"].async)try{const n=this._parseSync({data:e,path:[],parent:t});return nn(n)?{value:n.value}:{issues:t.common.issues}}catch(n){n?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(n=>nn(n)?{value:n.value}:{issues:t.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ct(e)},o=this._parse({data:e,path:n.path,parent:n}),r=await(ji(o)?o:Promise.resolve(o));return hl(n,r)}refine(e,t){const n=o=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(o):t;return this._refinement((o,r)=>{const l=e(o),c=()=>r.addIssue({code:k.custom,...n(o)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,t){return this._refinement((n,o)=>e(n)?!0:(o.addIssue(typeof t=="function"?t(n,o):t),!1))}_refinement(e){return new sn({schema:this,typeName:W.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return ht.create(this,this._def)}nullable(){return an.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Je.create(this)}promise(){return oo.create(this,this._def)}or(e){return to.create([this,e],this._def)}and(e){return no.create(this,e,this._def)}transform(e){return new sn({...Z(this._def),schema:this,typeName:W.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Er({...Z(this._def),innerType:this,defaultValue:t,typeName:W.ZodDefault})}brand(){return new ly({typeName:W.ZodBranded,type:this,...Z(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new Ar({...Z(this._def),innerType:this,catchValue:t,typeName:W.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return ss.create(this,e)}readonly(){return Ir.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Bg=/^c[^\s-]{8,}$/i,$g=/^[0-9a-z]+$/,Gg=/^[0-9A-HJKMNP-TV-Z]{26}$/i,qg=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Hg=/^[a-z0-9_-]{21}$/i,zg=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Kg=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Wg=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Jg="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Xo;const Yg=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Zg=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Qg=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Xg=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,jg=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ey=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,tf="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ty=new RegExp(`^${tf}$`);function nf(i){let e="[0-5]\\d";i.precision?e=`${e}\\.\\d{${i.precision}}`:i.precision==null&&(e=`${e}(\\.\\d+)?`);const t=i.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function ny(i){return new RegExp(`^${nf(i)}$`)}function iy(i){let e=`${tf}T${nf(i)}`;const t=[];return t.push(i.local?"Z?":"Z"),i.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function oy(i,e){return!!((e==="v4"||!e)&&Yg.test(i)||(e==="v6"||!e)&&Qg.test(i))}function ry(i,e){if(!zg.test(i))return!1;try{const[t]=i.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),o=JSON.parse(atob(n));return!(typeof o!="object"||o===null||"typ"in o&&o?.typ!=="JWT"||!o.alg||e&&o.alg!==e)}catch{return!1}}function sy(i,e){return!!((e==="v4"||!e)&&Zg.test(i)||(e==="v6"||!e)&&Xg.test(i))}class Ke extends j{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==B.string){const r=this._getOrReturnCtx(e);return U(r,{code:k.invalid_type,expected:B.string,received:r.parsedType}),J}const n=new Le;let o;for(const r of this._def.checks)if(r.kind==="min")e.data.length<r.value&&(o=this._getOrReturnCtx(e,o),U(o,{code:k.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),n.dirty());else if(r.kind==="max")e.data.length>r.value&&(o=this._getOrReturnCtx(e,o),U(o,{code:k.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),n.dirty());else if(r.kind==="length"){const l=e.data.length>r.value,c=e.data.length<r.value;(l||c)&&(o=this._getOrReturnCtx(e,o),l?U(o,{code:k.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):c&&U(o,{code:k.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),n.dirty())}else if(r.kind==="email")Wg.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"email",code:k.invalid_string,message:r.message}),n.dirty());else if(r.kind==="emoji")Xo||(Xo=new RegExp(Jg,"u")),Xo.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"emoji",code:k.invalid_string,message:r.message}),n.dirty());else if(r.kind==="uuid")qg.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"uuid",code:k.invalid_string,message:r.message}),n.dirty());else if(r.kind==="nanoid")Hg.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"nanoid",code:k.invalid_string,message:r.message}),n.dirty());else if(r.kind==="cuid")Bg.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"cuid",code:k.invalid_string,message:r.message}),n.dirty());else if(r.kind==="cuid2")$g.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"cuid2",code:k.invalid_string,message:r.message}),n.dirty());else if(r.kind==="ulid")Gg.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"ulid",code:k.invalid_string,message:r.message}),n.dirty());else if(r.kind==="url")try{new URL(e.data)}catch{o=this._getOrReturnCtx(e,o),U(o,{validation:"url",code:k.invalid_string,message:r.message}),n.dirty()}else r.kind==="regex"?(r.regex.lastIndex=0,r.regex.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"regex",code:k.invalid_string,message:r.message}),n.dirty())):r.kind==="trim"?e.data=e.data.trim():r.kind==="includes"?e.data.includes(r.value,r.position)||(o=this._getOrReturnCtx(e,o),U(o,{code:k.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),n.dirty()):r.kind==="toLowerCase"?e.data=e.data.toLowerCase():r.kind==="toUpperCase"?e.data=e.data.toUpperCase():r.kind==="startsWith"?e.data.startsWith(r.value)||(o=this._getOrReturnCtx(e,o),U(o,{code:k.invalid_string,validation:{startsWith:r.value},message:r.message}),n.dirty()):r.kind==="endsWith"?e.data.endsWith(r.value)||(o=this._getOrReturnCtx(e,o),U(o,{code:k.invalid_string,validation:{endsWith:r.value},message:r.message}),n.dirty()):r.kind==="datetime"?iy(r).test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{code:k.invalid_string,validation:"datetime",message:r.message}),n.dirty()):r.kind==="date"?ty.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{code:k.invalid_string,validation:"date",message:r.message}),n.dirty()):r.kind==="time"?ny(r).test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{code:k.invalid_string,validation:"time",message:r.message}),n.dirty()):r.kind==="duration"?Kg.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"duration",code:k.invalid_string,message:r.message}),n.dirty()):r.kind==="ip"?oy(e.data,r.version)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"ip",code:k.invalid_string,message:r.message}),n.dirty()):r.kind==="jwt"?ry(e.data,r.alg)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"jwt",code:k.invalid_string,message:r.message}),n.dirty()):r.kind==="cidr"?sy(e.data,r.version)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"cidr",code:k.invalid_string,message:r.message}),n.dirty()):r.kind==="base64"?jg.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"base64",code:k.invalid_string,message:r.message}),n.dirty()):r.kind==="base64url"?ey.test(e.data)||(o=this._getOrReturnCtx(e,o),U(o,{validation:"base64url",code:k.invalid_string,message:r.message}),n.dirty()):oe.assertNever(r);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(o=>e.test(o),{validation:t,code:k.invalid_string,...G.errToObj(n)})}_addCheck(e){return new Ke({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...G.errToObj(e)})}url(e){return this._addCheck({kind:"url",...G.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...G.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...G.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...G.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...G.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...G.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...G.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...G.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...G.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...G.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...G.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...G.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...G.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...G.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...G.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...G.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...G.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...G.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...G.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...G.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...G.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...G.errToObj(t)})}nonempty(e){return this.min(1,G.errToObj(e))}trim(){return new Ke({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ke({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ke({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Ke.create=i=>new Ke({checks:[],typeName:W.ZodString,coerce:i?.coerce??!1,...Z(i)});function ay(i,e){const t=(i.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=t>n?t:n,r=Number.parseInt(i.toFixed(o).replace(".","")),l=Number.parseInt(e.toFixed(o).replace(".",""));return r%l/10**o}class Vt extends j{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==B.number){const r=this._getOrReturnCtx(e);return U(r,{code:k.invalid_type,expected:B.number,received:r.parsedType}),J}let n;const o=new Le;for(const r of this._def.checks)r.kind==="int"?oe.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),U(n,{code:k.invalid_type,expected:"integer",received:"float",message:r.message}),o.dirty()):r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(n=this._getOrReturnCtx(e,n),U(n,{code:k.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),o.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(n=this._getOrReturnCtx(e,n),U(n,{code:k.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),o.dirty()):r.kind==="multipleOf"?ay(e.data,r.value)!==0&&(n=this._getOrReturnCtx(e,n),U(n,{code:k.not_multiple_of,multipleOf:r.value,message:r.message}),o.dirty()):r.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),U(n,{code:k.not_finite,message:r.message}),o.dirty()):oe.assertNever(r);return{status:o.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,G.toString(t))}gt(e,t){return this.setLimit("min",e,!1,G.toString(t))}lte(e,t){return this.setLimit("max",e,!0,G.toString(t))}lt(e,t){return this.setLimit("max",e,!1,G.toString(t))}setLimit(e,t,n,o){return new Vt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:G.toString(o)}]})}_addCheck(e){return new Vt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:G.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:G.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:G.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:G.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:G.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:G.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:G.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:G.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:G.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&oe.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Vt.create=i=>new Vt({checks:[],typeName:W.ZodNumber,coerce:i?.coerce||!1,...Z(i)});class kt extends j{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==B.bigint)return this._getInvalidInput(e);let n;const o=new Le;for(const r of this._def.checks)r.kind==="min"?(r.inclusive?e.data<r.value:e.data<=r.value)&&(n=this._getOrReturnCtx(e,n),U(n,{code:k.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),o.dirty()):r.kind==="max"?(r.inclusive?e.data>r.value:e.data>=r.value)&&(n=this._getOrReturnCtx(e,n),U(n,{code:k.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),o.dirty()):r.kind==="multipleOf"?e.data%r.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),U(n,{code:k.not_multiple_of,multipleOf:r.value,message:r.message}),o.dirty()):oe.assertNever(r);return{status:o.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return U(t,{code:k.invalid_type,expected:B.bigint,received:t.parsedType}),J}gte(e,t){return this.setLimit("min",e,!0,G.toString(t))}gt(e,t){return this.setLimit("min",e,!1,G.toString(t))}lte(e,t){return this.setLimit("max",e,!0,G.toString(t))}lt(e,t){return this.setLimit("max",e,!1,G.toString(t))}setLimit(e,t,n,o){return new kt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:G.toString(o)}]})}_addCheck(e){return new kt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:G.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:G.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:G.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:G.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:G.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}kt.create=i=>new kt({checks:[],typeName:W.ZodBigInt,coerce:i?.coerce??!1,...Z(i)});class eo extends j{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==B.boolean){const n=this._getOrReturnCtx(e);return U(n,{code:k.invalid_type,expected:B.boolean,received:n.parsedType}),J}return Oe(e.data)}}eo.create=i=>new eo({typeName:W.ZodBoolean,coerce:i?.coerce||!1,...Z(i)});class on extends j{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==B.date){const r=this._getOrReturnCtx(e);return U(r,{code:k.invalid_type,expected:B.date,received:r.parsedType}),J}if(Number.isNaN(e.data.getTime())){const r=this._getOrReturnCtx(e);return U(r,{code:k.invalid_date}),J}const n=new Le;let o;for(const r of this._def.checks)r.kind==="min"?e.data.getTime()<r.value&&(o=this._getOrReturnCtx(e,o),U(o,{code:k.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),n.dirty()):r.kind==="max"?e.data.getTime()>r.value&&(o=this._getOrReturnCtx(e,o),U(o,{code:k.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),n.dirty()):oe.assertNever(r);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new on({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:G.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:G.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}on.create=i=>new on({checks:[],coerce:i?.coerce||!1,typeName:W.ZodDate,...Z(i)});class pl extends j{_parse(e){if(this._getType(e)!==B.symbol){const n=this._getOrReturnCtx(e);return U(n,{code:k.invalid_type,expected:B.symbol,received:n.parsedType}),J}return Oe(e.data)}}pl.create=i=>new pl({typeName:W.ZodSymbol,...Z(i)});class ml extends j{_parse(e){if(this._getType(e)!==B.undefined){const n=this._getOrReturnCtx(e);return U(n,{code:k.invalid_type,expected:B.undefined,received:n.parsedType}),J}return Oe(e.data)}}ml.create=i=>new ml({typeName:W.ZodUndefined,...Z(i)});class gl extends j{_parse(e){if(this._getType(e)!==B.null){const n=this._getOrReturnCtx(e);return U(n,{code:k.invalid_type,expected:B.null,received:n.parsedType}),J}return Oe(e.data)}}gl.create=i=>new gl({typeName:W.ZodNull,...Z(i)});class yl extends j{constructor(){super(...arguments),this._any=!0}_parse(e){return Oe(e.data)}}yl.create=i=>new yl({typeName:W.ZodAny,...Z(i)});class vr extends j{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Oe(e.data)}}vr.create=i=>new vr({typeName:W.ZodUnknown,...Z(i)});class _t extends j{_parse(e){const t=this._getOrReturnCtx(e);return U(t,{code:k.invalid_type,expected:B.never,received:t.parsedType}),J}}_t.create=i=>new _t({typeName:W.ZodNever,...Z(i)});class _l extends j{_parse(e){if(this._getType(e)!==B.undefined){const n=this._getOrReturnCtx(e);return U(n,{code:k.invalid_type,expected:B.void,received:n.parsedType}),J}return Oe(e.data)}}_l.create=i=>new _l({typeName:W.ZodVoid,...Z(i)});class Je extends j{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),o=this._def;if(t.parsedType!==B.array)return U(t,{code:k.invalid_type,expected:B.array,received:t.parsedType}),J;if(o.exactLength!==null){const l=t.data.length>o.exactLength.value,c=t.data.length<o.exactLength.value;(l||c)&&(U(t,{code:l?k.too_big:k.too_small,minimum:c?o.exactLength.value:void 0,maximum:l?o.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:o.exactLength.message}),n.dirty())}if(o.minLength!==null&&t.data.length<o.minLength.value&&(U(t,{code:k.too_small,minimum:o.minLength.value,type:"array",inclusive:!0,exact:!1,message:o.minLength.message}),n.dirty()),o.maxLength!==null&&t.data.length>o.maxLength.value&&(U(t,{code:k.too_big,maximum:o.maxLength.value,type:"array",inclusive:!0,exact:!1,message:o.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((l,c)=>o.type._parseAsync(new Qe(t,l,t.path,c)))).then(l=>Le.mergeArray(n,l));const r=[...t.data].map((l,c)=>o.type._parseSync(new Qe(t,l,t.path,c)));return Le.mergeArray(n,r)}get element(){return this._def.type}min(e,t){return new Je({...this._def,minLength:{value:e,message:G.toString(t)}})}max(e,t){return new Je({...this._def,maxLength:{value:e,message:G.toString(t)}})}length(e,t){return new Je({...this._def,exactLength:{value:e,message:G.toString(t)}})}nonempty(e){return this.min(1,e)}}Je.create=(i,e)=>new Je({type:i,minLength:null,maxLength:null,exactLength:null,typeName:W.ZodArray,...Z(e)});function zt(i){if(i instanceof pe){const e={};for(const t in i.shape){const n=i.shape[t];e[t]=ht.create(zt(n))}return new pe({...i._def,shape:()=>e})}else return i instanceof Je?new Je({...i._def,type:zt(i.element)}):i instanceof ht?ht.create(zt(i.unwrap())):i instanceof an?an.create(zt(i.unwrap())):i instanceof Lt?Lt.create(i.items.map(e=>zt(e))):i}class pe extends j{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=oe.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==B.object){const f=this._getOrReturnCtx(e);return U(f,{code:k.invalid_type,expected:B.object,received:f.parsedType}),J}const{status:n,ctx:o}=this._processInputParams(e),{shape:r,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof _t&&this._def.unknownKeys==="strip"))for(const f in o.data)l.includes(f)||c.push(f);const d=[];for(const f of l){const p=r[f],g=o.data[f];d.push({key:{status:"valid",value:f},value:p._parse(new Qe(o,g,o.path,f)),alwaysSet:f in o.data})}if(this._def.catchall instanceof _t){const f=this._def.unknownKeys;if(f==="passthrough")for(const p of c)d.push({key:{status:"valid",value:p},value:{status:"valid",value:o.data[p]}});else if(f==="strict")c.length>0&&(U(o,{code:k.unrecognized_keys,keys:c}),n.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const p of c){const g=o.data[p];d.push({key:{status:"valid",value:p},value:f._parse(new Qe(o,g,o.path,p)),alwaysSet:p in o.data})}}return o.common.async?Promise.resolve().then(async()=>{const f=[];for(const p of d){const g=await p.key,y=await p.value;f.push({key:g,value:y,alwaysSet:p.alwaysSet})}return f}).then(f=>Le.mergeObjectSync(n,f)):Le.mergeObjectSync(n,d)}get shape(){return this._def.shape()}strict(e){return G.errToObj,new pe({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{const o=this._def.errorMap?.(t,n).message??n.defaultError;return t.code==="unrecognized_keys"?{message:G.errToObj(e).message??o}:{message:o}}}:{}})}strip(){return new pe({...this._def,unknownKeys:"strip"})}passthrough(){return new pe({...this._def,unknownKeys:"passthrough"})}extend(e){return new pe({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new pe({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:W.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new pe({...this._def,catchall:e})}pick(e){const t={};for(const n of oe.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new pe({...this._def,shape:()=>t})}omit(e){const t={};for(const n of oe.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new pe({...this._def,shape:()=>t})}deepPartial(){return zt(this)}partial(e){const t={};for(const n of oe.objectKeys(this.shape)){const o=this.shape[n];e&&!e[n]?t[n]=o:t[n]=o.optional()}return new pe({...this._def,shape:()=>t})}required(e){const t={};for(const n of oe.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let r=this.shape[n];for(;r instanceof ht;)r=r._def.innerType;t[n]=r}return new pe({...this._def,shape:()=>t})}keyof(){return of(oe.objectKeys(this.shape))}}pe.create=(i,e)=>new pe({shape:()=>i,unknownKeys:"strip",catchall:_t.create(),typeName:W.ZodObject,...Z(e)});pe.strictCreate=(i,e)=>new pe({shape:()=>i,unknownKeys:"strict",catchall:_t.create(),typeName:W.ZodObject,...Z(e)});pe.lazycreate=(i,e)=>new pe({shape:i,unknownKeys:"strip",catchall:_t.create(),typeName:W.ZodObject,...Z(e)});class to extends j{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function o(r){for(const c of r)if(c.result.status==="valid")return c.result;for(const c of r)if(c.result.status==="dirty")return t.common.issues.push(...c.ctx.common.issues),c.result;const l=r.map(c=>new ot(c.ctx.common.issues));return U(t,{code:k.invalid_union,unionErrors:l}),J}if(t.common.async)return Promise.all(n.map(async r=>{const l={...t,common:{...t.common,issues:[]},parent:null};return{result:await r._parseAsync({data:t.data,path:t.path,parent:l}),ctx:l}})).then(o);{let r;const l=[];for(const d of n){const f={...t,common:{...t.common,issues:[]},parent:null},p=d._parseSync({data:t.data,path:t.path,parent:f});if(p.status==="valid")return p;p.status==="dirty"&&!r&&(r={result:p,ctx:f}),f.common.issues.length&&l.push(f.common.issues)}if(r)return t.common.issues.push(...r.ctx.common.issues),r.result;const c=l.map(d=>new ot(d));return U(t,{code:k.invalid_union,unionErrors:c}),J}}get options(){return this._def.options}}to.create=(i,e)=>new to({options:i,typeName:W.ZodUnion,...Z(e)});function Tr(i,e){const t=ct(i),n=ct(e);if(i===e)return{valid:!0,data:i};if(t===B.object&&n===B.object){const o=oe.objectKeys(e),r=oe.objectKeys(i).filter(c=>o.indexOf(c)!==-1),l={...i,...e};for(const c of r){const d=Tr(i[c],e[c]);if(!d.valid)return{valid:!1};l[c]=d.data}return{valid:!0,data:l}}else if(t===B.array&&n===B.array){if(i.length!==e.length)return{valid:!1};const o=[];for(let r=0;r<i.length;r++){const l=i[r],c=e[r],d=Tr(l,c);if(!d.valid)return{valid:!1};o.push(d.data)}return{valid:!0,data:o}}else return t===B.date&&n===B.date&&+i==+e?{valid:!0,data:i}:{valid:!1}}class no extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),o=(r,l)=>{if(fl(r)||fl(l))return J;const c=Tr(r.value,l.value);return c.valid?((dl(r)||dl(l))&&t.dirty(),{status:t.value,value:c.data}):(U(n,{code:k.invalid_intersection_types}),J)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([r,l])=>o(r,l)):o(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}no.create=(i,e,t)=>new no({left:i,right:e,typeName:W.ZodIntersection,...Z(t)});class Lt extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==B.array)return U(n,{code:k.invalid_type,expected:B.array,received:n.parsedType}),J;if(n.data.length<this._def.items.length)return U(n,{code:k.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),J;!this._def.rest&&n.data.length>this._def.items.length&&(U(n,{code:k.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...n.data].map((l,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new Qe(n,l,n.path,c)):null}).filter(l=>!!l);return n.common.async?Promise.all(r).then(l=>Le.mergeArray(t,l)):Le.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new Lt({...this._def,rest:e})}}Lt.create=(i,e)=>{if(!Array.isArray(i))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Lt({items:i,typeName:W.ZodTuple,rest:null,...Z(e)})};class io extends j{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==B.object)return U(n,{code:k.invalid_type,expected:B.object,received:n.parsedType}),J;const o=[],r=this._def.keyType,l=this._def.valueType;for(const c in n.data)o.push({key:r._parse(new Qe(n,c,n.path,c)),value:l._parse(new Qe(n,n.data[c],n.path,c)),alwaysSet:c in n.data});return n.common.async?Le.mergeObjectAsync(t,o):Le.mergeObjectSync(t,o)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof j?new io({keyType:e,valueType:t,typeName:W.ZodRecord,...Z(n)}):new io({keyType:Ke.create(),valueType:e,typeName:W.ZodRecord,...Z(t)})}}class vl extends j{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==B.map)return U(n,{code:k.invalid_type,expected:B.map,received:n.parsedType}),J;const o=this._def.keyType,r=this._def.valueType,l=[...n.data.entries()].map(([c,d],f)=>({key:o._parse(new Qe(n,c,n.path,[f,"key"])),value:r._parse(new Qe(n,d,n.path,[f,"value"]))}));if(n.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of l){const f=await d.key,p=await d.value;if(f.status==="aborted"||p.status==="aborted")return J;(f.status==="dirty"||p.status==="dirty")&&t.dirty(),c.set(f.value,p.value)}return{status:t.value,value:c}})}else{const c=new Map;for(const d of l){const f=d.key,p=d.value;if(f.status==="aborted"||p.status==="aborted")return J;(f.status==="dirty"||p.status==="dirty")&&t.dirty(),c.set(f.value,p.value)}return{status:t.value,value:c}}}}vl.create=(i,e,t)=>new vl({valueType:e,keyType:i,typeName:W.ZodMap,...Z(t)});class Yn extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==B.set)return U(n,{code:k.invalid_type,expected:B.set,received:n.parsedType}),J;const o=this._def;o.minSize!==null&&n.data.size<o.minSize.value&&(U(n,{code:k.too_small,minimum:o.minSize.value,type:"set",inclusive:!0,exact:!1,message:o.minSize.message}),t.dirty()),o.maxSize!==null&&n.data.size>o.maxSize.value&&(U(n,{code:k.too_big,maximum:o.maxSize.value,type:"set",inclusive:!0,exact:!1,message:o.maxSize.message}),t.dirty());const r=this._def.valueType;function l(d){const f=new Set;for(const p of d){if(p.status==="aborted")return J;p.status==="dirty"&&t.dirty(),f.add(p.value)}return{status:t.value,value:f}}const c=[...n.data.values()].map((d,f)=>r._parse(new Qe(n,d,n.path,f)));return n.common.async?Promise.all(c).then(d=>l(d)):l(c)}min(e,t){return new Yn({...this._def,minSize:{value:e,message:G.toString(t)}})}max(e,t){return new Yn({...this._def,maxSize:{value:e,message:G.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Yn.create=(i,e)=>new Yn({valueType:i,minSize:null,maxSize:null,typeName:W.ZodSet,...Z(e)});class Cr extends j{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Cr.create=(i,e)=>new Cr({getter:i,typeName:W.ZodLazy,...Z(e)});class Tl extends j{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return U(t,{received:t.data,code:k.invalid_literal,expected:this._def.value}),J}return{status:"valid",value:e.data}}get value(){return this._def.value}}Tl.create=(i,e)=>new Tl({value:i,typeName:W.ZodLiteral,...Z(e)});function of(i,e){return new rn({values:i,typeName:W.ZodEnum,...Z(e)})}class rn extends j{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return U(t,{expected:oe.joinValues(n),received:t.parsedType,code:k.invalid_type}),J}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return U(t,{received:t.data,code:k.invalid_enum_value,options:n}),J}return Oe(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return rn.create(e,{...this._def,...t})}exclude(e,t=this._def){return rn.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}rn.create=of;class Cl extends j{_parse(e){const t=oe.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==B.string&&n.parsedType!==B.number){const o=oe.objectValues(t);return U(n,{expected:oe.joinValues(o),received:n.parsedType,code:k.invalid_type}),J}if(this._cache||(this._cache=new Set(oe.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const o=oe.objectValues(t);return U(n,{received:n.data,code:k.invalid_enum_value,options:o}),J}return Oe(e.data)}get enum(){return this._def.values}}Cl.create=(i,e)=>new Cl({values:i,typeName:W.ZodNativeEnum,...Z(e)});class oo extends j{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==B.promise&&t.common.async===!1)return U(t,{code:k.invalid_type,expected:B.promise,received:t.parsedType}),J;const n=t.parsedType===B.promise?t.data:Promise.resolve(t.data);return Oe(n.then(o=>this._def.type.parseAsync(o,{path:t.path,errorMap:t.common.contextualErrorMap})))}}oo.create=(i,e)=>new oo({type:i,typeName:W.ZodPromise,...Z(e)});class sn extends j{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===W.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),o=this._def.effect||null,r={addIssue:l=>{U(n,l),l.fatal?t.abort():t.dirty()},get path(){return n.path}};if(r.addIssue=r.addIssue.bind(r),o.type==="preprocess"){const l=o.transform(n.data,r);if(n.common.async)return Promise.resolve(l).then(async c=>{if(t.value==="aborted")return J;const d=await this._def.schema._parseAsync({data:c,path:n.path,parent:n});return d.status==="aborted"?J:d.status==="dirty"||t.value==="dirty"?Vn(d.value):d});{if(t.value==="aborted")return J;const c=this._def.schema._parseSync({data:l,path:n.path,parent:n});return c.status==="aborted"?J:c.status==="dirty"||t.value==="dirty"?Vn(c.value):c}}if(o.type==="refinement"){const l=c=>{const d=o.refinement(c,r);if(n.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(n.common.async===!1){const c=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return c.status==="aborted"?J:(c.status==="dirty"&&t.dirty(),l(c.value),{status:t.value,value:c.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(c=>c.status==="aborted"?J:(c.status==="dirty"&&t.dirty(),l(c.value).then(()=>({status:t.value,value:c.value}))))}if(o.type==="transform")if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!nn(l))return J;const c=o.transform(l.value,r);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:c}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>nn(l)?Promise.resolve(o.transform(l.value,r)).then(c=>({status:t.value,value:c})):J);oe.assertNever(o)}}sn.create=(i,e,t)=>new sn({schema:i,typeName:W.ZodEffects,effect:e,...Z(t)});sn.createWithPreprocess=(i,e,t)=>new sn({schema:e,effect:{type:"preprocess",transform:i},typeName:W.ZodEffects,...Z(t)});class ht extends j{_parse(e){return this._getType(e)===B.undefined?Oe(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ht.create=(i,e)=>new ht({innerType:i,typeName:W.ZodOptional,...Z(e)});class an extends j{_parse(e){return this._getType(e)===B.null?Oe(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}an.create=(i,e)=>new an({innerType:i,typeName:W.ZodNullable,...Z(e)});class Er extends j{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===B.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Er.create=(i,e)=>new Er({innerType:i,typeName:W.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Z(e)});class Ar extends j{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},o=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return ji(o)?o.then(r=>({status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new ot(n.common.issues)},input:n.data})})):{status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new ot(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Ar.create=(i,e)=>new Ar({innerType:i,typeName:W.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Z(e)});class El extends j{_parse(e){if(this._getType(e)!==B.nan){const n=this._getOrReturnCtx(e);return U(n,{code:k.invalid_type,expected:B.nan,received:n.parsedType}),J}return{status:"valid",value:e.data}}}El.create=i=>new El({typeName:W.ZodNaN,...Z(i)});class ly extends j{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class ss extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const r=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return r.status==="aborted"?J:r.status==="dirty"?(t.dirty(),Vn(r.value)):this._def.out._parseAsync({data:r.value,path:n.path,parent:n})})();{const o=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?J:o.status==="dirty"?(t.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:n.path,parent:n})}}static create(e,t){return new ss({in:e,out:t,typeName:W.ZodPipeline})}}class Ir extends j{_parse(e){const t=this._def.innerType._parse(e),n=o=>(nn(o)&&(o.value=Object.freeze(o.value)),o);return ji(t)?t.then(o=>n(o)):n(t)}unwrap(){return this._def.innerType}}Ir.create=(i,e)=>new Ir({innerType:i,typeName:W.ZodReadonly,...Z(e)});var W;(function(i){i.ZodString="ZodString",i.ZodNumber="ZodNumber",i.ZodNaN="ZodNaN",i.ZodBigInt="ZodBigInt",i.ZodBoolean="ZodBoolean",i.ZodDate="ZodDate",i.ZodSymbol="ZodSymbol",i.ZodUndefined="ZodUndefined",i.ZodNull="ZodNull",i.ZodAny="ZodAny",i.ZodUnknown="ZodUnknown",i.ZodNever="ZodNever",i.ZodVoid="ZodVoid",i.ZodArray="ZodArray",i.ZodObject="ZodObject",i.ZodUnion="ZodUnion",i.ZodDiscriminatedUnion="ZodDiscriminatedUnion",i.ZodIntersection="ZodIntersection",i.ZodTuple="ZodTuple",i.ZodRecord="ZodRecord",i.ZodMap="ZodMap",i.ZodSet="ZodSet",i.ZodFunction="ZodFunction",i.ZodLazy="ZodLazy",i.ZodLiteral="ZodLiteral",i.ZodEnum="ZodEnum",i.ZodEffects="ZodEffects",i.ZodNativeEnum="ZodNativeEnum",i.ZodOptional="ZodOptional",i.ZodNullable="ZodNullable",i.ZodDefault="ZodDefault",i.ZodCatch="ZodCatch",i.ZodPromise="ZodPromise",i.ZodBranded="ZodBranded",i.ZodPipeline="ZodPipeline",i.ZodReadonly="ZodReadonly"})(W||(W={}));const It=Ke.create,Al=Vt.create;kt.create;const uy=eo.create;on.create;const Il=vr.create;_t.create;const kn=Je.create,cy=pe.create,fy=to.create;no.create;Lt.create;const dy=io.create,hy=Cr.create,py=rn.create;oo.create;ht.create;an.create;const Gt={string:i=>Ke.create({...i,coerce:!0}),number:i=>Vt.create({...i,coerce:!0}),boolean:i=>eo.create({...i,coerce:!0}),bigint:i=>kt.create({...i,coerce:!0}),date:i=>on.create({...i,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let my,gy;function yy(){return{geminiUrl:my,vertexUrl:gy}}function _y(i,e,t){var n,o,r;if(!(!((n=i.httpOptions)===null||n===void 0)&&n.baseUrl)){const l=yy();return i.vertexai?(o=l.vertexUrl)!==null&&o!==void 0?o:e:(r=l.geminiUrl)!==null&&r!==void 0?r:t}return i.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dn{}function z(i,e){const t=/\{([^}]+)\}/g;return i.replace(t,(n,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const r=e[o];return r!=null?String(r):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function a(i,e,t){for(let r=0;r<e.length-1;r++){const l=e[r];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in i))if(Array.isArray(t))i[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(i[c])){const d=i[c];if(Array.isArray(t))for(let f=0;f<d.length;f++){const p=d[f];a(p,e.slice(r+1),t[f])}else for(const f of d)a(f,e.slice(r+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in i||(i[c]=[{}]);const d=i[c];a(d[0],e.slice(r+1),t);return}(!i[l]||typeof i[l]!="object")&&(i[l]={}),i=i[l]}const n=e[e.length-1],o=i[n];if(o!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===o)return;if(typeof o=="object"&&typeof t=="object"&&o!==null&&t!==null)Object.assign(o,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else i[n]=t}function s(i,e){try{if(e.length===1&&e[0]==="_self")return i;for(let t=0;t<e.length;t++){if(typeof i!="object"||i===null)return;const n=e[t];if(n.endsWith("[]")){const o=n.slice(0,-2);if(o in i){const r=i[o];return Array.isArray(r)?r.map(l=>s(l,e.slice(t+1))):void 0}else return}else i=i[n]}return i}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Sl;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Sl||(Sl={}));var wl;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})(wl||(wl={}));var We;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT",i.NULL="NULL"})(We||(We={}));var Rl;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Rl||(Rl={}));var Pl;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(Pl||(Pl={}));var xl;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(xl||(xl={}));var Ml;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(Ml||(Ml={}));var Dl;(function(i){i.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",i.NO_AUTH="NO_AUTH",i.API_KEY_AUTH="API_KEY_AUTH",i.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",i.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",i.OAUTH="OAUTH",i.OIDC_AUTH="OIDC_AUTH"})(Dl||(Dl={}));var Nl;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY",i.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(Nl||(Nl={}));var Vl;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(Vl||(Vl={}));var kl;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(kl||(kl={}));var Ll;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(Ll||(Ll={}));var bl;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(bl||(bl={}));var ro;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})(ro||(ro={}));var Fl;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Fl||(Fl={}));var Sr;(function(i){i.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",i.JOB_STATE_QUEUED="JOB_STATE_QUEUED",i.JOB_STATE_PENDING="JOB_STATE_PENDING",i.JOB_STATE_RUNNING="JOB_STATE_RUNNING",i.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",i.JOB_STATE_FAILED="JOB_STATE_FAILED",i.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",i.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",i.JOB_STATE_PAUSED="JOB_STATE_PAUSED",i.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",i.JOB_STATE_UPDATING="JOB_STATE_UPDATING",i.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Sr||(Sr={}));var Ul;(function(i){i.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",i.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",i.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",i.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",i.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",i.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",i.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Ul||(Ul={}));var Ol;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(Ol||(Ol={}));var Bl;(function(i){i.UNSPECIFIED="UNSPECIFIED",i.BLOCKING="BLOCKING",i.NON_BLOCKING="NON_BLOCKING"})(Bl||(Bl={}));var $l;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})($l||($l={}));var Gl;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE"})(Gl||(Gl={}));var ql;(function(i){i.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",i.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",i.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(ql||(ql={}));var Hl;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(Hl||(Hl={}));var zl;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})(zl||(zl={}));var Kl;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi"})(Kl||(Kl={}));var Wl;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Wl||(Wl={}));var Jl;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Jl||(Jl={}));var Yl;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Yl||(Yl={}));var Zl;(function(i){i.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",i.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",i.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",i.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",i.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",i.EDIT_MODE_STYLE="EDIT_MODE_STYLE",i.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",i.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Zl||(Zl={}));var Ql;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(Ql||(Ql={}));var Xl;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED"})(Xl||(Xl={}));var jl;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(jl||(jl={}));var eu;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(eu||(eu={}));var tu;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(tu||(tu={}));var nu;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})(nu||(nu={}));var iu;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(iu||(iu={}));var ou;(function(i){i.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",i.SILENT="SILENT",i.WHEN_IDLE="WHEN_IDLE",i.INTERRUPT="INTERRUPT"})(ou||(ou={}));var ru;(function(i){i.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",i.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",i.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",i.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",i.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",i.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",i.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",i.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",i.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",i.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",i.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",i.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",i.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(ru||(ru={}));var Kt;(function(i){i.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",i.PLAY="PLAY",i.PAUSE="PAUSE",i.STOP="STOP",i.RESET_CONTEXT="RESET_CONTEXT"})(Kt||(Kt={}));class Dn{get text(){var e,t,n,o,r,l,c,d;if(((o=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",p=!1;const g=[];for(const y of(d=(c=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[A,w]of Object.entries(y))A!=="text"&&A!=="thought"&&(w!==null||w!==void 0)&&g.push(A);if(typeof y.text=="string"){if(typeof y.thought=="boolean"&&y.thought)continue;p=!0,f+=y.text}}return g.length>0&&console.warn(`there are non-text parts ${g} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?f:void 0}get data(){var e,t,n,o,r,l,c,d;if(((o=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const p=[];for(const g of(d=(c=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[y,A]of Object.entries(g))y!=="inlineData"&&(A!==null||A!==void 0)&&p.push(y);g.inlineData&&typeof g.inlineData.data=="string"&&(f+=atob(g.inlineData.data))}return p.length>0&&console.warn(`there are non-data parts ${p} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,t,n,o,r,l,c,d;if(((o=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(d=(c=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if(f?.length!==0)return f}get executableCode(){var e,t,n,o,r,l,c,d,f;if(((o=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(d=(c=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(g=>g.executableCode).map(g=>g.executableCode).filter(g=>g!==void 0);if(p?.length!==0)return(f=p?.[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,t,n,o,r,l,c,d,f;if(((o=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(d=(c=(l=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(g=>g.codeExecutionResult).map(g=>g.codeExecutionResult).filter(g=>g!==void 0);if(p?.length!==0)return(f=p?.[0])===null||f===void 0?void 0:f.output}}class su{}class au{}class vy{}class Ty{}class lu{}class uu{}class cu{}class Cy{}class fu{}class du{}class hu{}class Ey{}class wr{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Ay{}class Iy{}class Sy{get text(){var e,t,n;let o="",r=!1;const l=[];for(const c of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[d,f]of Object.entries(c))d!=="text"&&d!=="thought"&&f!==null&&l.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;r=!0,o+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?o:void 0}get data(){var e,t,n;let o="";const r=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[c,d]of Object.entries(l))c!=="inlineData"&&d!==null&&r.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(o+=atob(l.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class wy{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ae(i,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(i.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function rf(i,e){const t=ae(i,e);return t?t.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:t.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${t}`:t:""}function sf(i,e){return Array.isArray(e)?e.map(t=>so(i,t)):[so(i,e)]}function so(i,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Ry(i,e){const t=so(i,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Py(i,e){const t=so(i,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function pu(i,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function af(i,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>pu(i,t)):[pu(i,e)]}function Rr(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function mu(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function gu(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function ke(i,e){if(e==null)throw new Error("ContentUnion is required");return Rr(e)?e:{role:"user",parts:af(i,e)}}function lf(i,e){if(!e)return[];if(i.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=ke(i,t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const t=ke(i,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>ke(i,t)):[ke(i,e)]}function He(i,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(mu(e)||gu(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ke(i,e)]}const t=[],n=[],o=Rr(e[0]);for(const r of e){const l=Rr(r);if(l!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)t.push(r);else{if(mu(r)||gu(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(r)}}return o||t.push({role:"user",parts:af(i,n)}),t}const xy=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),yu=py(["string","number","integer","object","array","boolean","null"]),My=fy([yu,kn(yu)]);function Dy(i=!0){const e=hy(()=>{const t=cy({type:My.optional(),format:It().optional(),title:It().optional(),description:It().optional(),default:Il().optional(),items:e.optional(),minItems:Gt.string().optional(),maxItems:Gt.string().optional(),enum:kn(Il()).optional(),properties:dy(It(),e).optional(),required:kn(It()).optional(),minProperties:Gt.string().optional(),maxProperties:Gt.string().optional(),propertyOrdering:kn(It()).optional(),minimum:Al().optional(),maximum:Al().optional(),minLength:Gt.string().optional(),maxLength:Gt.string().optional(),pattern:It().optional(),anyOf:kn(e).optional(),additionalProperties:uy().optional()});return i?t.strict():t});return e}function Ny(i,e){i.includes("null")&&(e.nullable=!0);const t=i.filter(n=>n!=="null");if(t.length===1)e.type=Object.values(We).includes(t[0].toUpperCase())?t[0].toUpperCase():We.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.values(We).includes(n.toUpperCase())?n.toUpperCase():We.TYPE_UNSPECIFIED})}}function Yt(i){const e={},t=["items"],n=["anyOf"],o=["properties"];if(i.type&&i.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=i.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,i=r[1]):r[1].type==="null"&&(e.nullable=!0,i=r[0])),i.type instanceof Array&&Ny(i.type,e);for(const[l,c]of Object.entries(i))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(We).includes(c.toUpperCase())?c.toUpperCase():We.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=Yt(c);else if(n.includes(l)){const d=[];for(const f of c){if(f.type=="null"){e.nullable=!0;continue}d.push(Yt(f))}e[l]=d}else if(o.includes(l)){const d={};for(const[f,p]of Object.entries(c))d[f]=Yt(p);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=c}return e}function ao(i,e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=Dy().parse(e);return Yt(t)}else return Yt(e)}function uf(i,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function as(i,e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function ti(i,e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=ao(i,t.parameters)),t.response&&(t.response=ao(i,t.response));return e}function ni(i,e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function Vy(i,e,t,n=1){const o=!e.startsWith(`${t}/`)&&e.split("/").length===n;return i.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${i.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:o?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}/${e}`:e:o?`${t}/${e}`:e}function vt(i,e){if(typeof e!="string")throw new Error("name must be a string");return Vy(i,e,"cachedContents")}function cf(i,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function rt(i,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function ky(i){return i!=null&&typeof i=="object"&&"name"in i}function Ly(i){return i!=null&&typeof i=="object"&&"video"in i}function by(i){return i!=null&&typeof i=="object"&&"uri"in i}function ff(i,e){var t;let n;if(ky(e)&&(n=e.name),!(by(e)&&(n=e.uri,n===void 0))&&!(Ly(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const r=n.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${n}`);n=r[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function df(i,e){let t;return i.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function hf(i,e){for(const t of["models","tunedModels","publisherModels"])if(Fy(e,t))return e[t];return[]}function Fy(i,e){return i!==null&&typeof i=="object"&&e in i}function Uy(i,e={}){const t=i,n={name:t.name,description:t.description,parameters:Yt(yo(t.inputSchema))};return e.behavior&&(n.behavior=e.behavior),{functionDeclarations:[n]}}function Oy(i,e={}){const t=[],n=new Set;for(const o of i){const r=o.name;if(n.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);n.add(r);const l=Uy(o,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function By(i){const e=[];for(const t of i)e.push(yo(t));return e}function $y(i){const e={};for(const[t,n]of Object.entries(i)){const o=n;e[t]=yo(o)}return e}function yo(i){const e=new Set(["items"]),t=new Set(["anyOf"]),n=new Set(["properties"]),o={};for(const[r,l]of Object.entries(i))if(e.has(r))o[r]=yo(l);else if(t.has(r))o[r]=By(l);else if(n.has(r))o[r]=$y(l);else if(r==="type"){const c=l.toUpperCase();o[r]=Object.values(We).includes(c)?c:We.TYPE_UNSPECIFIED}else xy.has(r)&&(o[r]=l);return o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gy(i,e){const t={},n=s(e,["fps"]);n!=null&&a(t,["fps"],n);const o=s(e,["endOffset"]);o!=null&&a(t,["endOffset"],o);const r=s(e,["startOffset"]);return r!=null&&a(t,["startOffset"],r),t}function qy(i,e){const t={};if(s(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(e,["data"]);n!=null&&a(t,["data"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function Hy(i,e){const t={};if(s(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(e,["fileUri"]);n!=null&&a(t,["fileUri"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function zy(i,e){const t={},n=s(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],Gy(i,n));const o=s(e,["thought"]);o!=null&&a(t,["thought"],o);const r=s(e,["inlineData"]);r!=null&&a(t,["inlineData"],qy(i,r));const l=s(e,["fileData"]);l!=null&&a(t,["fileData"],Hy(i,l));const c=s(e,["thoughtSignature"]);c!=null&&a(t,["thoughtSignature"],c);const d=s(e,["codeExecutionResult"]);d!=null&&a(t,["codeExecutionResult"],d);const f=s(e,["executableCode"]);f!=null&&a(t,["executableCode"],f);const p=s(e,["functionCall"]);p!=null&&a(t,["functionCall"],p);const g=s(e,["functionResponse"]);g!=null&&a(t,["functionResponse"],g);const y=s(e,["text"]);return y!=null&&a(t,["text"],y),t}function _u(i,e){const t={},n=s(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>zy(i,l))),a(t,["parts"],r)}const o=s(e,["role"]);return o!=null&&a(t,["role"],o),t}function Ky(i,e){const t={},n=s(e,["behavior"]);n!=null&&a(t,["behavior"],n);const o=s(e,["description"]);o!=null&&a(t,["description"],o);const r=s(e,["name"]);r!=null&&a(t,["name"],r);const l=s(e,["parameters"]);l!=null&&a(t,["parameters"],l);const c=s(e,["response"]);return c!=null&&a(t,["response"],c),t}function Wy(i,e){const t={},n=s(e,["startTime"]);n!=null&&a(t,["startTime"],n);const o=s(e,["endTime"]);return o!=null&&a(t,["endTime"],o),t}function Jy(i,e){const t={},n=s(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],Wy(i,n)),t}function Yy(i,e){const t={},n=s(e,["mode"]);n!=null&&a(t,["mode"],n);const o=s(e,["dynamicThreshold"]);return o!=null&&a(t,["dynamicThreshold"],o),t}function Zy(i,e){const t={},n=s(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],Yy(i,n)),t}function Qy(){return{}}function Xy(i,e){const t={},n=s(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>Ky(i,f))),a(t,["functionDeclarations"],d)}if(s(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=s(e,["googleSearch"]);o!=null&&a(t,["googleSearch"],Jy(i,o));const r=s(e,["googleSearchRetrieval"]);if(r!=null&&a(t,["googleSearchRetrieval"],Zy(i,r)),s(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(e,["urlContext"])!=null&&a(t,["urlContext"],Qy());const c=s(e,["codeExecution"]);return c!=null&&a(t,["codeExecution"],c),t}function jy(i,e){const t={},n=s(e,["mode"]);n!=null&&a(t,["mode"],n);const o=s(e,["allowedFunctionNames"]);return o!=null&&a(t,["allowedFunctionNames"],o),t}function e_(i,e){const t={},n=s(e,["latitude"]);n!=null&&a(t,["latitude"],n);const o=s(e,["longitude"]);return o!=null&&a(t,["longitude"],o),t}function t_(i,e){const t={},n=s(e,["latLng"]);n!=null&&a(t,["latLng"],e_(i,n));const o=s(e,["languageCode"]);return o!=null&&a(t,["languageCode"],o),t}function n_(i,e){const t={},n=s(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],jy(i,n));const o=s(e,["retrievalConfig"]);return o!=null&&a(t,["retrievalConfig"],t_(i,o)),t}function i_(i,e,t){const n={},o=s(e,["ttl"]);t!==void 0&&o!=null&&a(t,["ttl"],o);const r=s(e,["expireTime"]);t!==void 0&&r!=null&&a(t,["expireTime"],r);const l=s(e,["displayName"]);t!==void 0&&l!=null&&a(t,["displayName"],l);const c=s(e,["contents"]);if(t!==void 0&&c!=null){let g=He(i,c);Array.isArray(g)&&(g=g.map(y=>_u(i,y))),a(t,["contents"],g)}const d=s(e,["systemInstruction"]);t!==void 0&&d!=null&&a(t,["systemInstruction"],_u(i,ke(i,d)));const f=s(e,["tools"]);if(t!==void 0&&f!=null){let g=f;Array.isArray(g)&&(g=g.map(y=>Xy(i,y))),a(t,["tools"],g)}const p=s(e,["toolConfig"]);if(t!==void 0&&p!=null&&a(t,["toolConfig"],n_(i,p)),s(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function o_(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["model"],rf(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],i_(i,o,t)),t}function r_(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["_url","name"],vt(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function s_(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["_url","name"],vt(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function a_(i,e,t){const n={},o=s(e,["ttl"]);t!==void 0&&o!=null&&a(t,["ttl"],o);const r=s(e,["expireTime"]);return t!==void 0&&r!=null&&a(t,["expireTime"],r),n}function l_(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["_url","name"],vt(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],a_(i,o,t)),t}function u_(i,e,t){const n={},o=s(e,["pageSize"]);t!==void 0&&o!=null&&a(t,["_query","pageSize"],o);const r=s(e,["pageToken"]);return t!==void 0&&r!=null&&a(t,["_query","pageToken"],r),n}function c_(i,e){const t={},n=s(e,["config"]);return n!=null&&a(t,["config"],u_(i,n,t)),t}function f_(i,e){const t={},n=s(e,["fps"]);n!=null&&a(t,["fps"],n);const o=s(e,["endOffset"]);o!=null&&a(t,["endOffset"],o);const r=s(e,["startOffset"]);return r!=null&&a(t,["startOffset"],r),t}function d_(i,e){const t={},n=s(e,["displayName"]);n!=null&&a(t,["displayName"],n);const o=s(e,["data"]);o!=null&&a(t,["data"],o);const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function h_(i,e){const t={},n=s(e,["displayName"]);n!=null&&a(t,["displayName"],n);const o=s(e,["fileUri"]);o!=null&&a(t,["fileUri"],o);const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function p_(i,e){const t={},n=s(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],f_(i,n));const o=s(e,["thought"]);o!=null&&a(t,["thought"],o);const r=s(e,["inlineData"]);r!=null&&a(t,["inlineData"],d_(i,r));const l=s(e,["fileData"]);l!=null&&a(t,["fileData"],h_(i,l));const c=s(e,["thoughtSignature"]);c!=null&&a(t,["thoughtSignature"],c);const d=s(e,["codeExecutionResult"]);d!=null&&a(t,["codeExecutionResult"],d);const f=s(e,["executableCode"]);f!=null&&a(t,["executableCode"],f);const p=s(e,["functionCall"]);p!=null&&a(t,["functionCall"],p);const g=s(e,["functionResponse"]);g!=null&&a(t,["functionResponse"],g);const y=s(e,["text"]);return y!=null&&a(t,["text"],y),t}function vu(i,e){const t={},n=s(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>p_(i,l))),a(t,["parts"],r)}const o=s(e,["role"]);return o!=null&&a(t,["role"],o),t}function m_(i,e){const t={};if(s(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(e,["description"]);n!=null&&a(t,["description"],n);const o=s(e,["name"]);o!=null&&a(t,["name"],o);const r=s(e,["parameters"]);r!=null&&a(t,["parameters"],r);const l=s(e,["response"]);return l!=null&&a(t,["response"],l),t}function g_(i,e){const t={},n=s(e,["startTime"]);n!=null&&a(t,["startTime"],n);const o=s(e,["endTime"]);return o!=null&&a(t,["endTime"],o),t}function y_(i,e){const t={},n=s(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],g_(i,n)),t}function __(i,e){const t={},n=s(e,["mode"]);n!=null&&a(t,["mode"],n);const o=s(e,["dynamicThreshold"]);return o!=null&&a(t,["dynamicThreshold"],o),t}function v_(i,e){const t={},n=s(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],__(i,n)),t}function T_(){return{}}function C_(i,e){const t={},n=s(e,["apiKeyString"]);return n!=null&&a(t,["apiKeyString"],n),t}function E_(i,e){const t={},n=s(e,["apiKeyConfig"]);n!=null&&a(t,["apiKeyConfig"],C_(i,n));const o=s(e,["authType"]);o!=null&&a(t,["authType"],o);const r=s(e,["googleServiceAccountConfig"]);r!=null&&a(t,["googleServiceAccountConfig"],r);const l=s(e,["httpBasicAuthConfig"]);l!=null&&a(t,["httpBasicAuthConfig"],l);const c=s(e,["oauthConfig"]);c!=null&&a(t,["oauthConfig"],c);const d=s(e,["oidcConfig"]);return d!=null&&a(t,["oidcConfig"],d),t}function A_(i,e){const t={},n=s(e,["authConfig"]);return n!=null&&a(t,["authConfig"],E_(i,n)),t}function I_(){return{}}function S_(i,e){const t={},n=s(e,["functionDeclarations"]);if(n!=null){let g=n;Array.isArray(g)&&(g=g.map(y=>m_(i,y))),a(t,["functionDeclarations"],g)}const o=s(e,["retrieval"]);o!=null&&a(t,["retrieval"],o);const r=s(e,["googleSearch"]);r!=null&&a(t,["googleSearch"],y_(i,r));const l=s(e,["googleSearchRetrieval"]);l!=null&&a(t,["googleSearchRetrieval"],v_(i,l)),s(e,["enterpriseWebSearch"])!=null&&a(t,["enterpriseWebSearch"],T_());const d=s(e,["googleMaps"]);d!=null&&a(t,["googleMaps"],A_(i,d)),s(e,["urlContext"])!=null&&a(t,["urlContext"],I_());const p=s(e,["codeExecution"]);return p!=null&&a(t,["codeExecution"],p),t}function w_(i,e){const t={},n=s(e,["mode"]);n!=null&&a(t,["mode"],n);const o=s(e,["allowedFunctionNames"]);return o!=null&&a(t,["allowedFunctionNames"],o),t}function R_(i,e){const t={},n=s(e,["latitude"]);n!=null&&a(t,["latitude"],n);const o=s(e,["longitude"]);return o!=null&&a(t,["longitude"],o),t}function P_(i,e){const t={},n=s(e,["latLng"]);n!=null&&a(t,["latLng"],R_(i,n));const o=s(e,["languageCode"]);return o!=null&&a(t,["languageCode"],o),t}function x_(i,e){const t={},n=s(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],w_(i,n));const o=s(e,["retrievalConfig"]);return o!=null&&a(t,["retrievalConfig"],P_(i,o)),t}function M_(i,e,t){const n={},o=s(e,["ttl"]);t!==void 0&&o!=null&&a(t,["ttl"],o);const r=s(e,["expireTime"]);t!==void 0&&r!=null&&a(t,["expireTime"],r);const l=s(e,["displayName"]);t!==void 0&&l!=null&&a(t,["displayName"],l);const c=s(e,["contents"]);if(t!==void 0&&c!=null){let y=He(i,c);Array.isArray(y)&&(y=y.map(A=>vu(i,A))),a(t,["contents"],y)}const d=s(e,["systemInstruction"]);t!==void 0&&d!=null&&a(t,["systemInstruction"],vu(i,ke(i,d)));const f=s(e,["tools"]);if(t!==void 0&&f!=null){let y=f;Array.isArray(y)&&(y=y.map(A=>S_(i,A))),a(t,["tools"],y)}const p=s(e,["toolConfig"]);t!==void 0&&p!=null&&a(t,["toolConfig"],x_(i,p));const g=s(e,["kmsKeyName"]);return t!==void 0&&g!=null&&a(t,["encryption_spec","kmsKeyName"],g),n}function D_(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["model"],rf(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],M_(i,o,t)),t}function N_(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["_url","name"],vt(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function V_(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["_url","name"],vt(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function k_(i,e,t){const n={},o=s(e,["ttl"]);t!==void 0&&o!=null&&a(t,["ttl"],o);const r=s(e,["expireTime"]);return t!==void 0&&r!=null&&a(t,["expireTime"],r),n}function L_(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["_url","name"],vt(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],k_(i,o,t)),t}function b_(i,e,t){const n={},o=s(e,["pageSize"]);t!==void 0&&o!=null&&a(t,["_query","pageSize"],o);const r=s(e,["pageToken"]);return t!==void 0&&r!=null&&a(t,["_query","pageToken"],r),n}function F_(i,e){const t={},n=s(e,["config"]);return n!=null&&a(t,["config"],b_(i,n,t)),t}function Vi(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["displayName"]);o!=null&&a(t,["displayName"],o);const r=s(e,["model"]);r!=null&&a(t,["model"],r);const l=s(e,["createTime"]);l!=null&&a(t,["createTime"],l);const c=s(e,["updateTime"]);c!=null&&a(t,["updateTime"],c);const d=s(e,["expireTime"]);d!=null&&a(t,["expireTime"],d);const f=s(e,["usageMetadata"]);return f!=null&&a(t,["usageMetadata"],f),t}function U_(){return{}}function O_(i,e){const t={},n=s(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const o=s(e,["cachedContents"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(l=>Vi(i,l))),a(t,["cachedContents"],r)}return t}function ki(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["displayName"]);o!=null&&a(t,["displayName"],o);const r=s(e,["model"]);r!=null&&a(t,["model"],r);const l=s(e,["createTime"]);l!=null&&a(t,["createTime"],l);const c=s(e,["updateTime"]);c!=null&&a(t,["updateTime"],c);const d=s(e,["expireTime"]);d!=null&&a(t,["expireTime"],d);const f=s(e,["usageMetadata"]);return f!=null&&a(t,["usageMetadata"],f),t}function B_(){return{}}function $_(i,e){const t={},n=s(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const o=s(e,["cachedContents"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(l=>ki(i,l))),a(t,["cachedContents"],r)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ln;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(ln||(ln={}));class _o{constructor(e,t,n,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,o)}init(e,t,n){var o,r;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};n?typeof n=="object"?l=Object.assign({},n):l=n:l={config:{}},l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(r=(o=l.config)===null||o===void 0?void 0:o.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class G_ extends dn{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new _o(ln.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=D_(this.apiClient,e);return c=z("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>ki(this.apiClient,p))}else{const f=o_(this.apiClient,e);return c=z("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>Vi(this.apiClient,p))}}async get(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=N_(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>ki(this.apiClient,p))}else{const f=r_(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>Vi(this.apiClient,p))}}async delete(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=V_(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(()=>{const p=B_(),g=new du;return Object.assign(g,p),g})}else{const f=s_(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(()=>{const p=U_(),g=new du;return Object.assign(g,p),g})}}async update(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=L_(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>ki(this.apiClient,p))}else{const f=l_(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>Vi(this.apiClient,p))}}async listInternal(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=F_(this.apiClient,e);return c=z("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>{const g=$_(this.apiClient,p),y=new hu;return Object.assign(y,g),y})}else{const f=c_(this.apiClient,e);return c=z("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=O_(this.apiClient,p),y=new hu;return Object.assign(y,g),y})}}}function Tu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ue(i){return this instanceof ue?(this.v=i,this):new ue(i)}function Zt(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),o,r=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),o[Symbol.asyncIterator]=function(){return this},o;function l(A){return function(w){return Promise.resolve(w).then(A,g)}}function c(A,w){n[A]&&(o[A]=function(M){return new Promise(function(D,F){r.push([A,M,D,F])>1||d(A,M)})},w&&(o[A]=w(o[A])))}function d(A,w){try{f(n[A](w))}catch(M){y(r[0][3],M)}}function f(A){A.value instanceof ue?Promise.resolve(A.value.v).then(p,g):y(r[0][2],A)}function p(A){d("next",A)}function g(A){d("throw",A)}function y(A,w){A(w),r.shift(),r.length&&d(r[0][0],r[0][1])}}function Bn(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Tu=="function"?Tu(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=i[r]&&function(l){return new Promise(function(c,d){l=i[r](l),o(c,d,l.done,l.value)})}}function o(r,l,c,d){Promise.resolve(d).then(function(f){r({value:f,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function q_(i){var e;if(i.candidates==null||i.candidates.length===0)return!1;const t=(e=i.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:pf(t)}function pf(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const e of i.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function H_(i){if(i.length!==0){for(const e of i)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Cu(i){if(i===void 0||i.length===0)return[];const e=[],t=i.length;let n=0;for(;n<t;)if(i[n].role==="user")e.push(i[n]),n++;else{const o=[];let r=!0;for(;n<t&&i[n].role==="model";)o.push(i[n]),r&&!pf(i[n])&&(r=!1),n++;r?e.push(...o):e.pop()}return e}class z_{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new K_(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class K_{constructor(e,t,n,o={},r=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=o,this.history=r,this.sendPromise=Promise.resolve(),H_(r)}async sendMessage(e){var t;await this.sendPromise;const n=ke(this.apiClient,e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var r,l,c;const d=await o,f=(l=(r=d.candidates)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.content,p=d.automaticFunctionCallingHistory,g=this.getHistory(!0).length;let y=[];p!=null&&(y=(c=p.slice(g))!==null&&c!==void 0?c:[]);const A=f?[f]:[];this.recordHistory(n,A,y)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var t;await this.sendPromise;const n=ke(this.apiClient,e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const r=await o;return this.processStreamResponse(r,n)}getHistory(e=!1){const t=e?Cu(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var n,o;return Zt(this,arguments,function*(){var l,c,d,f;const p=[];try{for(var g=!0,y=Bn(e),A;A=yield ue(y.next()),l=A.done,!l;g=!0){f=A.value,g=!1;const w=f;if(q_(w)){const M=(o=(n=w.candidates)===null||n===void 0?void 0:n[0])===null||o===void 0?void 0:o.content;M!==void 0&&p.push(M)}yield yield ue(w)}}catch(w){c={error:w}}finally{try{!g&&!l&&(d=y.return)&&(yield ue(d.call(y)))}finally{if(c)throw c.error}}this.recordHistory(t,p)})}recordHistory(e,t,n){let o=[];t.length>0&&t.every(r=>r.role!==void 0)?o=t:o.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...Cu(n)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function W_(i,e,t){const n={},o=s(e,["pageSize"]);t!==void 0&&o!=null&&a(t,["_query","pageSize"],o);const r=s(e,["pageToken"]);return t!==void 0&&r!=null&&a(t,["_query","pageToken"],r),n}function J_(i,e){const t={},n=s(e,["config"]);return n!=null&&a(t,["config"],W_(i,n,t)),t}function Y_(i,e){const t={},n=s(e,["details"]);n!=null&&a(t,["details"],n);const o=s(e,["message"]);o!=null&&a(t,["message"],o);const r=s(e,["code"]);return r!=null&&a(t,["code"],r),t}function Z_(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["displayName"]);o!=null&&a(t,["displayName"],o);const r=s(e,["mimeType"]);r!=null&&a(t,["mimeType"],r);const l=s(e,["sizeBytes"]);l!=null&&a(t,["sizeBytes"],l);const c=s(e,["createTime"]);c!=null&&a(t,["createTime"],c);const d=s(e,["expirationTime"]);d!=null&&a(t,["expirationTime"],d);const f=s(e,["updateTime"]);f!=null&&a(t,["updateTime"],f);const p=s(e,["sha256Hash"]);p!=null&&a(t,["sha256Hash"],p);const g=s(e,["uri"]);g!=null&&a(t,["uri"],g);const y=s(e,["downloadUri"]);y!=null&&a(t,["downloadUri"],y);const A=s(e,["state"]);A!=null&&a(t,["state"],A);const w=s(e,["source"]);w!=null&&a(t,["source"],w);const M=s(e,["videoMetadata"]);M!=null&&a(t,["videoMetadata"],M);const D=s(e,["error"]);return D!=null&&a(t,["error"],Y_(i,D)),t}function Q_(i,e){const t={},n=s(e,["file"]);n!=null&&a(t,["file"],Z_(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function X_(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["_url","file"],ff(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function j_(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["_url","file"],ff(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function ev(i,e){const t={},n=s(e,["details"]);n!=null&&a(t,["details"],n);const o=s(e,["message"]);o!=null&&a(t,["message"],o);const r=s(e,["code"]);return r!=null&&a(t,["code"],r),t}function Pr(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["displayName"]);o!=null&&a(t,["displayName"],o);const r=s(e,["mimeType"]);r!=null&&a(t,["mimeType"],r);const l=s(e,["sizeBytes"]);l!=null&&a(t,["sizeBytes"],l);const c=s(e,["createTime"]);c!=null&&a(t,["createTime"],c);const d=s(e,["expirationTime"]);d!=null&&a(t,["expirationTime"],d);const f=s(e,["updateTime"]);f!=null&&a(t,["updateTime"],f);const p=s(e,["sha256Hash"]);p!=null&&a(t,["sha256Hash"],p);const g=s(e,["uri"]);g!=null&&a(t,["uri"],g);const y=s(e,["downloadUri"]);y!=null&&a(t,["downloadUri"],y);const A=s(e,["state"]);A!=null&&a(t,["state"],A);const w=s(e,["source"]);w!=null&&a(t,["source"],w);const M=s(e,["videoMetadata"]);M!=null&&a(t,["videoMetadata"],M);const D=s(e,["error"]);return D!=null&&a(t,["error"],ev(i,D)),t}function tv(i,e){const t={},n=s(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const o=s(e,["files"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(l=>Pr(i,l))),a(t,["files"],r)}return t}function nv(){return{}}function iv(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ov extends dn{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new _o(ln.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>Pr(this.apiClient,t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=J_(this.apiClient,e);return r=z("files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>{const f=tv(this.apiClient,d),p=new Ey;return Object.assign(p,f),p})}}async createInternal(e){var t,n;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Q_(this.apiClient,e);return r=z("upload/v1beta/files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(()=>{const d=nv(),f=new Ay;return Object.assign(f,d),f})}}async get(e){var t,n;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=X_(this.apiClient,e);return r=z("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>Pr(this.apiClient,d))}}async delete(e){var t,n;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=j_(this.apiClient,e);return r=z("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(()=>{const d=iv(),f=new Iy;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rv(i,e){const t={},n=s(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function sv(i,e){const t={},n=s(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function mf(i,e){const t={},n=s(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],rv(i,n)),t}function av(i,e){const t={},n=s(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],sv(i,n)),t}function lv(i,e){const t={},n=s(e,["speaker"]);n!=null&&a(t,["speaker"],n);const o=s(e,["voiceConfig"]);return o!=null&&a(t,["voiceConfig"],mf(i,o)),t}function uv(i,e){const t={},n=s(e,["speakerVoiceConfigs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>lv(i,r))),a(t,["speakerVoiceConfigs"],o)}return t}function cv(i,e){const t={},n=s(e,["voiceConfig"]);n!=null&&a(t,["voiceConfig"],mf(i,n));const o=s(e,["multiSpeakerVoiceConfig"]);o!=null&&a(t,["multiSpeakerVoiceConfig"],uv(i,o));const r=s(e,["languageCode"]);return r!=null&&a(t,["languageCode"],r),t}function fv(i,e){const t={},n=s(e,["voiceConfig"]);if(n!=null&&a(t,["voiceConfig"],av(i,n)),s(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=s(e,["languageCode"]);return o!=null&&a(t,["languageCode"],o),t}function dv(i,e){const t={},n=s(e,["fps"]);n!=null&&a(t,["fps"],n);const o=s(e,["endOffset"]);o!=null&&a(t,["endOffset"],o);const r=s(e,["startOffset"]);return r!=null&&a(t,["startOffset"],r),t}function hv(i,e){const t={},n=s(e,["fps"]);n!=null&&a(t,["fps"],n);const o=s(e,["endOffset"]);o!=null&&a(t,["endOffset"],o);const r=s(e,["startOffset"]);return r!=null&&a(t,["startOffset"],r),t}function pv(i,e){const t={};if(s(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(e,["data"]);n!=null&&a(t,["data"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function mv(i,e){const t={},n=s(e,["displayName"]);n!=null&&a(t,["displayName"],n);const o=s(e,["data"]);o!=null&&a(t,["data"],o);const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function gv(i,e){const t={};if(s(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(e,["fileUri"]);n!=null&&a(t,["fileUri"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function yv(i,e){const t={},n=s(e,["displayName"]);n!=null&&a(t,["displayName"],n);const o=s(e,["fileUri"]);o!=null&&a(t,["fileUri"],o);const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function _v(i,e){const t={},n=s(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],dv(i,n));const o=s(e,["thought"]);o!=null&&a(t,["thought"],o);const r=s(e,["inlineData"]);r!=null&&a(t,["inlineData"],pv(i,r));const l=s(e,["fileData"]);l!=null&&a(t,["fileData"],gv(i,l));const c=s(e,["thoughtSignature"]);c!=null&&a(t,["thoughtSignature"],c);const d=s(e,["codeExecutionResult"]);d!=null&&a(t,["codeExecutionResult"],d);const f=s(e,["executableCode"]);f!=null&&a(t,["executableCode"],f);const p=s(e,["functionCall"]);p!=null&&a(t,["functionCall"],p);const g=s(e,["functionResponse"]);g!=null&&a(t,["functionResponse"],g);const y=s(e,["text"]);return y!=null&&a(t,["text"],y),t}function vv(i,e){const t={},n=s(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],hv(i,n));const o=s(e,["thought"]);o!=null&&a(t,["thought"],o);const r=s(e,["inlineData"]);r!=null&&a(t,["inlineData"],mv(i,r));const l=s(e,["fileData"]);l!=null&&a(t,["fileData"],yv(i,l));const c=s(e,["thoughtSignature"]);c!=null&&a(t,["thoughtSignature"],c);const d=s(e,["codeExecutionResult"]);d!=null&&a(t,["codeExecutionResult"],d);const f=s(e,["executableCode"]);f!=null&&a(t,["executableCode"],f);const p=s(e,["functionCall"]);p!=null&&a(t,["functionCall"],p);const g=s(e,["functionResponse"]);g!=null&&a(t,["functionResponse"],g);const y=s(e,["text"]);return y!=null&&a(t,["text"],y),t}function Tv(i,e){const t={},n=s(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>_v(i,l))),a(t,["parts"],r)}const o=s(e,["role"]);return o!=null&&a(t,["role"],o),t}function Cv(i,e){const t={},n=s(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>vv(i,l))),a(t,["parts"],r)}const o=s(e,["role"]);return o!=null&&a(t,["role"],o),t}function Ev(i,e){const t={},n=s(e,["behavior"]);n!=null&&a(t,["behavior"],n);const o=s(e,["description"]);o!=null&&a(t,["description"],o);const r=s(e,["name"]);r!=null&&a(t,["name"],r);const l=s(e,["parameters"]);l!=null&&a(t,["parameters"],l);const c=s(e,["response"]);return c!=null&&a(t,["response"],c),t}function Av(i,e){const t={};if(s(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(e,["description"]);n!=null&&a(t,["description"],n);const o=s(e,["name"]);o!=null&&a(t,["name"],o);const r=s(e,["parameters"]);r!=null&&a(t,["parameters"],r);const l=s(e,["response"]);return l!=null&&a(t,["response"],l),t}function Iv(i,e){const t={},n=s(e,["startTime"]);n!=null&&a(t,["startTime"],n);const o=s(e,["endTime"]);return o!=null&&a(t,["endTime"],o),t}function Sv(i,e){const t={},n=s(e,["startTime"]);n!=null&&a(t,["startTime"],n);const o=s(e,["endTime"]);return o!=null&&a(t,["endTime"],o),t}function wv(i,e){const t={},n=s(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],Iv(i,n)),t}function Rv(i,e){const t={},n=s(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],Sv(i,n)),t}function Pv(i,e){const t={},n=s(e,["mode"]);n!=null&&a(t,["mode"],n);const o=s(e,["dynamicThreshold"]);return o!=null&&a(t,["dynamicThreshold"],o),t}function xv(i,e){const t={},n=s(e,["mode"]);n!=null&&a(t,["mode"],n);const o=s(e,["dynamicThreshold"]);return o!=null&&a(t,["dynamicThreshold"],o),t}function Mv(i,e){const t={},n=s(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],Pv(i,n)),t}function Dv(i,e){const t={},n=s(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],xv(i,n)),t}function Nv(){return{}}function Vv(i,e){const t={},n=s(e,["apiKeyString"]);return n!=null&&a(t,["apiKeyString"],n),t}function kv(i,e){const t={},n=s(e,["apiKeyConfig"]);n!=null&&a(t,["apiKeyConfig"],Vv(i,n));const o=s(e,["authType"]);o!=null&&a(t,["authType"],o);const r=s(e,["googleServiceAccountConfig"]);r!=null&&a(t,["googleServiceAccountConfig"],r);const l=s(e,["httpBasicAuthConfig"]);l!=null&&a(t,["httpBasicAuthConfig"],l);const c=s(e,["oauthConfig"]);c!=null&&a(t,["oauthConfig"],c);const d=s(e,["oidcConfig"]);return d!=null&&a(t,["oidcConfig"],d),t}function Lv(i,e){const t={},n=s(e,["authConfig"]);return n!=null&&a(t,["authConfig"],kv(i,n)),t}function bv(){return{}}function Fv(){return{}}function Uv(i,e){const t={},n=s(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>Ev(i,f))),a(t,["functionDeclarations"],d)}if(s(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=s(e,["googleSearch"]);o!=null&&a(t,["googleSearch"],wv(i,o));const r=s(e,["googleSearchRetrieval"]);if(r!=null&&a(t,["googleSearchRetrieval"],Mv(i,r)),s(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(e,["urlContext"])!=null&&a(t,["urlContext"],bv());const c=s(e,["codeExecution"]);return c!=null&&a(t,["codeExecution"],c),t}function Ov(i,e){const t={},n=s(e,["functionDeclarations"]);if(n!=null){let g=n;Array.isArray(g)&&(g=g.map(y=>Av(i,y))),a(t,["functionDeclarations"],g)}const o=s(e,["retrieval"]);o!=null&&a(t,["retrieval"],o);const r=s(e,["googleSearch"]);r!=null&&a(t,["googleSearch"],Rv(i,r));const l=s(e,["googleSearchRetrieval"]);l!=null&&a(t,["googleSearchRetrieval"],Dv(i,l)),s(e,["enterpriseWebSearch"])!=null&&a(t,["enterpriseWebSearch"],Nv());const d=s(e,["googleMaps"]);d!=null&&a(t,["googleMaps"],Lv(i,d)),s(e,["urlContext"])!=null&&a(t,["urlContext"],Fv());const p=s(e,["codeExecution"]);return p!=null&&a(t,["codeExecution"],p),t}function Bv(i,e){const t={},n=s(e,["handle"]);if(n!=null&&a(t,["handle"],n),s(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function $v(i,e){const t={},n=s(e,["handle"]);n!=null&&a(t,["handle"],n);const o=s(e,["transparent"]);return o!=null&&a(t,["transparent"],o),t}function Eu(){return{}}function Au(){return{}}function Gv(i,e){const t={},n=s(e,["disabled"]);n!=null&&a(t,["disabled"],n);const o=s(e,["startOfSpeechSensitivity"]);o!=null&&a(t,["startOfSpeechSensitivity"],o);const r=s(e,["endOfSpeechSensitivity"]);r!=null&&a(t,["endOfSpeechSensitivity"],r);const l=s(e,["prefixPaddingMs"]);l!=null&&a(t,["prefixPaddingMs"],l);const c=s(e,["silenceDurationMs"]);return c!=null&&a(t,["silenceDurationMs"],c),t}function qv(i,e){const t={},n=s(e,["disabled"]);n!=null&&a(t,["disabled"],n);const o=s(e,["startOfSpeechSensitivity"]);o!=null&&a(t,["startOfSpeechSensitivity"],o);const r=s(e,["endOfSpeechSensitivity"]);r!=null&&a(t,["endOfSpeechSensitivity"],r);const l=s(e,["prefixPaddingMs"]);l!=null&&a(t,["prefixPaddingMs"],l);const c=s(e,["silenceDurationMs"]);return c!=null&&a(t,["silenceDurationMs"],c),t}function Hv(i,e){const t={},n=s(e,["automaticActivityDetection"]);n!=null&&a(t,["automaticActivityDetection"],Gv(i,n));const o=s(e,["activityHandling"]);o!=null&&a(t,["activityHandling"],o);const r=s(e,["turnCoverage"]);return r!=null&&a(t,["turnCoverage"],r),t}function zv(i,e){const t={},n=s(e,["automaticActivityDetection"]);n!=null&&a(t,["automaticActivityDetection"],qv(i,n));const o=s(e,["activityHandling"]);o!=null&&a(t,["activityHandling"],o);const r=s(e,["turnCoverage"]);return r!=null&&a(t,["turnCoverage"],r),t}function Kv(i,e){const t={},n=s(e,["targetTokens"]);return n!=null&&a(t,["targetTokens"],n),t}function Wv(i,e){const t={},n=s(e,["targetTokens"]);return n!=null&&a(t,["targetTokens"],n),t}function Jv(i,e){const t={},n=s(e,["triggerTokens"]);n!=null&&a(t,["triggerTokens"],n);const o=s(e,["slidingWindow"]);return o!=null&&a(t,["slidingWindow"],Kv(i,o)),t}function Yv(i,e){const t={},n=s(e,["triggerTokens"]);n!=null&&a(t,["triggerTokens"],n);const o=s(e,["slidingWindow"]);return o!=null&&a(t,["slidingWindow"],Wv(i,o)),t}function Zv(i,e){const t={},n=s(e,["proactiveAudio"]);return n!=null&&a(t,["proactiveAudio"],n),t}function Qv(i,e){const t={},n=s(e,["proactiveAudio"]);return n!=null&&a(t,["proactiveAudio"],n),t}function Xv(i,e,t){const n={},o=s(e,["generationConfig"]);t!==void 0&&o!=null&&a(t,["setup","generationConfig"],o);const r=s(e,["responseModalities"]);t!==void 0&&r!=null&&a(t,["setup","generationConfig","responseModalities"],r);const l=s(e,["temperature"]);t!==void 0&&l!=null&&a(t,["setup","generationConfig","temperature"],l);const c=s(e,["topP"]);t!==void 0&&c!=null&&a(t,["setup","generationConfig","topP"],c);const d=s(e,["topK"]);t!==void 0&&d!=null&&a(t,["setup","generationConfig","topK"],d);const f=s(e,["maxOutputTokens"]);t!==void 0&&f!=null&&a(t,["setup","generationConfig","maxOutputTokens"],f);const p=s(e,["mediaResolution"]);t!==void 0&&p!=null&&a(t,["setup","generationConfig","mediaResolution"],p);const g=s(e,["seed"]);t!==void 0&&g!=null&&a(t,["setup","generationConfig","seed"],g);const y=s(e,["speechConfig"]);t!==void 0&&y!=null&&a(t,["setup","generationConfig","speechConfig"],cv(i,as(i,y)));const A=s(e,["enableAffectiveDialog"]);t!==void 0&&A!=null&&a(t,["setup","generationConfig","enableAffectiveDialog"],A);const w=s(e,["systemInstruction"]);t!==void 0&&w!=null&&a(t,["setup","systemInstruction"],Tv(i,ke(i,w)));const M=s(e,["tools"]);if(t!==void 0&&M!=null){let H=ni(i,M);Array.isArray(H)&&(H=H.map(I=>Uv(i,ti(i,I)))),a(t,["setup","tools"],H)}const D=s(e,["sessionResumption"]);t!==void 0&&D!=null&&a(t,["setup","sessionResumption"],Bv(i,D));const F=s(e,["inputAudioTranscription"]);t!==void 0&&F!=null&&a(t,["setup","inputAudioTranscription"],Eu());const b=s(e,["outputAudioTranscription"]);t!==void 0&&b!=null&&a(t,["setup","outputAudioTranscription"],Eu());const O=s(e,["realtimeInputConfig"]);t!==void 0&&O!=null&&a(t,["setup","realtimeInputConfig"],Hv(i,O));const q=s(e,["contextWindowCompression"]);t!==void 0&&q!=null&&a(t,["setup","contextWindowCompression"],Jv(i,q));const Y=s(e,["proactivity"]);return t!==void 0&&Y!=null&&a(t,["setup","proactivity"],Zv(i,Y)),n}function jv(i,e,t){const n={},o=s(e,["generationConfig"]);t!==void 0&&o!=null&&a(t,["setup","generationConfig"],o);const r=s(e,["responseModalities"]);t!==void 0&&r!=null&&a(t,["setup","generationConfig","responseModalities"],r);const l=s(e,["temperature"]);t!==void 0&&l!=null&&a(t,["setup","generationConfig","temperature"],l);const c=s(e,["topP"]);t!==void 0&&c!=null&&a(t,["setup","generationConfig","topP"],c);const d=s(e,["topK"]);t!==void 0&&d!=null&&a(t,["setup","generationConfig","topK"],d);const f=s(e,["maxOutputTokens"]);t!==void 0&&f!=null&&a(t,["setup","generationConfig","maxOutputTokens"],f);const p=s(e,["mediaResolution"]);t!==void 0&&p!=null&&a(t,["setup","generationConfig","mediaResolution"],p);const g=s(e,["seed"]);t!==void 0&&g!=null&&a(t,["setup","generationConfig","seed"],g);const y=s(e,["speechConfig"]);t!==void 0&&y!=null&&a(t,["setup","generationConfig","speechConfig"],fv(i,as(i,y)));const A=s(e,["enableAffectiveDialog"]);t!==void 0&&A!=null&&a(t,["setup","generationConfig","enableAffectiveDialog"],A);const w=s(e,["systemInstruction"]);t!==void 0&&w!=null&&a(t,["setup","systemInstruction"],Cv(i,ke(i,w)));const M=s(e,["tools"]);if(t!==void 0&&M!=null){let H=ni(i,M);Array.isArray(H)&&(H=H.map(I=>Ov(i,ti(i,I)))),a(t,["setup","tools"],H)}const D=s(e,["sessionResumption"]);t!==void 0&&D!=null&&a(t,["setup","sessionResumption"],$v(i,D));const F=s(e,["inputAudioTranscription"]);t!==void 0&&F!=null&&a(t,["setup","inputAudioTranscription"],Au());const b=s(e,["outputAudioTranscription"]);t!==void 0&&b!=null&&a(t,["setup","outputAudioTranscription"],Au());const O=s(e,["realtimeInputConfig"]);t!==void 0&&O!=null&&a(t,["setup","realtimeInputConfig"],zv(i,O));const q=s(e,["contextWindowCompression"]);t!==void 0&&q!=null&&a(t,["setup","contextWindowCompression"],Yv(i,q));const Y=s(e,["proactivity"]);return t!==void 0&&Y!=null&&a(t,["setup","proactivity"],Qv(i,Y)),n}function eT(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["setup","model"],ae(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],Xv(i,o,t)),t}function tT(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["setup","model"],ae(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],jv(i,o,t)),t}function nT(){return{}}function iT(){return{}}function oT(){return{}}function rT(){return{}}function sT(i,e){const t={},n=s(e,["media"]);n!=null&&a(t,["mediaChunks"],sf(i,n));const o=s(e,["audio"]);o!=null&&a(t,["audio"],Py(i,o));const r=s(e,["audioStreamEnd"]);r!=null&&a(t,["audioStreamEnd"],r);const l=s(e,["video"]);l!=null&&a(t,["video"],Ry(i,l));const c=s(e,["text"]);return c!=null&&a(t,["text"],c),s(e,["activityStart"])!=null&&a(t,["activityStart"],nT()),s(e,["activityEnd"])!=null&&a(t,["activityEnd"],oT()),t}function aT(i,e){const t={},n=s(e,["media"]);if(n!=null&&a(t,["mediaChunks"],sf(i,n)),s(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const o=s(e,["audioStreamEnd"]);if(o!=null&&a(t,["audioStreamEnd"],o),s(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(s(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return s(e,["activityStart"])!=null&&a(t,["activityStart"],iT()),s(e,["activityEnd"])!=null&&a(t,["activityEnd"],rT()),t}function gf(i,e){const t={},n=s(e,["text"]);n!=null&&a(t,["text"],n);const o=s(e,["weight"]);return o!=null&&a(t,["weight"],o),t}function lT(i,e){const t={},n=s(e,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>gf(i,r))),a(t,["weightedPrompts"],o)}return t}function yf(i,e){const t={},n=s(e,["temperature"]);n!=null&&a(t,["temperature"],n);const o=s(e,["topK"]);o!=null&&a(t,["topK"],o);const r=s(e,["seed"]);r!=null&&a(t,["seed"],r);const l=s(e,["guidance"]);l!=null&&a(t,["guidance"],l);const c=s(e,["bpm"]);c!=null&&a(t,["bpm"],c);const d=s(e,["density"]);d!=null&&a(t,["density"],d);const f=s(e,["brightness"]);f!=null&&a(t,["brightness"],f);const p=s(e,["scale"]);p!=null&&a(t,["scale"],p);const g=s(e,["muteBass"]);g!=null&&a(t,["muteBass"],g);const y=s(e,["muteDrums"]);y!=null&&a(t,["muteDrums"],y);const A=s(e,["onlyBassAndDrums"]);return A!=null&&a(t,["onlyBassAndDrums"],A),t}function uT(i,e){const t={},n=s(e,["musicGenerationConfig"]);return n!=null&&a(t,["musicGenerationConfig"],yf(i,n)),t}function _f(i,e){const t={},n=s(e,["model"]);return n!=null&&a(t,["model"],n),t}function vf(i,e){const t={},n=s(e,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>gf(i,r))),a(t,["weightedPrompts"],o)}return t}function xr(i,e){const t={},n=s(e,["setup"]);n!=null&&a(t,["setup"],_f(i,n));const o=s(e,["clientContent"]);o!=null&&a(t,["clientContent"],vf(i,o));const r=s(e,["musicGenerationConfig"]);r!=null&&a(t,["musicGenerationConfig"],yf(i,r));const l=s(e,["playbackControl"]);return l!=null&&a(t,["playbackControl"],l),t}function cT(){return{}}function fT(){return{}}function dT(i,e){const t={},n=s(e,["fps"]);n!=null&&a(t,["fps"],n);const o=s(e,["endOffset"]);o!=null&&a(t,["endOffset"],o);const r=s(e,["startOffset"]);return r!=null&&a(t,["startOffset"],r),t}function hT(i,e){const t={},n=s(e,["fps"]);n!=null&&a(t,["fps"],n);const o=s(e,["endOffset"]);o!=null&&a(t,["endOffset"],o);const r=s(e,["startOffset"]);return r!=null&&a(t,["startOffset"],r),t}function pT(i,e){const t={},n=s(e,["data"]);n!=null&&a(t,["data"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function mT(i,e){const t={},n=s(e,["displayName"]);n!=null&&a(t,["displayName"],n);const o=s(e,["data"]);o!=null&&a(t,["data"],o);const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function gT(i,e){const t={},n=s(e,["fileUri"]);n!=null&&a(t,["fileUri"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function yT(i,e){const t={},n=s(e,["displayName"]);n!=null&&a(t,["displayName"],n);const o=s(e,["fileUri"]);o!=null&&a(t,["fileUri"],o);const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function _T(i,e){const t={},n=s(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],dT(i,n));const o=s(e,["thought"]);o!=null&&a(t,["thought"],o);const r=s(e,["inlineData"]);r!=null&&a(t,["inlineData"],pT(i,r));const l=s(e,["fileData"]);l!=null&&a(t,["fileData"],gT(i,l));const c=s(e,["thoughtSignature"]);c!=null&&a(t,["thoughtSignature"],c);const d=s(e,["codeExecutionResult"]);d!=null&&a(t,["codeExecutionResult"],d);const f=s(e,["executableCode"]);f!=null&&a(t,["executableCode"],f);const p=s(e,["functionCall"]);p!=null&&a(t,["functionCall"],p);const g=s(e,["functionResponse"]);g!=null&&a(t,["functionResponse"],g);const y=s(e,["text"]);return y!=null&&a(t,["text"],y),t}function vT(i,e){const t={},n=s(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],hT(i,n));const o=s(e,["thought"]);o!=null&&a(t,["thought"],o);const r=s(e,["inlineData"]);r!=null&&a(t,["inlineData"],mT(i,r));const l=s(e,["fileData"]);l!=null&&a(t,["fileData"],yT(i,l));const c=s(e,["thoughtSignature"]);c!=null&&a(t,["thoughtSignature"],c);const d=s(e,["codeExecutionResult"]);d!=null&&a(t,["codeExecutionResult"],d);const f=s(e,["executableCode"]);f!=null&&a(t,["executableCode"],f);const p=s(e,["functionCall"]);p!=null&&a(t,["functionCall"],p);const g=s(e,["functionResponse"]);g!=null&&a(t,["functionResponse"],g);const y=s(e,["text"]);return y!=null&&a(t,["text"],y),t}function TT(i,e){const t={},n=s(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>_T(i,l))),a(t,["parts"],r)}const o=s(e,["role"]);return o!=null&&a(t,["role"],o),t}function CT(i,e){const t={},n=s(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>vT(i,l))),a(t,["parts"],r)}const o=s(e,["role"]);return o!=null&&a(t,["role"],o),t}function Iu(i,e){const t={},n=s(e,["text"]);n!=null&&a(t,["text"],n);const o=s(e,["finished"]);return o!=null&&a(t,["finished"],o),t}function Su(i,e){const t={},n=s(e,["text"]);n!=null&&a(t,["text"],n);const o=s(e,["finished"]);return o!=null&&a(t,["finished"],o),t}function ET(i,e){const t={},n=s(e,["retrievedUrl"]);n!=null&&a(t,["retrievedUrl"],n);const o=s(e,["urlRetrievalStatus"]);return o!=null&&a(t,["urlRetrievalStatus"],o),t}function AT(i,e){const t={},n=s(e,["urlMetadata"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>ET(i,r))),a(t,["urlMetadata"],o)}return t}function IT(i,e){const t={},n=s(e,["modelTurn"]);n!=null&&a(t,["modelTurn"],TT(i,n));const o=s(e,["turnComplete"]);o!=null&&a(t,["turnComplete"],o);const r=s(e,["interrupted"]);r!=null&&a(t,["interrupted"],r);const l=s(e,["groundingMetadata"]);l!=null&&a(t,["groundingMetadata"],l);const c=s(e,["generationComplete"]);c!=null&&a(t,["generationComplete"],c);const d=s(e,["inputTranscription"]);d!=null&&a(t,["inputTranscription"],Iu(i,d));const f=s(e,["outputTranscription"]);f!=null&&a(t,["outputTranscription"],Iu(i,f));const p=s(e,["urlContextMetadata"]);return p!=null&&a(t,["urlContextMetadata"],AT(i,p)),t}function ST(i,e){const t={},n=s(e,["modelTurn"]);n!=null&&a(t,["modelTurn"],CT(i,n));const o=s(e,["turnComplete"]);o!=null&&a(t,["turnComplete"],o);const r=s(e,["interrupted"]);r!=null&&a(t,["interrupted"],r);const l=s(e,["groundingMetadata"]);l!=null&&a(t,["groundingMetadata"],l);const c=s(e,["generationComplete"]);c!=null&&a(t,["generationComplete"],c);const d=s(e,["inputTranscription"]);d!=null&&a(t,["inputTranscription"],Su(i,d));const f=s(e,["outputTranscription"]);return f!=null&&a(t,["outputTranscription"],Su(i,f)),t}function wT(i,e){const t={},n=s(e,["id"]);n!=null&&a(t,["id"],n);const o=s(e,["args"]);o!=null&&a(t,["args"],o);const r=s(e,["name"]);return r!=null&&a(t,["name"],r),t}function RT(i,e){const t={},n=s(e,["args"]);n!=null&&a(t,["args"],n);const o=s(e,["name"]);return o!=null&&a(t,["name"],o),t}function PT(i,e){const t={},n=s(e,["functionCalls"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>wT(i,r))),a(t,["functionCalls"],o)}return t}function xT(i,e){const t={},n=s(e,["functionCalls"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>RT(i,r))),a(t,["functionCalls"],o)}return t}function MT(i,e){const t={},n=s(e,["ids"]);return n!=null&&a(t,["ids"],n),t}function DT(i,e){const t={},n=s(e,["ids"]);return n!=null&&a(t,["ids"],n),t}function Ri(i,e){const t={},n=s(e,["modality"]);n!=null&&a(t,["modality"],n);const o=s(e,["tokenCount"]);return o!=null&&a(t,["tokenCount"],o),t}function Pi(i,e){const t={},n=s(e,["modality"]);n!=null&&a(t,["modality"],n);const o=s(e,["tokenCount"]);return o!=null&&a(t,["tokenCount"],o),t}function NT(i,e){const t={},n=s(e,["promptTokenCount"]);n!=null&&a(t,["promptTokenCount"],n);const o=s(e,["cachedContentTokenCount"]);o!=null&&a(t,["cachedContentTokenCount"],o);const r=s(e,["responseTokenCount"]);r!=null&&a(t,["responseTokenCount"],r);const l=s(e,["toolUsePromptTokenCount"]);l!=null&&a(t,["toolUsePromptTokenCount"],l);const c=s(e,["thoughtsTokenCount"]);c!=null&&a(t,["thoughtsTokenCount"],c);const d=s(e,["totalTokenCount"]);d!=null&&a(t,["totalTokenCount"],d);const f=s(e,["promptTokensDetails"]);if(f!=null){let A=f;Array.isArray(A)&&(A=A.map(w=>Ri(i,w))),a(t,["promptTokensDetails"],A)}const p=s(e,["cacheTokensDetails"]);if(p!=null){let A=p;Array.isArray(A)&&(A=A.map(w=>Ri(i,w))),a(t,["cacheTokensDetails"],A)}const g=s(e,["responseTokensDetails"]);if(g!=null){let A=g;Array.isArray(A)&&(A=A.map(w=>Ri(i,w))),a(t,["responseTokensDetails"],A)}const y=s(e,["toolUsePromptTokensDetails"]);if(y!=null){let A=y;Array.isArray(A)&&(A=A.map(w=>Ri(i,w))),a(t,["toolUsePromptTokensDetails"],A)}return t}function VT(i,e){const t={},n=s(e,["promptTokenCount"]);n!=null&&a(t,["promptTokenCount"],n);const o=s(e,["cachedContentTokenCount"]);o!=null&&a(t,["cachedContentTokenCount"],o);const r=s(e,["candidatesTokenCount"]);r!=null&&a(t,["responseTokenCount"],r);const l=s(e,["toolUsePromptTokenCount"]);l!=null&&a(t,["toolUsePromptTokenCount"],l);const c=s(e,["thoughtsTokenCount"]);c!=null&&a(t,["thoughtsTokenCount"],c);const d=s(e,["totalTokenCount"]);d!=null&&a(t,["totalTokenCount"],d);const f=s(e,["promptTokensDetails"]);if(f!=null){let w=f;Array.isArray(w)&&(w=w.map(M=>Pi(i,M))),a(t,["promptTokensDetails"],w)}const p=s(e,["cacheTokensDetails"]);if(p!=null){let w=p;Array.isArray(w)&&(w=w.map(M=>Pi(i,M))),a(t,["cacheTokensDetails"],w)}const g=s(e,["candidatesTokensDetails"]);if(g!=null){let w=g;Array.isArray(w)&&(w=w.map(M=>Pi(i,M))),a(t,["responseTokensDetails"],w)}const y=s(e,["toolUsePromptTokensDetails"]);if(y!=null){let w=y;Array.isArray(w)&&(w=w.map(M=>Pi(i,M))),a(t,["toolUsePromptTokensDetails"],w)}const A=s(e,["trafficType"]);return A!=null&&a(t,["trafficType"],A),t}function kT(i,e){const t={},n=s(e,["timeLeft"]);return n!=null&&a(t,["timeLeft"],n),t}function LT(i,e){const t={},n=s(e,["timeLeft"]);return n!=null&&a(t,["timeLeft"],n),t}function bT(i,e){const t={},n=s(e,["newHandle"]);n!=null&&a(t,["newHandle"],n);const o=s(e,["resumable"]);o!=null&&a(t,["resumable"],o);const r=s(e,["lastConsumedClientMessageIndex"]);return r!=null&&a(t,["lastConsumedClientMessageIndex"],r),t}function FT(i,e){const t={},n=s(e,["newHandle"]);n!=null&&a(t,["newHandle"],n);const o=s(e,["resumable"]);o!=null&&a(t,["resumable"],o);const r=s(e,["lastConsumedClientMessageIndex"]);return r!=null&&a(t,["lastConsumedClientMessageIndex"],r),t}function UT(i,e){const t={};s(e,["setupComplete"])!=null&&a(t,["setupComplete"],cT());const o=s(e,["serverContent"]);o!=null&&a(t,["serverContent"],IT(i,o));const r=s(e,["toolCall"]);r!=null&&a(t,["toolCall"],PT(i,r));const l=s(e,["toolCallCancellation"]);l!=null&&a(t,["toolCallCancellation"],MT(i,l));const c=s(e,["usageMetadata"]);c!=null&&a(t,["usageMetadata"],NT(i,c));const d=s(e,["goAway"]);d!=null&&a(t,["goAway"],kT(i,d));const f=s(e,["sessionResumptionUpdate"]);return f!=null&&a(t,["sessionResumptionUpdate"],bT(i,f)),t}function OT(i,e){const t={};s(e,["setupComplete"])!=null&&a(t,["setupComplete"],fT());const o=s(e,["serverContent"]);o!=null&&a(t,["serverContent"],ST(i,o));const r=s(e,["toolCall"]);r!=null&&a(t,["toolCall"],xT(i,r));const l=s(e,["toolCallCancellation"]);l!=null&&a(t,["toolCallCancellation"],DT(i,l));const c=s(e,["usageMetadata"]);c!=null&&a(t,["usageMetadata"],VT(i,c));const d=s(e,["goAway"]);d!=null&&a(t,["goAway"],LT(i,d));const f=s(e,["sessionResumptionUpdate"]);return f!=null&&a(t,["sessionResumptionUpdate"],FT(i,f)),t}function BT(){return{}}function $T(i,e){const t={},n=s(e,["text"]);n!=null&&a(t,["text"],n);const o=s(e,["weight"]);return o!=null&&a(t,["weight"],o),t}function GT(i,e){const t={},n=s(e,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>$T(i,r))),a(t,["weightedPrompts"],o)}return t}function qT(i,e){const t={},n=s(e,["temperature"]);n!=null&&a(t,["temperature"],n);const o=s(e,["topK"]);o!=null&&a(t,["topK"],o);const r=s(e,["seed"]);r!=null&&a(t,["seed"],r);const l=s(e,["guidance"]);l!=null&&a(t,["guidance"],l);const c=s(e,["bpm"]);c!=null&&a(t,["bpm"],c);const d=s(e,["density"]);d!=null&&a(t,["density"],d);const f=s(e,["brightness"]);f!=null&&a(t,["brightness"],f);const p=s(e,["scale"]);p!=null&&a(t,["scale"],p);const g=s(e,["muteBass"]);g!=null&&a(t,["muteBass"],g);const y=s(e,["muteDrums"]);y!=null&&a(t,["muteDrums"],y);const A=s(e,["onlyBassAndDrums"]);return A!=null&&a(t,["onlyBassAndDrums"],A),t}function HT(i,e){const t={},n=s(e,["clientContent"]);n!=null&&a(t,["clientContent"],GT(i,n));const o=s(e,["musicGenerationConfig"]);return o!=null&&a(t,["musicGenerationConfig"],qT(i,o)),t}function zT(i,e){const t={},n=s(e,["data"]);n!=null&&a(t,["data"],n);const o=s(e,["mimeType"]);o!=null&&a(t,["mimeType"],o);const r=s(e,["sourceMetadata"]);return r!=null&&a(t,["sourceMetadata"],HT(i,r)),t}function KT(i,e){const t={},n=s(e,["audioChunks"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>zT(i,r))),a(t,["audioChunks"],o)}return t}function WT(i,e){const t={},n=s(e,["text"]);n!=null&&a(t,["text"],n);const o=s(e,["filteredReason"]);return o!=null&&a(t,["filteredReason"],o),t}function JT(i,e){const t={};s(e,["setupComplete"])!=null&&a(t,["setupComplete"],BT());const o=s(e,["serverContent"]);o!=null&&a(t,["serverContent"],KT(i,o));const r=s(e,["filteredPrompt"]);return r!=null&&a(t,["filteredPrompt"],WT(i,r)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YT(i,e){const t={},n=s(e,["fps"]);n!=null&&a(t,["fps"],n);const o=s(e,["endOffset"]);o!=null&&a(t,["endOffset"],o);const r=s(e,["startOffset"]);return r!=null&&a(t,["startOffset"],r),t}function ZT(i,e){const t={};if(s(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(e,["data"]);n!=null&&a(t,["data"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function QT(i,e){const t={};if(s(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(e,["fileUri"]);n!=null&&a(t,["fileUri"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function XT(i,e){const t={},n=s(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],YT(i,n));const o=s(e,["thought"]);o!=null&&a(t,["thought"],o);const r=s(e,["inlineData"]);r!=null&&a(t,["inlineData"],ZT(i,r));const l=s(e,["fileData"]);l!=null&&a(t,["fileData"],QT(i,l));const c=s(e,["thoughtSignature"]);c!=null&&a(t,["thoughtSignature"],c);const d=s(e,["codeExecutionResult"]);d!=null&&a(t,["codeExecutionResult"],d);const f=s(e,["executableCode"]);f!=null&&a(t,["executableCode"],f);const p=s(e,["functionCall"]);p!=null&&a(t,["functionCall"],p);const g=s(e,["functionResponse"]);g!=null&&a(t,["functionResponse"],g);const y=s(e,["text"]);return y!=null&&a(t,["text"],y),t}function vo(i,e){const t={},n=s(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>XT(i,l))),a(t,["parts"],r)}const o=s(e,["role"]);return o!=null&&a(t,["role"],o),t}function jT(i,e){const t={},n=s(e,["anyOf"]);n!=null&&a(t,["anyOf"],n);const o=s(e,["default"]);o!=null&&a(t,["default"],o);const r=s(e,["description"]);r!=null&&a(t,["description"],r);const l=s(e,["enum"]);l!=null&&a(t,["enum"],l);const c=s(e,["example"]);c!=null&&a(t,["example"],c);const d=s(e,["format"]);d!=null&&a(t,["format"],d);const f=s(e,["items"]);f!=null&&a(t,["items"],f);const p=s(e,["maxItems"]);p!=null&&a(t,["maxItems"],p);const g=s(e,["maxLength"]);g!=null&&a(t,["maxLength"],g);const y=s(e,["maxProperties"]);y!=null&&a(t,["maxProperties"],y);const A=s(e,["maximum"]);A!=null&&a(t,["maximum"],A);const w=s(e,["minItems"]);w!=null&&a(t,["minItems"],w);const M=s(e,["minLength"]);M!=null&&a(t,["minLength"],M);const D=s(e,["minProperties"]);D!=null&&a(t,["minProperties"],D);const F=s(e,["minimum"]);F!=null&&a(t,["minimum"],F);const b=s(e,["nullable"]);b!=null&&a(t,["nullable"],b);const O=s(e,["pattern"]);O!=null&&a(t,["pattern"],O);const q=s(e,["properties"]);q!=null&&a(t,["properties"],q);const Y=s(e,["propertyOrdering"]);Y!=null&&a(t,["propertyOrdering"],Y);const H=s(e,["required"]);H!=null&&a(t,["required"],H);const I=s(e,["title"]);I!=null&&a(t,["title"],I);const T=s(e,["type"]);return T!=null&&a(t,["type"],T),t}function eC(i,e){const t={};if(s(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=s(e,["category"]);n!=null&&a(t,["category"],n);const o=s(e,["threshold"]);return o!=null&&a(t,["threshold"],o),t}function tC(i,e){const t={},n=s(e,["behavior"]);n!=null&&a(t,["behavior"],n);const o=s(e,["description"]);o!=null&&a(t,["description"],o);const r=s(e,["name"]);r!=null&&a(t,["name"],r);const l=s(e,["parameters"]);l!=null&&a(t,["parameters"],l);const c=s(e,["response"]);return c!=null&&a(t,["response"],c),t}function nC(i,e){const t={},n=s(e,["startTime"]);n!=null&&a(t,["startTime"],n);const o=s(e,["endTime"]);return o!=null&&a(t,["endTime"],o),t}function iC(i,e){const t={},n=s(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],nC(i,n)),t}function oC(i,e){const t={},n=s(e,["mode"]);n!=null&&a(t,["mode"],n);const o=s(e,["dynamicThreshold"]);return o!=null&&a(t,["dynamicThreshold"],o),t}function rC(i,e){const t={},n=s(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],oC(i,n)),t}function sC(){return{}}function aC(i,e){const t={},n=s(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>tC(i,f))),a(t,["functionDeclarations"],d)}if(s(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=s(e,["googleSearch"]);o!=null&&a(t,["googleSearch"],iC(i,o));const r=s(e,["googleSearchRetrieval"]);if(r!=null&&a(t,["googleSearchRetrieval"],rC(i,r)),s(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(e,["urlContext"])!=null&&a(t,["urlContext"],sC());const c=s(e,["codeExecution"]);return c!=null&&a(t,["codeExecution"],c),t}function lC(i,e){const t={},n=s(e,["mode"]);n!=null&&a(t,["mode"],n);const o=s(e,["allowedFunctionNames"]);return o!=null&&a(t,["allowedFunctionNames"],o),t}function uC(i,e){const t={},n=s(e,["latitude"]);n!=null&&a(t,["latitude"],n);const o=s(e,["longitude"]);return o!=null&&a(t,["longitude"],o),t}function cC(i,e){const t={},n=s(e,["latLng"]);n!=null&&a(t,["latLng"],uC(i,n));const o=s(e,["languageCode"]);return o!=null&&a(t,["languageCode"],o),t}function fC(i,e){const t={},n=s(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],lC(i,n));const o=s(e,["retrievalConfig"]);return o!=null&&a(t,["retrievalConfig"],cC(i,o)),t}function dC(i,e){const t={},n=s(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function Tf(i,e){const t={},n=s(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],dC(i,n)),t}function hC(i,e){const t={},n=s(e,["speaker"]);n!=null&&a(t,["speaker"],n);const o=s(e,["voiceConfig"]);return o!=null&&a(t,["voiceConfig"],Tf(i,o)),t}function pC(i,e){const t={},n=s(e,["speakerVoiceConfigs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>hC(i,r))),a(t,["speakerVoiceConfigs"],o)}return t}function mC(i,e){const t={},n=s(e,["voiceConfig"]);n!=null&&a(t,["voiceConfig"],Tf(i,n));const o=s(e,["multiSpeakerVoiceConfig"]);o!=null&&a(t,["multiSpeakerVoiceConfig"],pC(i,o));const r=s(e,["languageCode"]);return r!=null&&a(t,["languageCode"],r),t}function gC(i,e){const t={},n=s(e,["includeThoughts"]);n!=null&&a(t,["includeThoughts"],n);const o=s(e,["thinkingBudget"]);return o!=null&&a(t,["thinkingBudget"],o),t}function yC(i,e,t){const n={},o=s(e,["systemInstruction"]);t!==void 0&&o!=null&&a(t,["systemInstruction"],vo(i,ke(i,o)));const r=s(e,["temperature"]);r!=null&&a(n,["temperature"],r);const l=s(e,["topP"]);l!=null&&a(n,["topP"],l);const c=s(e,["topK"]);c!=null&&a(n,["topK"],c);const d=s(e,["candidateCount"]);d!=null&&a(n,["candidateCount"],d);const f=s(e,["maxOutputTokens"]);f!=null&&a(n,["maxOutputTokens"],f);const p=s(e,["stopSequences"]);p!=null&&a(n,["stopSequences"],p);const g=s(e,["responseLogprobs"]);g!=null&&a(n,["responseLogprobs"],g);const y=s(e,["logprobs"]);y!=null&&a(n,["logprobs"],y);const A=s(e,["presencePenalty"]);A!=null&&a(n,["presencePenalty"],A);const w=s(e,["frequencyPenalty"]);w!=null&&a(n,["frequencyPenalty"],w);const M=s(e,["seed"]);M!=null&&a(n,["seed"],M);const D=s(e,["responseMimeType"]);D!=null&&a(n,["responseMimeType"],D);const F=s(e,["responseSchema"]);if(F!=null&&a(n,["responseSchema"],jT(i,ao(i,F))),s(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(s(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const b=s(e,["safetySettings"]);if(t!==void 0&&b!=null){let E=b;Array.isArray(E)&&(E=E.map(S=>eC(i,S))),a(t,["safetySettings"],E)}const O=s(e,["tools"]);if(t!==void 0&&O!=null){let E=ni(i,O);Array.isArray(E)&&(E=E.map(S=>aC(i,ti(i,S)))),a(t,["tools"],E)}const q=s(e,["toolConfig"]);if(t!==void 0&&q!=null&&a(t,["toolConfig"],fC(i,q)),s(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const Y=s(e,["cachedContent"]);t!==void 0&&Y!=null&&a(t,["cachedContent"],vt(i,Y));const H=s(e,["responseModalities"]);H!=null&&a(n,["responseModalities"],H);const I=s(e,["mediaResolution"]);I!=null&&a(n,["mediaResolution"],I);const T=s(e,["speechConfig"]);if(T!=null&&a(n,["speechConfig"],mC(i,uf(i,T))),s(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const v=s(e,["thinkingConfig"]);return v!=null&&a(n,["thinkingConfig"],gC(i,v)),n}function wu(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["contents"]);if(o!=null){let l=He(i,o);Array.isArray(l)&&(l=l.map(c=>vo(i,c))),a(t,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(t,["generationConfig"],yC(i,r,t)),t}function _C(i,e,t){const n={},o=s(e,["taskType"]);t!==void 0&&o!=null&&a(t,["requests[]","taskType"],o);const r=s(e,["title"]);t!==void 0&&r!=null&&a(t,["requests[]","title"],r);const l=s(e,["outputDimensionality"]);if(t!==void 0&&l!=null&&a(t,["requests[]","outputDimensionality"],l),s(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(s(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function vC(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["contents"]);o!=null&&a(t,["requests[]","content"],lf(i,o));const r=s(e,["config"]);r!=null&&a(t,["config"],_C(i,r,t));const l=s(e,["model"]);return l!==void 0&&a(t,["requests[]","model"],ae(i,l)),t}function TC(i,e,t){const n={};if(s(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=s(e,["numberOfImages"]);t!==void 0&&o!=null&&a(t,["parameters","sampleCount"],o);const r=s(e,["aspectRatio"]);t!==void 0&&r!=null&&a(t,["parameters","aspectRatio"],r);const l=s(e,["guidanceScale"]);if(t!==void 0&&l!=null&&a(t,["parameters","guidanceScale"],l),s(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=s(e,["safetyFilterLevel"]);t!==void 0&&c!=null&&a(t,["parameters","safetySetting"],c);const d=s(e,["personGeneration"]);t!==void 0&&d!=null&&a(t,["parameters","personGeneration"],d);const f=s(e,["includeSafetyAttributes"]);t!==void 0&&f!=null&&a(t,["parameters","includeSafetyAttributes"],f);const p=s(e,["includeRaiReason"]);t!==void 0&&p!=null&&a(t,["parameters","includeRaiReason"],p);const g=s(e,["language"]);t!==void 0&&g!=null&&a(t,["parameters","language"],g);const y=s(e,["outputMimeType"]);t!==void 0&&y!=null&&a(t,["parameters","outputOptions","mimeType"],y);const A=s(e,["outputCompressionQuality"]);if(t!==void 0&&A!=null&&a(t,["parameters","outputOptions","compressionQuality"],A),s(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(s(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function CC(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["prompt"]);o!=null&&a(t,["instances[0]","prompt"],o);const r=s(e,["config"]);return r!=null&&a(t,["config"],TC(i,r,t)),t}function EC(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","name"],ae(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function AC(i,e,t){const n={},o=s(e,["pageSize"]);t!==void 0&&o!=null&&a(t,["_query","pageSize"],o);const r=s(e,["pageToken"]);t!==void 0&&r!=null&&a(t,["_query","pageToken"],r);const l=s(e,["filter"]);t!==void 0&&l!=null&&a(t,["_query","filter"],l);const c=s(e,["queryBase"]);return t!==void 0&&c!=null&&a(t,["_url","models_url"],df(i,c)),n}function IC(i,e){const t={},n=s(e,["config"]);return n!=null&&a(t,["config"],AC(i,n,t)),t}function SC(i,e,t){const n={},o=s(e,["displayName"]);t!==void 0&&o!=null&&a(t,["displayName"],o);const r=s(e,["description"]);t!==void 0&&r!=null&&a(t,["description"],r);const l=s(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&a(t,["defaultCheckpointId"],l),n}function wC(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","name"],ae(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],SC(i,o,t)),t}function RC(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","name"],ae(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function PC(i,e){const t={};if(s(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(s(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(s(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function xC(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["contents"]);if(o!=null){let l=He(i,o);Array.isArray(l)&&(l=l.map(c=>vo(i,c))),a(t,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(t,["config"],PC(i,r)),t}function MC(i,e){const t={};if(s(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(e,["imageBytes"]);n!=null&&a(t,["bytesBase64Encoded"],rt(i,n));const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function DC(i,e,t){const n={},o=s(e,["numberOfVideos"]);if(t!==void 0&&o!=null&&a(t,["parameters","sampleCount"],o),s(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=s(e,["durationSeconds"]);if(t!==void 0&&r!=null&&a(t,["parameters","durationSeconds"],r),s(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=s(e,["aspectRatio"]);if(t!==void 0&&l!=null&&a(t,["parameters","aspectRatio"],l),s(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const c=s(e,["personGeneration"]);if(t!==void 0&&c!=null&&a(t,["parameters","personGeneration"],c),s(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=s(e,["negativePrompt"]);t!==void 0&&d!=null&&a(t,["parameters","negativePrompt"],d);const f=s(e,["enhancePrompt"]);if(t!==void 0&&f!=null&&a(t,["parameters","enhancePrompt"],f),s(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(s(e,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");return n}function NC(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["prompt"]);o!=null&&a(t,["instances[0]","prompt"],o);const r=s(e,["image"]);if(r!=null&&a(t,["instances[0]","image"],MC(i,r)),s(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const l=s(e,["config"]);return l!=null&&a(t,["config"],DC(i,l,t)),t}function VC(i,e){const t={},n=s(e,["fps"]);n!=null&&a(t,["fps"],n);const o=s(e,["endOffset"]);o!=null&&a(t,["endOffset"],o);const r=s(e,["startOffset"]);return r!=null&&a(t,["startOffset"],r),t}function kC(i,e){const t={},n=s(e,["displayName"]);n!=null&&a(t,["displayName"],n);const o=s(e,["data"]);o!=null&&a(t,["data"],o);const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function LC(i,e){const t={},n=s(e,["displayName"]);n!=null&&a(t,["displayName"],n);const o=s(e,["fileUri"]);o!=null&&a(t,["fileUri"],o);const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function bC(i,e){const t={},n=s(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],VC(i,n));const o=s(e,["thought"]);o!=null&&a(t,["thought"],o);const r=s(e,["inlineData"]);r!=null&&a(t,["inlineData"],kC(i,r));const l=s(e,["fileData"]);l!=null&&a(t,["fileData"],LC(i,l));const c=s(e,["thoughtSignature"]);c!=null&&a(t,["thoughtSignature"],c);const d=s(e,["codeExecutionResult"]);d!=null&&a(t,["codeExecutionResult"],d);const f=s(e,["executableCode"]);f!=null&&a(t,["executableCode"],f);const p=s(e,["functionCall"]);p!=null&&a(t,["functionCall"],p);const g=s(e,["functionResponse"]);g!=null&&a(t,["functionResponse"],g);const y=s(e,["text"]);return y!=null&&a(t,["text"],y),t}function hn(i,e){const t={},n=s(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>bC(i,l))),a(t,["parts"],r)}const o=s(e,["role"]);return o!=null&&a(t,["role"],o),t}function FC(i,e){const t={},n=s(e,["anyOf"]);n!=null&&a(t,["anyOf"],n);const o=s(e,["default"]);o!=null&&a(t,["default"],o);const r=s(e,["description"]);r!=null&&a(t,["description"],r);const l=s(e,["enum"]);l!=null&&a(t,["enum"],l);const c=s(e,["example"]);c!=null&&a(t,["example"],c);const d=s(e,["format"]);d!=null&&a(t,["format"],d);const f=s(e,["items"]);f!=null&&a(t,["items"],f);const p=s(e,["maxItems"]);p!=null&&a(t,["maxItems"],p);const g=s(e,["maxLength"]);g!=null&&a(t,["maxLength"],g);const y=s(e,["maxProperties"]);y!=null&&a(t,["maxProperties"],y);const A=s(e,["maximum"]);A!=null&&a(t,["maximum"],A);const w=s(e,["minItems"]);w!=null&&a(t,["minItems"],w);const M=s(e,["minLength"]);M!=null&&a(t,["minLength"],M);const D=s(e,["minProperties"]);D!=null&&a(t,["minProperties"],D);const F=s(e,["minimum"]);F!=null&&a(t,["minimum"],F);const b=s(e,["nullable"]);b!=null&&a(t,["nullable"],b);const O=s(e,["pattern"]);O!=null&&a(t,["pattern"],O);const q=s(e,["properties"]);q!=null&&a(t,["properties"],q);const Y=s(e,["propertyOrdering"]);Y!=null&&a(t,["propertyOrdering"],Y);const H=s(e,["required"]);H!=null&&a(t,["required"],H);const I=s(e,["title"]);I!=null&&a(t,["title"],I);const T=s(e,["type"]);return T!=null&&a(t,["type"],T),t}function UC(i,e){const t={},n=s(e,["featureSelectionPreference"]);return n!=null&&a(t,["featureSelectionPreference"],n),t}function OC(i,e){const t={},n=s(e,["method"]);n!=null&&a(t,["method"],n);const o=s(e,["category"]);o!=null&&a(t,["category"],o);const r=s(e,["threshold"]);return r!=null&&a(t,["threshold"],r),t}function BC(i,e){const t={};if(s(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=s(e,["description"]);n!=null&&a(t,["description"],n);const o=s(e,["name"]);o!=null&&a(t,["name"],o);const r=s(e,["parameters"]);r!=null&&a(t,["parameters"],r);const l=s(e,["response"]);return l!=null&&a(t,["response"],l),t}function $C(i,e){const t={},n=s(e,["startTime"]);n!=null&&a(t,["startTime"],n);const o=s(e,["endTime"]);return o!=null&&a(t,["endTime"],o),t}function GC(i,e){const t={},n=s(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],$C(i,n)),t}function qC(i,e){const t={},n=s(e,["mode"]);n!=null&&a(t,["mode"],n);const o=s(e,["dynamicThreshold"]);return o!=null&&a(t,["dynamicThreshold"],o),t}function HC(i,e){const t={},n=s(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],qC(i,n)),t}function zC(){return{}}function KC(i,e){const t={},n=s(e,["apiKeyString"]);return n!=null&&a(t,["apiKeyString"],n),t}function WC(i,e){const t={},n=s(e,["apiKeyConfig"]);n!=null&&a(t,["apiKeyConfig"],KC(i,n));const o=s(e,["authType"]);o!=null&&a(t,["authType"],o);const r=s(e,["googleServiceAccountConfig"]);r!=null&&a(t,["googleServiceAccountConfig"],r);const l=s(e,["httpBasicAuthConfig"]);l!=null&&a(t,["httpBasicAuthConfig"],l);const c=s(e,["oauthConfig"]);c!=null&&a(t,["oauthConfig"],c);const d=s(e,["oidcConfig"]);return d!=null&&a(t,["oidcConfig"],d),t}function JC(i,e){const t={},n=s(e,["authConfig"]);return n!=null&&a(t,["authConfig"],WC(i,n)),t}function YC(){return{}}function Cf(i,e){const t={},n=s(e,["functionDeclarations"]);if(n!=null){let g=n;Array.isArray(g)&&(g=g.map(y=>BC(i,y))),a(t,["functionDeclarations"],g)}const o=s(e,["retrieval"]);o!=null&&a(t,["retrieval"],o);const r=s(e,["googleSearch"]);r!=null&&a(t,["googleSearch"],GC(i,r));const l=s(e,["googleSearchRetrieval"]);l!=null&&a(t,["googleSearchRetrieval"],HC(i,l)),s(e,["enterpriseWebSearch"])!=null&&a(t,["enterpriseWebSearch"],zC());const d=s(e,["googleMaps"]);d!=null&&a(t,["googleMaps"],JC(i,d)),s(e,["urlContext"])!=null&&a(t,["urlContext"],YC());const p=s(e,["codeExecution"]);return p!=null&&a(t,["codeExecution"],p),t}function ZC(i,e){const t={},n=s(e,["mode"]);n!=null&&a(t,["mode"],n);const o=s(e,["allowedFunctionNames"]);return o!=null&&a(t,["allowedFunctionNames"],o),t}function QC(i,e){const t={},n=s(e,["latitude"]);n!=null&&a(t,["latitude"],n);const o=s(e,["longitude"]);return o!=null&&a(t,["longitude"],o),t}function XC(i,e){const t={},n=s(e,["latLng"]);n!=null&&a(t,["latLng"],QC(i,n));const o=s(e,["languageCode"]);return o!=null&&a(t,["languageCode"],o),t}function jC(i,e){const t={},n=s(e,["functionCallingConfig"]);n!=null&&a(t,["functionCallingConfig"],ZC(i,n));const o=s(e,["retrievalConfig"]);return o!=null&&a(t,["retrievalConfig"],XC(i,o)),t}function eE(i,e){const t={},n=s(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function tE(i,e){const t={},n=s(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],eE(i,n)),t}function nE(i,e){const t={},n=s(e,["voiceConfig"]);if(n!=null&&a(t,["voiceConfig"],tE(i,n)),s(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const o=s(e,["languageCode"]);return o!=null&&a(t,["languageCode"],o),t}function iE(i,e){const t={},n=s(e,["includeThoughts"]);n!=null&&a(t,["includeThoughts"],n);const o=s(e,["thinkingBudget"]);return o!=null&&a(t,["thinkingBudget"],o),t}function oE(i,e,t){const n={},o=s(e,["systemInstruction"]);t!==void 0&&o!=null&&a(t,["systemInstruction"],hn(i,ke(i,o)));const r=s(e,["temperature"]);r!=null&&a(n,["temperature"],r);const l=s(e,["topP"]);l!=null&&a(n,["topP"],l);const c=s(e,["topK"]);c!=null&&a(n,["topK"],c);const d=s(e,["candidateCount"]);d!=null&&a(n,["candidateCount"],d);const f=s(e,["maxOutputTokens"]);f!=null&&a(n,["maxOutputTokens"],f);const p=s(e,["stopSequences"]);p!=null&&a(n,["stopSequences"],p);const g=s(e,["responseLogprobs"]);g!=null&&a(n,["responseLogprobs"],g);const y=s(e,["logprobs"]);y!=null&&a(n,["logprobs"],y);const A=s(e,["presencePenalty"]);A!=null&&a(n,["presencePenalty"],A);const w=s(e,["frequencyPenalty"]);w!=null&&a(n,["frequencyPenalty"],w);const M=s(e,["seed"]);M!=null&&a(n,["seed"],M);const D=s(e,["responseMimeType"]);D!=null&&a(n,["responseMimeType"],D);const F=s(e,["responseSchema"]);F!=null&&a(n,["responseSchema"],FC(i,ao(i,F)));const b=s(e,["routingConfig"]);b!=null&&a(n,["routingConfig"],b);const O=s(e,["modelSelectionConfig"]);O!=null&&a(n,["modelConfig"],UC(i,O));const q=s(e,["safetySettings"]);if(t!==void 0&&q!=null){let ge=q;Array.isArray(ge)&&(ge=ge.map(Xe=>OC(i,Xe))),a(t,["safetySettings"],ge)}const Y=s(e,["tools"]);if(t!==void 0&&Y!=null){let ge=ni(i,Y);Array.isArray(ge)&&(ge=ge.map(Xe=>Cf(i,ti(i,Xe)))),a(t,["tools"],ge)}const H=s(e,["toolConfig"]);t!==void 0&&H!=null&&a(t,["toolConfig"],jC(i,H));const I=s(e,["labels"]);t!==void 0&&I!=null&&a(t,["labels"],I);const T=s(e,["cachedContent"]);t!==void 0&&T!=null&&a(t,["cachedContent"],vt(i,T));const v=s(e,["responseModalities"]);v!=null&&a(n,["responseModalities"],v);const E=s(e,["mediaResolution"]);E!=null&&a(n,["mediaResolution"],E);const S=s(e,["speechConfig"]);S!=null&&a(n,["speechConfig"],nE(i,uf(i,S)));const P=s(e,["audioTimestamp"]);P!=null&&a(n,["audioTimestamp"],P);const C=s(e,["thinkingConfig"]);return C!=null&&a(n,["thinkingConfig"],iE(i,C)),n}function Ru(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["contents"]);if(o!=null){let l=He(i,o);Array.isArray(l)&&(l=l.map(c=>hn(i,c))),a(t,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(t,["generationConfig"],oE(i,r,t)),t}function rE(i,e,t){const n={},o=s(e,["taskType"]);t!==void 0&&o!=null&&a(t,["instances[]","task_type"],o);const r=s(e,["title"]);t!==void 0&&r!=null&&a(t,["instances[]","title"],r);const l=s(e,["outputDimensionality"]);t!==void 0&&l!=null&&a(t,["parameters","outputDimensionality"],l);const c=s(e,["mimeType"]);t!==void 0&&c!=null&&a(t,["instances[]","mimeType"],c);const d=s(e,["autoTruncate"]);return t!==void 0&&d!=null&&a(t,["parameters","autoTruncate"],d),n}function sE(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["contents"]);o!=null&&a(t,["instances[]","content"],lf(i,o));const r=s(e,["config"]);return r!=null&&a(t,["config"],rE(i,r,t)),t}function aE(i,e,t){const n={},o=s(e,["outputGcsUri"]);t!==void 0&&o!=null&&a(t,["parameters","storageUri"],o);const r=s(e,["negativePrompt"]);t!==void 0&&r!=null&&a(t,["parameters","negativePrompt"],r);const l=s(e,["numberOfImages"]);t!==void 0&&l!=null&&a(t,["parameters","sampleCount"],l);const c=s(e,["aspectRatio"]);t!==void 0&&c!=null&&a(t,["parameters","aspectRatio"],c);const d=s(e,["guidanceScale"]);t!==void 0&&d!=null&&a(t,["parameters","guidanceScale"],d);const f=s(e,["seed"]);t!==void 0&&f!=null&&a(t,["parameters","seed"],f);const p=s(e,["safetyFilterLevel"]);t!==void 0&&p!=null&&a(t,["parameters","safetySetting"],p);const g=s(e,["personGeneration"]);t!==void 0&&g!=null&&a(t,["parameters","personGeneration"],g);const y=s(e,["includeSafetyAttributes"]);t!==void 0&&y!=null&&a(t,["parameters","includeSafetyAttributes"],y);const A=s(e,["includeRaiReason"]);t!==void 0&&A!=null&&a(t,["parameters","includeRaiReason"],A);const w=s(e,["language"]);t!==void 0&&w!=null&&a(t,["parameters","language"],w);const M=s(e,["outputMimeType"]);t!==void 0&&M!=null&&a(t,["parameters","outputOptions","mimeType"],M);const D=s(e,["outputCompressionQuality"]);t!==void 0&&D!=null&&a(t,["parameters","outputOptions","compressionQuality"],D);const F=s(e,["addWatermark"]);t!==void 0&&F!=null&&a(t,["parameters","addWatermark"],F);const b=s(e,["enhancePrompt"]);return t!==void 0&&b!=null&&a(t,["parameters","enhancePrompt"],b),n}function lE(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["prompt"]);o!=null&&a(t,["instances[0]","prompt"],o);const r=s(e,["config"]);return r!=null&&a(t,["config"],aE(i,r,t)),t}function To(i,e){const t={},n=s(e,["gcsUri"]);n!=null&&a(t,["gcsUri"],n);const o=s(e,["imageBytes"]);o!=null&&a(t,["bytesBase64Encoded"],rt(i,o));const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function uE(i,e){const t={},n=s(e,["maskMode"]);n!=null&&a(t,["maskMode"],n);const o=s(e,["segmentationClasses"]);o!=null&&a(t,["maskClasses"],o);const r=s(e,["maskDilation"]);return r!=null&&a(t,["dilation"],r),t}function cE(i,e){const t={},n=s(e,["controlType"]);n!=null&&a(t,["controlType"],n);const o=s(e,["enableControlImageComputation"]);return o!=null&&a(t,["computeControl"],o),t}function fE(i,e){const t={},n=s(e,["styleDescription"]);return n!=null&&a(t,["styleDescription"],n),t}function dE(i,e){const t={},n=s(e,["subjectType"]);n!=null&&a(t,["subjectType"],n);const o=s(e,["subjectDescription"]);return o!=null&&a(t,["subjectDescription"],o),t}function hE(i,e){const t={},n=s(e,["referenceImage"]);n!=null&&a(t,["referenceImage"],To(i,n));const o=s(e,["referenceId"]);o!=null&&a(t,["referenceId"],o);const r=s(e,["referenceType"]);r!=null&&a(t,["referenceType"],r);const l=s(e,["maskImageConfig"]);l!=null&&a(t,["maskImageConfig"],uE(i,l));const c=s(e,["controlImageConfig"]);c!=null&&a(t,["controlImageConfig"],cE(i,c));const d=s(e,["styleImageConfig"]);d!=null&&a(t,["styleImageConfig"],fE(i,d));const f=s(e,["subjectImageConfig"]);return f!=null&&a(t,["subjectImageConfig"],dE(i,f)),t}function pE(i,e,t){const n={},o=s(e,["outputGcsUri"]);t!==void 0&&o!=null&&a(t,["parameters","storageUri"],o);const r=s(e,["negativePrompt"]);t!==void 0&&r!=null&&a(t,["parameters","negativePrompt"],r);const l=s(e,["numberOfImages"]);t!==void 0&&l!=null&&a(t,["parameters","sampleCount"],l);const c=s(e,["aspectRatio"]);t!==void 0&&c!=null&&a(t,["parameters","aspectRatio"],c);const d=s(e,["guidanceScale"]);t!==void 0&&d!=null&&a(t,["parameters","guidanceScale"],d);const f=s(e,["seed"]);t!==void 0&&f!=null&&a(t,["parameters","seed"],f);const p=s(e,["safetyFilterLevel"]);t!==void 0&&p!=null&&a(t,["parameters","safetySetting"],p);const g=s(e,["personGeneration"]);t!==void 0&&g!=null&&a(t,["parameters","personGeneration"],g);const y=s(e,["includeSafetyAttributes"]);t!==void 0&&y!=null&&a(t,["parameters","includeSafetyAttributes"],y);const A=s(e,["includeRaiReason"]);t!==void 0&&A!=null&&a(t,["parameters","includeRaiReason"],A);const w=s(e,["language"]);t!==void 0&&w!=null&&a(t,["parameters","language"],w);const M=s(e,["outputMimeType"]);t!==void 0&&M!=null&&a(t,["parameters","outputOptions","mimeType"],M);const D=s(e,["outputCompressionQuality"]);t!==void 0&&D!=null&&a(t,["parameters","outputOptions","compressionQuality"],D);const F=s(e,["editMode"]);t!==void 0&&F!=null&&a(t,["parameters","editMode"],F);const b=s(e,["baseSteps"]);return t!==void 0&&b!=null&&a(t,["parameters","editConfig","baseSteps"],b),n}function mE(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["prompt"]);o!=null&&a(t,["instances[0]","prompt"],o);const r=s(e,["referenceImages"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>hE(i,d))),a(t,["instances[0]","referenceImages"],c)}const l=s(e,["config"]);return l!=null&&a(t,["config"],pE(i,l,t)),t}function gE(i,e,t){const n={},o=s(e,["includeRaiReason"]);t!==void 0&&o!=null&&a(t,["parameters","includeRaiReason"],o);const r=s(e,["outputMimeType"]);t!==void 0&&r!=null&&a(t,["parameters","outputOptions","mimeType"],r);const l=s(e,["outputCompressionQuality"]);t!==void 0&&l!=null&&a(t,["parameters","outputOptions","compressionQuality"],l);const c=s(e,["numberOfImages"]);t!==void 0&&c!=null&&a(t,["parameters","sampleCount"],c);const d=s(e,["mode"]);return t!==void 0&&d!=null&&a(t,["parameters","mode"],d),n}function yE(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["image"]);o!=null&&a(t,["instances[0]","image"],To(i,o));const r=s(e,["upscaleFactor"]);r!=null&&a(t,["parameters","upscaleConfig","upscaleFactor"],r);const l=s(e,["config"]);return l!=null&&a(t,["config"],gE(i,l,t)),t}function _E(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","name"],ae(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function vE(i,e,t){const n={},o=s(e,["pageSize"]);t!==void 0&&o!=null&&a(t,["_query","pageSize"],o);const r=s(e,["pageToken"]);t!==void 0&&r!=null&&a(t,["_query","pageToken"],r);const l=s(e,["filter"]);t!==void 0&&l!=null&&a(t,["_query","filter"],l);const c=s(e,["queryBase"]);return t!==void 0&&c!=null&&a(t,["_url","models_url"],df(i,c)),n}function TE(i,e){const t={},n=s(e,["config"]);return n!=null&&a(t,["config"],vE(i,n,t)),t}function CE(i,e,t){const n={},o=s(e,["displayName"]);t!==void 0&&o!=null&&a(t,["displayName"],o);const r=s(e,["description"]);t!==void 0&&r!=null&&a(t,["description"],r);const l=s(e,["defaultCheckpointId"]);return t!==void 0&&l!=null&&a(t,["defaultCheckpointId"],l),n}function EE(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],CE(i,o,t)),t}function AE(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","name"],ae(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function IE(i,e,t){const n={},o=s(e,["systemInstruction"]);t!==void 0&&o!=null&&a(t,["systemInstruction"],hn(i,ke(i,o)));const r=s(e,["tools"]);if(t!==void 0&&r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>Cf(i,d))),a(t,["tools"],c)}const l=s(e,["generationConfig"]);return t!==void 0&&l!=null&&a(t,["generationConfig"],l),n}function SE(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["contents"]);if(o!=null){let l=He(i,o);Array.isArray(l)&&(l=l.map(c=>hn(i,c))),a(t,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(t,["config"],IE(i,r,t)),t}function wE(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["contents"]);if(o!=null){let l=He(i,o);Array.isArray(l)&&(l=l.map(c=>hn(i,c))),a(t,["contents"],l)}const r=s(e,["config"]);return r!=null&&a(t,["config"],r),t}function RE(i,e){const t={},n=s(e,["uri"]);n!=null&&a(t,["gcsUri"],n);const o=s(e,["videoBytes"]);o!=null&&a(t,["bytesBase64Encoded"],rt(i,o));const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function PE(i,e,t){const n={},o=s(e,["numberOfVideos"]);t!==void 0&&o!=null&&a(t,["parameters","sampleCount"],o);const r=s(e,["outputGcsUri"]);t!==void 0&&r!=null&&a(t,["parameters","storageUri"],r);const l=s(e,["fps"]);t!==void 0&&l!=null&&a(t,["parameters","fps"],l);const c=s(e,["durationSeconds"]);t!==void 0&&c!=null&&a(t,["parameters","durationSeconds"],c);const d=s(e,["seed"]);t!==void 0&&d!=null&&a(t,["parameters","seed"],d);const f=s(e,["aspectRatio"]);t!==void 0&&f!=null&&a(t,["parameters","aspectRatio"],f);const p=s(e,["resolution"]);t!==void 0&&p!=null&&a(t,["parameters","resolution"],p);const g=s(e,["personGeneration"]);t!==void 0&&g!=null&&a(t,["parameters","personGeneration"],g);const y=s(e,["pubsubTopic"]);t!==void 0&&y!=null&&a(t,["parameters","pubsubTopic"],y);const A=s(e,["negativePrompt"]);t!==void 0&&A!=null&&a(t,["parameters","negativePrompt"],A);const w=s(e,["enhancePrompt"]);t!==void 0&&w!=null&&a(t,["parameters","enhancePrompt"],w);const M=s(e,["generateAudio"]);t!==void 0&&M!=null&&a(t,["parameters","generateAudio"],M);const D=s(e,["lastFrame"]);return t!==void 0&&D!=null&&a(t,["instances[0]","lastFrame"],To(i,D)),n}function xE(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["_url","model"],ae(i,n));const o=s(e,["prompt"]);o!=null&&a(t,["instances[0]","prompt"],o);const r=s(e,["image"]);r!=null&&a(t,["instances[0]","image"],To(i,r));const l=s(e,["video"]);l!=null&&a(t,["instances[0]","video"],RE(i,l));const c=s(e,["config"]);return c!=null&&a(t,["config"],PE(i,c,t)),t}function ME(i,e){const t={},n=s(e,["fps"]);n!=null&&a(t,["fps"],n);const o=s(e,["endOffset"]);o!=null&&a(t,["endOffset"],o);const r=s(e,["startOffset"]);return r!=null&&a(t,["startOffset"],r),t}function DE(i,e){const t={},n=s(e,["data"]);n!=null&&a(t,["data"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function NE(i,e){const t={},n=s(e,["fileUri"]);n!=null&&a(t,["fileUri"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function VE(i,e){const t={},n=s(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],ME(i,n));const o=s(e,["thought"]);o!=null&&a(t,["thought"],o);const r=s(e,["inlineData"]);r!=null&&a(t,["inlineData"],DE(i,r));const l=s(e,["fileData"]);l!=null&&a(t,["fileData"],NE(i,l));const c=s(e,["thoughtSignature"]);c!=null&&a(t,["thoughtSignature"],c);const d=s(e,["codeExecutionResult"]);d!=null&&a(t,["codeExecutionResult"],d);const f=s(e,["executableCode"]);f!=null&&a(t,["executableCode"],f);const p=s(e,["functionCall"]);p!=null&&a(t,["functionCall"],p);const g=s(e,["functionResponse"]);g!=null&&a(t,["functionResponse"],g);const y=s(e,["text"]);return y!=null&&a(t,["text"],y),t}function kE(i,e){const t={},n=s(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>VE(i,l))),a(t,["parts"],r)}const o=s(e,["role"]);return o!=null&&a(t,["role"],o),t}function LE(i,e){const t={},n=s(e,["citationSources"]);return n!=null&&a(t,["citations"],n),t}function bE(i,e){const t={},n=s(e,["retrievedUrl"]);n!=null&&a(t,["retrievedUrl"],n);const o=s(e,["urlRetrievalStatus"]);return o!=null&&a(t,["urlRetrievalStatus"],o),t}function FE(i,e){const t={},n=s(e,["urlMetadata"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>bE(i,r))),a(t,["urlMetadata"],o)}return t}function UE(i,e){const t={},n=s(e,["content"]);n!=null&&a(t,["content"],kE(i,n));const o=s(e,["citationMetadata"]);o!=null&&a(t,["citationMetadata"],LE(i,o));const r=s(e,["tokenCount"]);r!=null&&a(t,["tokenCount"],r);const l=s(e,["finishReason"]);l!=null&&a(t,["finishReason"],l);const c=s(e,["urlContextMetadata"]);c!=null&&a(t,["urlContextMetadata"],FE(i,c));const d=s(e,["avgLogprobs"]);d!=null&&a(t,["avgLogprobs"],d);const f=s(e,["groundingMetadata"]);f!=null&&a(t,["groundingMetadata"],f);const p=s(e,["index"]);p!=null&&a(t,["index"],p);const g=s(e,["logprobsResult"]);g!=null&&a(t,["logprobsResult"],g);const y=s(e,["safetyRatings"]);return y!=null&&a(t,["safetyRatings"],y),t}function Pu(i,e){const t={},n=s(e,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>UE(i,d))),a(t,["candidates"],c)}const o=s(e,["modelVersion"]);o!=null&&a(t,["modelVersion"],o);const r=s(e,["promptFeedback"]);r!=null&&a(t,["promptFeedback"],r);const l=s(e,["usageMetadata"]);return l!=null&&a(t,["usageMetadata"],l),t}function OE(i,e){const t={},n=s(e,["values"]);return n!=null&&a(t,["values"],n),t}function BE(){return{}}function $E(i,e){const t={},n=s(e,["embeddings"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>OE(i,l))),a(t,["embeddings"],r)}return s(e,["metadata"])!=null&&a(t,["metadata"],BE()),t}function GE(i,e){const t={},n=s(e,["bytesBase64Encoded"]);n!=null&&a(t,["imageBytes"],rt(i,n));const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function Ef(i,e){const t={},n=s(e,["safetyAttributes","categories"]);n!=null&&a(t,["categories"],n);const o=s(e,["safetyAttributes","scores"]);o!=null&&a(t,["scores"],o);const r=s(e,["contentType"]);return r!=null&&a(t,["contentType"],r),t}function qE(i,e){const t={},n=s(e,["_self"]);n!=null&&a(t,["image"],GE(i,n));const o=s(e,["raiFilteredReason"]);o!=null&&a(t,["raiFilteredReason"],o);const r=s(e,["_self"]);return r!=null&&a(t,["safetyAttributes"],Ef(i,r)),t}function HE(i,e){const t={},n=s(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>qE(i,l))),a(t,["generatedImages"],r)}const o=s(e,["positivePromptSafetyAttributes"]);return o!=null&&a(t,["positivePromptSafetyAttributes"],Ef(i,o)),t}function zE(i,e){const t={},n=s(e,["baseModel"]);n!=null&&a(t,["baseModel"],n);const o=s(e,["createTime"]);o!=null&&a(t,["createTime"],o);const r=s(e,["updateTime"]);return r!=null&&a(t,["updateTime"],r),t}function Mr(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["displayName"]);o!=null&&a(t,["displayName"],o);const r=s(e,["description"]);r!=null&&a(t,["description"],r);const l=s(e,["version"]);l!=null&&a(t,["version"],l);const c=s(e,["_self"]);c!=null&&a(t,["tunedModelInfo"],zE(i,c));const d=s(e,["inputTokenLimit"]);d!=null&&a(t,["inputTokenLimit"],d);const f=s(e,["outputTokenLimit"]);f!=null&&a(t,["outputTokenLimit"],f);const p=s(e,["supportedGenerationMethods"]);return p!=null&&a(t,["supportedActions"],p),t}function KE(i,e){const t={},n=s(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const o=s(e,["_self"]);if(o!=null){let r=hf(i,o);Array.isArray(r)&&(r=r.map(l=>Mr(i,l))),a(t,["models"],r)}return t}function WE(){return{}}function JE(i,e){const t={},n=s(e,["totalTokens"]);n!=null&&a(t,["totalTokens"],n);const o=s(e,["cachedContentTokenCount"]);return o!=null&&a(t,["cachedContentTokenCount"],o),t}function YE(i,e){const t={},n=s(e,["video","uri"]);n!=null&&a(t,["uri"],n);const o=s(e,["video","encodedVideo"]);o!=null&&a(t,["videoBytes"],rt(i,o));const r=s(e,["encoding"]);return r!=null&&a(t,["mimeType"],r),t}function ZE(i,e){const t={},n=s(e,["_self"]);return n!=null&&a(t,["video"],YE(i,n)),t}function QE(i,e){const t={},n=s(e,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>ZE(i,c))),a(t,["generatedVideos"],l)}const o=s(e,["raiMediaFilteredCount"]);o!=null&&a(t,["raiMediaFilteredCount"],o);const r=s(e,["raiMediaFilteredReasons"]);return r!=null&&a(t,["raiMediaFilteredReasons"],r),t}function XE(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["metadata"]);o!=null&&a(t,["metadata"],o);const r=s(e,["done"]);r!=null&&a(t,["done"],r);const l=s(e,["error"]);l!=null&&a(t,["error"],l);const c=s(e,["response","generateVideoResponse"]);return c!=null&&a(t,["response"],QE(i,c)),t}function jE(i,e){const t={},n=s(e,["fps"]);n!=null&&a(t,["fps"],n);const o=s(e,["endOffset"]);o!=null&&a(t,["endOffset"],o);const r=s(e,["startOffset"]);return r!=null&&a(t,["startOffset"],r),t}function eA(i,e){const t={},n=s(e,["displayName"]);n!=null&&a(t,["displayName"],n);const o=s(e,["data"]);o!=null&&a(t,["data"],o);const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function tA(i,e){const t={},n=s(e,["displayName"]);n!=null&&a(t,["displayName"],n);const o=s(e,["fileUri"]);o!=null&&a(t,["fileUri"],o);const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function nA(i,e){const t={},n=s(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],jE(i,n));const o=s(e,["thought"]);o!=null&&a(t,["thought"],o);const r=s(e,["inlineData"]);r!=null&&a(t,["inlineData"],eA(i,r));const l=s(e,["fileData"]);l!=null&&a(t,["fileData"],tA(i,l));const c=s(e,["thoughtSignature"]);c!=null&&a(t,["thoughtSignature"],c);const d=s(e,["codeExecutionResult"]);d!=null&&a(t,["codeExecutionResult"],d);const f=s(e,["executableCode"]);f!=null&&a(t,["executableCode"],f);const p=s(e,["functionCall"]);p!=null&&a(t,["functionCall"],p);const g=s(e,["functionResponse"]);g!=null&&a(t,["functionResponse"],g);const y=s(e,["text"]);return y!=null&&a(t,["text"],y),t}function iA(i,e){const t={},n=s(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>nA(i,l))),a(t,["parts"],r)}const o=s(e,["role"]);return o!=null&&a(t,["role"],o),t}function oA(i,e){const t={},n=s(e,["citations"]);return n!=null&&a(t,["citations"],n),t}function rA(i,e){const t={},n=s(e,["retrievedUrl"]);n!=null&&a(t,["retrievedUrl"],n);const o=s(e,["urlRetrievalStatus"]);return o!=null&&a(t,["urlRetrievalStatus"],o),t}function sA(i,e){const t={},n=s(e,["urlMetadata"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>rA(i,r))),a(t,["urlMetadata"],o)}return t}function aA(i,e){const t={},n=s(e,["content"]);n!=null&&a(t,["content"],iA(i,n));const o=s(e,["citationMetadata"]);o!=null&&a(t,["citationMetadata"],oA(i,o));const r=s(e,["finishMessage"]);r!=null&&a(t,["finishMessage"],r);const l=s(e,["finishReason"]);l!=null&&a(t,["finishReason"],l);const c=s(e,["urlContextMetadata"]);c!=null&&a(t,["urlContextMetadata"],sA(i,c));const d=s(e,["avgLogprobs"]);d!=null&&a(t,["avgLogprobs"],d);const f=s(e,["groundingMetadata"]);f!=null&&a(t,["groundingMetadata"],f);const p=s(e,["index"]);p!=null&&a(t,["index"],p);const g=s(e,["logprobsResult"]);g!=null&&a(t,["logprobsResult"],g);const y=s(e,["safetyRatings"]);return y!=null&&a(t,["safetyRatings"],y),t}function xu(i,e){const t={},n=s(e,["candidates"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(p=>aA(i,p))),a(t,["candidates"],f)}const o=s(e,["createTime"]);o!=null&&a(t,["createTime"],o);const r=s(e,["responseId"]);r!=null&&a(t,["responseId"],r);const l=s(e,["modelVersion"]);l!=null&&a(t,["modelVersion"],l);const c=s(e,["promptFeedback"]);c!=null&&a(t,["promptFeedback"],c);const d=s(e,["usageMetadata"]);return d!=null&&a(t,["usageMetadata"],d),t}function lA(i,e){const t={},n=s(e,["truncated"]);n!=null&&a(t,["truncated"],n);const o=s(e,["token_count"]);return o!=null&&a(t,["tokenCount"],o),t}function uA(i,e){const t={},n=s(e,["values"]);n!=null&&a(t,["values"],n);const o=s(e,["statistics"]);return o!=null&&a(t,["statistics"],lA(i,o)),t}function cA(i,e){const t={},n=s(e,["billableCharacterCount"]);return n!=null&&a(t,["billableCharacterCount"],n),t}function fA(i,e){const t={},n=s(e,["predictions[]","embeddings"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>uA(i,l))),a(t,["embeddings"],r)}const o=s(e,["metadata"]);return o!=null&&a(t,["metadata"],cA(i,o)),t}function dA(i,e){const t={},n=s(e,["gcsUri"]);n!=null&&a(t,["gcsUri"],n);const o=s(e,["bytesBase64Encoded"]);o!=null&&a(t,["imageBytes"],rt(i,o));const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function Af(i,e){const t={},n=s(e,["safetyAttributes","categories"]);n!=null&&a(t,["categories"],n);const o=s(e,["safetyAttributes","scores"]);o!=null&&a(t,["scores"],o);const r=s(e,["contentType"]);return r!=null&&a(t,["contentType"],r),t}function ls(i,e){const t={},n=s(e,["_self"]);n!=null&&a(t,["image"],dA(i,n));const o=s(e,["raiFilteredReason"]);o!=null&&a(t,["raiFilteredReason"],o);const r=s(e,["_self"]);r!=null&&a(t,["safetyAttributes"],Af(i,r));const l=s(e,["prompt"]);return l!=null&&a(t,["enhancedPrompt"],l),t}function hA(i,e){const t={},n=s(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>ls(i,l))),a(t,["generatedImages"],r)}const o=s(e,["positivePromptSafetyAttributes"]);return o!=null&&a(t,["positivePromptSafetyAttributes"],Af(i,o)),t}function pA(i,e){const t={},n=s(e,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>ls(i,r))),a(t,["generatedImages"],o)}return t}function mA(i,e){const t={},n=s(e,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>ls(i,r))),a(t,["generatedImages"],o)}return t}function gA(i,e){const t={},n=s(e,["endpoint"]);n!=null&&a(t,["name"],n);const o=s(e,["deployedModelId"]);return o!=null&&a(t,["deployedModelId"],o),t}function yA(i,e){const t={},n=s(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&a(t,["baseModel"],n);const o=s(e,["createTime"]);o!=null&&a(t,["createTime"],o);const r=s(e,["updateTime"]);return r!=null&&a(t,["updateTime"],r),t}function _A(i,e){const t={},n=s(e,["checkpointId"]);n!=null&&a(t,["checkpointId"],n);const o=s(e,["epoch"]);o!=null&&a(t,["epoch"],o);const r=s(e,["step"]);return r!=null&&a(t,["step"],r),t}function Dr(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["displayName"]);o!=null&&a(t,["displayName"],o);const r=s(e,["description"]);r!=null&&a(t,["description"],r);const l=s(e,["versionId"]);l!=null&&a(t,["version"],l);const c=s(e,["deployedModels"]);if(c!=null){let y=c;Array.isArray(y)&&(y=y.map(A=>gA(i,A))),a(t,["endpoints"],y)}const d=s(e,["labels"]);d!=null&&a(t,["labels"],d);const f=s(e,["_self"]);f!=null&&a(t,["tunedModelInfo"],yA(i,f));const p=s(e,["defaultCheckpointId"]);p!=null&&a(t,["defaultCheckpointId"],p);const g=s(e,["checkpoints"]);if(g!=null){let y=g;Array.isArray(y)&&(y=y.map(A=>_A(i,A))),a(t,["checkpoints"],y)}return t}function vA(i,e){const t={},n=s(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const o=s(e,["_self"]);if(o!=null){let r=hf(i,o);Array.isArray(r)&&(r=r.map(l=>Dr(i,l))),a(t,["models"],r)}return t}function TA(){return{}}function CA(i,e){const t={},n=s(e,["totalTokens"]);return n!=null&&a(t,["totalTokens"],n),t}function EA(i,e){const t={},n=s(e,["tokensInfo"]);return n!=null&&a(t,["tokensInfo"],n),t}function AA(i,e){const t={},n=s(e,["gcsUri"]);n!=null&&a(t,["uri"],n);const o=s(e,["bytesBase64Encoded"]);o!=null&&a(t,["videoBytes"],rt(i,o));const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function IA(i,e){const t={},n=s(e,["_self"]);return n!=null&&a(t,["video"],AA(i,n)),t}function SA(i,e){const t={},n=s(e,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>IA(i,c))),a(t,["generatedVideos"],l)}const o=s(e,["raiMediaFilteredCount"]);o!=null&&a(t,["raiMediaFilteredCount"],o);const r=s(e,["raiMediaFilteredReasons"]);return r!=null&&a(t,["raiMediaFilteredReasons"],r),t}function wA(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["metadata"]);o!=null&&a(t,["metadata"],o);const r=s(e,["done"]);r!=null&&a(t,["done"],r);const l=s(e,["error"]);l!=null&&a(t,["error"],l);const c=s(e,["response"]);return c!=null&&a(t,["response"],SA(i,c)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const RA="Content-Type",PA="X-Server-Timeout",xA="User-Agent",Nr="x-goog-api-client",MA="1.5.1",DA=`google-genai-sdk/${MA}`,NA="v1beta1",VA="v1beta",Mu=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class If extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class Vr extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class kA{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:NA,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:VA,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const o=[this.getRequestUrlInternal(t)];return n&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))o.searchParams.append(l,String(c));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,t,e.abortSignal),this.unaryApiCall(o,r,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[o,r]of Object.entries(t))typeof r=="object"?n[o]=Object.assign(Object.assign({},n[o]),r):r!==void 0&&(n[o]=r);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,n);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,t,e.abortSignal),this.streamApiCall(o,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n){if(t&&t.timeout||n){const o=new AbortController,r=o.signal;t.timeout&&t?.timeout>0&&setTimeout(()=>o.abort(),t.timeout),n&&n.addEventListener("abort",()=>{o.abort()}),e.signal=r}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async o=>(await Du(o),new wr(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async o=>(await Du(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){var t;return Zt(this,arguments,function*(){const o=(t=e?.body)===null||t===void 0?void 0:t.getReader(),r=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let l="";for(;;){const{done:c,value:d}=yield ue(o.read());if(c){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const f=r.decode(d);try{const g=JSON.parse(f);if("error"in g){const y=JSON.parse(JSON.stringify(g.error)),A=y.status,w=y.code,M=`got status: ${A}. ${JSON.stringify(g)}`;if(w>=400&&w<500)throw new If(M);if(w>=500&&w<600)throw new Vr(M)}}catch(g){const y=g;if(y.name==="ClientError"||y.name==="ServerError")throw g}l+=f;let p=l.match(Mu);for(;p;){const g=p[1];try{const y=new Response(g,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield ue(new wr(y)),l=l.slice(p[0].length),p=l.match(Mu)}catch(y){throw new Error(`exception parsing stream chunk ${g}. ${y}`)}}}}finally{o.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=DA+" "+this.clientOptions.userAgentExtra;return e[xA]=t,e[Nr]=t,e[RA]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[n,o]of Object.entries(e.headers))t.append(n,o);e.timeout&&e.timeout>0&&t.append(PA,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var n;const o={};t!=null&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const r=this.clientOptions.uploader,l=await r.stat(e);o.sizeBytes=String(l.size);const c=(n=t?.mimeType)!==null&&n!==void 0?n:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=c;const d=await this.fetchUploadUrl(o,t);return r.upload(e,d,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var n;let o={};t?.httpOptions?o=t.httpOptions:o={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const r={file:e},l=await this.request({path:z("upload/v1beta/files",r._url),body:JSON.stringify(r),httpMethod:"POST",httpOptions:o});if(!l||!l?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(n=l?.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function Du(i){var e;if(i===void 0)throw new Vr("response is undefined");if(!i.ok){const t=i.status,n=i.statusText;let o;!((e=i.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?o=await i.json():o={error:{message:await i.text(),code:i.status,status:i.statusText}};const r=`got status: ${t} ${n}. ${JSON.stringify(o)}`;throw t>=400&&t<500?new If(r):t>=500&&t<600?new Vr(r):new Error(r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const LA="mcp_used/unknown";function Sf(i){for(const e of i)if(us(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function wf(i){var e;const t=(e=i[Nr])!==null&&e!==void 0?e:"";i[Nr]=(t+` ${LA}`).trimStart()}function bA(i){var e,t,n;return(n=(t=(e=i.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>us(o)))!==null&&n!==void 0?n:!1}function FA(i){var e,t,n;return(n=(t=(e=i.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>!us(o)))!==null&&n!==void 0?n:!1}function us(i){return i!==null&&typeof i=="object"&&i instanceof cs}function UA(i,e=100){return Zt(this,arguments,function*(){let n,o=0;for(;o<e;){const r=yield ue(i.listTools({cursor:n}));for(const l of r.tools)yield yield ue(l),o++;if(!r.nextCursor)break;n=r.nextCursor}})}class cs{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new cs(e,t)}async initialize(){var e,t,n,o;if(this.mcpTools.length>0)return;const r={},l=[];for(const p of this.mcpClients)try{for(var c=!0,d=(t=void 0,Bn(UA(p))),f;f=await d.next(),e=f.done,!e;c=!0){o=f.value,c=!1;const g=o;l.push(g);const y=g.name;if(r[y])throw new Error(`Duplicate function name ${y} found in MCP tools. Please ensure function names are unique.`);r[y]=p}}catch(g){t={error:g}}finally{try{!c&&!e&&(n=d.return)&&await n.call(d)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),Oy(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[n.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const l=await o.callTool({name:n.name,arguments:n.args},void 0,r);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function OA(i,e,t){const n=new wy;let o;t.data instanceof Blob?o=JSON.parse(await t.data.text()):o=JSON.parse(t.data);const r=JT(i,o);Object.assign(n,r),e(n)}class BA{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),l=qA(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),d=`${o}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${c}`;let f=()=>{};const p=new Promise(O=>{f=O}),g=e.callbacks,y=function(){f({})},A=this.apiClient,w={onopen:y,onmessage:O=>{OA(A,g.onmessage,O)},onerror:(t=g?.onerror)!==null&&t!==void 0?t:function(O){},onclose:(n=g?.onclose)!==null&&n!==void 0?n:function(O){}},M=this.webSocketFactory.create(d,GA(l),w);M.connect(),await p;const D=ae(this.apiClient,e.model),F=_f(this.apiClient,{model:D}),b=xr(this.apiClient,{setup:F});return M.send(JSON.stringify(b)),new $A(M,this.apiClient)}}class $A{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=lT(this.apiClient,e),n=vf(this.apiClient,t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=uT(this.apiClient,e),n=xr(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const t=xr(this.apiClient,{playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Kt.PLAY)}pause(){this.sendPlaybackControl(Kt.PAUSE)}stop(){this.sendPlaybackControl(Kt.STOP)}resetContext(){this.sendPlaybackControl(Kt.RESET_CONTEXT)}close(){this.conn.close()}}function GA(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function qA(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const HA="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function zA(i,e,t){const n=new Sy;let o;if(t.data instanceof Blob?o=JSON.parse(await t.data.text()):o=JSON.parse(t.data),i.isVertexAI()){const r=OT(i,o);Object.assign(n,r)}else{const r=UT(i,o);Object.assign(n,r)}e(n)}class KA{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new BA(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,o,r,l,c;const d=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let p;const g=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&Sf(e.config.tools)&&wf(g);const y=ZA(g);if(this.apiClient.isVertexAI())p=`${d}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(y);else{const v=this.apiClient.getApiKey();let E="BidiGenerateContent",S="key";v?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),E="BidiGenerateContentConstrained",S="access_token"),p=`${d}/ws/google.ai.generativelanguage.${f}.GenerativeService.${E}?${S}=${v}`}let A=()=>{};const w=new Promise(v=>{A=v}),M=e.callbacks,D=function(){var v;(v=M?.onopen)===null||v===void 0||v.call(M),A({})},F=this.apiClient,b={onopen:D,onmessage:v=>{zA(F,M.onmessage,v)},onerror:(t=M?.onerror)!==null&&t!==void 0?t:function(v){},onclose:(n=M?.onclose)!==null&&n!==void 0?n:function(v){}},O=this.webSocketFactory.create(p,YA(y),b);O.connect(),await w;let q=ae(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&q.startsWith("publishers/")){const v=this.apiClient.getProject(),E=this.apiClient.getLocation();q=`projects/${v}/locations/${E}/`+q}let Y={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[ro.AUDIO]}:e.config.responseModalities=[ro.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const H=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],I=[];for(const v of H)if(this.isCallableTool(v)){const E=v;I.push(await E.tool())}else I.push(v);I.length>0&&(e.config.tools=I);const T={model:q,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?Y=tT(this.apiClient,T):Y=eT(this.apiClient,T),delete Y.config,O.send(JSON.stringify(Y)),new JA(O,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const WA={turnComplete:!0};class JA{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=He(e,t.turns),e.isVertexAI()?n=n.map(o=>hn(e,o)):n=n.map(o=>vo(e,o))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const r of n){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(HA)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},WA),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:aT(this.apiClient,e)}:t={realtimeInput:sT(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function YA(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function ZA(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Nu=10;function Vu(i){var e,t,n;if(!((e=i?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const l of(t=i?.tools)!==null&&t!==void 0?t:[])if(Li(l)){o=!0;break}if(!o)return!0;const r=(n=i?.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function Li(i){return"callTool"in i&&typeof i.callTool=="function"}function ku(i){var e;return!(!((e=i?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class QA extends dn{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,o,r,l,c;const d=await this.processParamsForMcpUsage(t);if(!bA(t)||Vu(t.config))return await this.generateContentInternal(d);if(FA(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let f,p;const g=He(this.apiClient,d.contents),y=(r=(o=(n=d.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&r!==void 0?r:Nu;let A=0;for(;A<y&&(f=await this.generateContentInternal(d),!(!f.functionCalls||f.functionCalls.length===0));){const w=f.candidates[0].content,M=[];for(const D of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(Li(D)){const b=await D.callTool(f.functionCalls);M.push(...b)}A++,p={role:"user",parts:M},d.contents=He(this.apiClient,d.contents),d.contents.push(w),d.contents.push(p),ku(d.config)&&(g.push(w),g.push(p))}return ku(d.config)&&(f.automaticFunctionCallingHistory=g),f},this.generateContentStream=async t=>{if(Vu(t.config)){const n=await this.processParamsForMcpUsage(t);return await this.generateContentStreamInternal(n)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var o;let r;const l=[];if(n?.generatedImages)for(const d of n.generatedImages)d&&d?.safetyAttributes&&((o=d?.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?r=d?.safetyAttributes:l.push(d);let c;return r?c={generatedImages:l,positivePromptSafetyAttributes:r}:c={generatedImages:l},c}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new _o(ln.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const o={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(o)}}async processParamsForMcpUsage(e){var t,n,o;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const l=await Promise.all(r.map(async d=>Li(d)?await d.tool():d)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&Sf(e.config.tools)){const d=(o=(n=e.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&o!==void 0?o:{};let f=Object.assign({},d);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),wf(f),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return c}async initAfcToolsMap(e){var t,n,o;const r=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(Li(l)){const c=l,d=await c.tool();for(const f of(o=d.functionDeclarations)!==null&&o!==void 0?o:[]){if(!f.name)throw new Error("Function declaration name is required.");if(r.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);r.set(f.name,c)}}return r}async processAfcStream(e){var t,n,o;const r=(o=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&o!==void 0?o:Nu;let l=!1,c=0;const d=await this.initAfcToolsMap(e);return function(f,p,g){var y,A;return Zt(this,arguments,function*(){for(var w,M,D,F;c<r;){l&&(c++,l=!1);const Y=yield ue(f.processParamsForMcpUsage(g)),H=yield ue(f.generateContentStreamInternal(Y)),I=[],T=[];try{for(var b=!0,O=(M=void 0,Bn(H)),q;q=yield ue(O.next()),w=q.done,!w;b=!0){F=q.value,b=!1;const v=F;if(yield yield ue(v),v.candidates&&(!((y=v.candidates[0])===null||y===void 0)&&y.content)){T.push(v.candidates[0].content);for(const E of(A=v.candidates[0].content.parts)!==null&&A!==void 0?A:[])if(c<r&&E.functionCall){if(!E.functionCall.name)throw new Error("Function call name was not returned by the model.");if(p.has(E.functionCall.name)){const S=yield ue(p.get(E.functionCall.name).callTool([E.functionCall]));I.push(...S)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${p.keys()}, mising tool: ${E.functionCall.name}`)}}}}catch(v){M={error:v}}finally{try{!b&&!w&&(D=O.return)&&(yield ue(D.call(O)))}finally{if(M)throw M.error}}if(I.length>0){l=!0;const v=new Dn;v.candidates=[{content:{role:"user",parts:I}}],yield yield ue(v);const E=[];E.push(...T),E.push({role:"user",parts:I});const S=He(f.apiClient,g.contents).concat(E);g.contents=S}else break}})}(this,d,e)}async generateContentInternal(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=Ru(this.apiClient,e);return c=z("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>{const g=xu(this.apiClient,p),y=new Dn;return Object.assign(y,g),y})}else{const f=wu(this.apiClient,e);return c=z("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=Pu(this.apiClient,p),y=new Dn;return Object.assign(y,g),y})}}async generateContentStreamInternal(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=Ru(this.apiClient,e);c=z("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query;const p=this.apiClient;return l=p.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(g){return Zt(this,arguments,function*(){var y,A,w,M;try{for(var D=!0,F=Bn(g),b;b=yield ue(F.next()),y=b.done,!y;D=!0){M=b.value,D=!1;const q=xu(p,yield ue(M.json())),Y=new Dn;Object.assign(Y,q),yield yield ue(Y)}}catch(O){A={error:O}}finally{try{!D&&!y&&(w=F.return)&&(yield ue(w.call(F)))}finally{if(A)throw A.error}}})})}else{const f=wu(this.apiClient,e);c=z("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query;const p=this.apiClient;return l=p.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(g){return Zt(this,arguments,function*(){var y,A,w,M;try{for(var D=!0,F=Bn(g),b;b=yield ue(F.next()),y=b.done,!y;D=!0){M=b.value,D=!1;const q=Pu(p,yield ue(M.json())),Y=new Dn;Object.assign(Y,q),yield yield ue(Y)}}catch(O){A={error:O}}finally{try{!D&&!y&&(w=F.return)&&(yield ue(w.call(F)))}finally{if(A)throw A.error}}})})}}async embedContent(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=sE(this.apiClient,e);return c=z("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>{const g=fA(this.apiClient,p),y=new su;return Object.assign(y,g),y})}else{const f=vC(this.apiClient,e);return c=z("{model}:batchEmbedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=$E(this.apiClient,p),y=new su;return Object.assign(y,g),y})}}async generateImagesInternal(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=lE(this.apiClient,e);return c=z("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>{const g=hA(this.apiClient,p),y=new au;return Object.assign(y,g),y})}else{const f=CC(this.apiClient,e);return c=z("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=HE(this.apiClient,p),y=new au;return Object.assign(y,g),y})}}async editImageInternal(e){var t,n;let o,r="",l={};if(this.apiClient.isVertexAI()){const c=mE(this.apiClient,e);return r=z("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>{const f=pA(this.apiClient,d),p=new vy;return Object.assign(p,f),p})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let o,r="",l={};if(this.apiClient.isVertexAI()){const c=yE(this.apiClient,e);return r=z("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>{const f=mA(this.apiClient,d),p=new Ty;return Object.assign(p,f),p})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=_E(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>Dr(this.apiClient,p))}else{const f=EC(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>Mr(this.apiClient,p))}}async listInternal(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=TE(this.apiClient,e);return c=z("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>{const g=vA(this.apiClient,p),y=new lu;return Object.assign(y,g),y})}else{const f=IC(this.apiClient,e);return c=z("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=KE(this.apiClient,p),y=new lu;return Object.assign(y,g),y})}}async update(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=EE(this.apiClient,e);return c=z("{model}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>Dr(this.apiClient,p))}else{const f=wC(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>Mr(this.apiClient,p))}}async delete(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=AE(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(()=>{const p=TA(),g=new uu;return Object.assign(g,p),g})}else{const f=RC(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(()=>{const p=WE(),g=new uu;return Object.assign(g,p),g})}}async countTokens(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=SE(this.apiClient,e);return c=z("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>{const g=CA(this.apiClient,p),y=new cu;return Object.assign(y,g),y})}else{const f=xC(this.apiClient,e);return c=z("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=JE(this.apiClient,p),y=new cu;return Object.assign(y,g),y})}}async computeTokens(e){var t,n;let o,r="",l={};if(this.apiClient.isVertexAI()){const c=wE(this.apiClient,e);return r=z("{model}:computeTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>{const f=EA(this.apiClient,d),p=new Cy;return Object.assign(p,f),p})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=xE(this.apiClient,e);return c=z("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>wA(this.apiClient,p))}else{const f=NC(this.apiClient,e);return c=z("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>XE(this.apiClient,p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XA(i,e){const t={},n=s(e,["operationName"]);n!=null&&a(t,["_url","operationName"],n);const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function jA(i,e){const t={},n=s(e,["operationName"]);n!=null&&a(t,["_url","operationName"],n);const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function eI(i,e){const t={},n=s(e,["operationName"]);n!=null&&a(t,["operationName"],n);const o=s(e,["resourceName"]);o!=null&&a(t,["_url","resourceName"],o);const r=s(e,["config"]);return r!=null&&a(t,["config"],r),t}function tI(i,e){const t={},n=s(e,["video","uri"]);n!=null&&a(t,["uri"],n);const o=s(e,["video","encodedVideo"]);o!=null&&a(t,["videoBytes"],rt(i,o));const r=s(e,["encoding"]);return r!=null&&a(t,["mimeType"],r),t}function nI(i,e){const t={},n=s(e,["_self"]);return n!=null&&a(t,["video"],tI(i,n)),t}function iI(i,e){const t={},n=s(e,["generatedSamples"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>nI(i,c))),a(t,["generatedVideos"],l)}const o=s(e,["raiMediaFilteredCount"]);o!=null&&a(t,["raiMediaFilteredCount"],o);const r=s(e,["raiMediaFilteredReasons"]);return r!=null&&a(t,["raiMediaFilteredReasons"],r),t}function oI(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["metadata"]);o!=null&&a(t,["metadata"],o);const r=s(e,["done"]);r!=null&&a(t,["done"],r);const l=s(e,["error"]);l!=null&&a(t,["error"],l);const c=s(e,["response","generateVideoResponse"]);return c!=null&&a(t,["response"],iI(i,c)),t}function rI(i,e){const t={},n=s(e,["gcsUri"]);n!=null&&a(t,["uri"],n);const o=s(e,["bytesBase64Encoded"]);o!=null&&a(t,["videoBytes"],rt(i,o));const r=s(e,["mimeType"]);return r!=null&&a(t,["mimeType"],r),t}function sI(i,e){const t={},n=s(e,["_self"]);return n!=null&&a(t,["video"],rI(i,n)),t}function aI(i,e){const t={},n=s(e,["videos"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>sI(i,c))),a(t,["generatedVideos"],l)}const o=s(e,["raiMediaFilteredCount"]);o!=null&&a(t,["raiMediaFilteredCount"],o);const r=s(e,["raiMediaFilteredReasons"]);return r!=null&&a(t,["raiMediaFilteredReasons"],r),t}function Lu(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["metadata"]);o!=null&&a(t,["metadata"],o);const r=s(e,["done"]);r!=null&&a(t,["done"],r);const l=s(e,["error"]);l!=null&&a(t,["error"],l);const c=s(e,["response"]);return c!=null&&a(t,["response"],aI(i,c)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lI extends dn{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let r;return n&&"httpOptions"in n&&(r=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:r}})}else return this.getVideosOperationInternal({operationName:t.name,config:n})}async getVideosOperationInternal(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=jA(this.apiClient,e);return c=z("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>Lu(this.apiClient,p))}else{const f=XA(this.apiClient,e);return c=z("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>oI(this.apiClient,p))}}async fetchPredictVideosOperationInternal(e){var t,n;let o,r="",l={};if(this.apiClient.isVertexAI()){const c=eI(this.apiClient,e);return r=z("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>Lu(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uI(i,e){const t={},n=s(e,["voiceName"]);return n!=null&&a(t,["voiceName"],n),t}function Rf(i,e){const t={},n=s(e,["prebuiltVoiceConfig"]);return n!=null&&a(t,["prebuiltVoiceConfig"],uI(i,n)),t}function cI(i,e){const t={},n=s(e,["speaker"]);n!=null&&a(t,["speaker"],n);const o=s(e,["voiceConfig"]);return o!=null&&a(t,["voiceConfig"],Rf(i,o)),t}function fI(i,e){const t={},n=s(e,["speakerVoiceConfigs"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>cI(i,r))),a(t,["speakerVoiceConfigs"],o)}return t}function dI(i,e){const t={},n=s(e,["voiceConfig"]);n!=null&&a(t,["voiceConfig"],Rf(i,n));const o=s(e,["multiSpeakerVoiceConfig"]);o!=null&&a(t,["multiSpeakerVoiceConfig"],fI(i,o));const r=s(e,["languageCode"]);return r!=null&&a(t,["languageCode"],r),t}function hI(i,e){const t={},n=s(e,["fps"]);n!=null&&a(t,["fps"],n);const o=s(e,["endOffset"]);o!=null&&a(t,["endOffset"],o);const r=s(e,["startOffset"]);return r!=null&&a(t,["startOffset"],r),t}function pI(i,e){const t={};if(s(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(e,["data"]);n!=null&&a(t,["data"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function mI(i,e){const t={};if(s(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(e,["fileUri"]);n!=null&&a(t,["fileUri"],n);const o=s(e,["mimeType"]);return o!=null&&a(t,["mimeType"],o),t}function gI(i,e){const t={},n=s(e,["videoMetadata"]);n!=null&&a(t,["videoMetadata"],hI(i,n));const o=s(e,["thought"]);o!=null&&a(t,["thought"],o);const r=s(e,["inlineData"]);r!=null&&a(t,["inlineData"],pI(i,r));const l=s(e,["fileData"]);l!=null&&a(t,["fileData"],mI(i,l));const c=s(e,["thoughtSignature"]);c!=null&&a(t,["thoughtSignature"],c);const d=s(e,["codeExecutionResult"]);d!=null&&a(t,["codeExecutionResult"],d);const f=s(e,["executableCode"]);f!=null&&a(t,["executableCode"],f);const p=s(e,["functionCall"]);p!=null&&a(t,["functionCall"],p);const g=s(e,["functionResponse"]);g!=null&&a(t,["functionResponse"],g);const y=s(e,["text"]);return y!=null&&a(t,["text"],y),t}function yI(i,e){const t={},n=s(e,["parts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(l=>gI(i,l))),a(t,["parts"],r)}const o=s(e,["role"]);return o!=null&&a(t,["role"],o),t}function _I(i,e){const t={},n=s(e,["behavior"]);n!=null&&a(t,["behavior"],n);const o=s(e,["description"]);o!=null&&a(t,["description"],o);const r=s(e,["name"]);r!=null&&a(t,["name"],r);const l=s(e,["parameters"]);l!=null&&a(t,["parameters"],l);const c=s(e,["response"]);return c!=null&&a(t,["response"],c),t}function vI(i,e){const t={},n=s(e,["startTime"]);n!=null&&a(t,["startTime"],n);const o=s(e,["endTime"]);return o!=null&&a(t,["endTime"],o),t}function TI(i,e){const t={},n=s(e,["timeRangeFilter"]);return n!=null&&a(t,["timeRangeFilter"],vI(i,n)),t}function CI(i,e){const t={},n=s(e,["mode"]);n!=null&&a(t,["mode"],n);const o=s(e,["dynamicThreshold"]);return o!=null&&a(t,["dynamicThreshold"],o),t}function EI(i,e){const t={},n=s(e,["dynamicRetrievalConfig"]);return n!=null&&a(t,["dynamicRetrievalConfig"],CI(i,n)),t}function AI(){return{}}function II(i,e){const t={},n=s(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>_I(i,f))),a(t,["functionDeclarations"],d)}if(s(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=s(e,["googleSearch"]);o!=null&&a(t,["googleSearch"],TI(i,o));const r=s(e,["googleSearchRetrieval"]);if(r!=null&&a(t,["googleSearchRetrieval"],EI(i,r)),s(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");s(e,["urlContext"])!=null&&a(t,["urlContext"],AI());const c=s(e,["codeExecution"]);return c!=null&&a(t,["codeExecution"],c),t}function SI(i,e){const t={},n=s(e,["handle"]);if(n!=null&&a(t,["handle"],n),s(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function bu(){return{}}function wI(i,e){const t={},n=s(e,["disabled"]);n!=null&&a(t,["disabled"],n);const o=s(e,["startOfSpeechSensitivity"]);o!=null&&a(t,["startOfSpeechSensitivity"],o);const r=s(e,["endOfSpeechSensitivity"]);r!=null&&a(t,["endOfSpeechSensitivity"],r);const l=s(e,["prefixPaddingMs"]);l!=null&&a(t,["prefixPaddingMs"],l);const c=s(e,["silenceDurationMs"]);return c!=null&&a(t,["silenceDurationMs"],c),t}function RI(i,e){const t={},n=s(e,["automaticActivityDetection"]);n!=null&&a(t,["automaticActivityDetection"],wI(i,n));const o=s(e,["activityHandling"]);o!=null&&a(t,["activityHandling"],o);const r=s(e,["turnCoverage"]);return r!=null&&a(t,["turnCoverage"],r),t}function PI(i,e){const t={},n=s(e,["targetTokens"]);return n!=null&&a(t,["targetTokens"],n),t}function xI(i,e){const t={},n=s(e,["triggerTokens"]);n!=null&&a(t,["triggerTokens"],n);const o=s(e,["slidingWindow"]);return o!=null&&a(t,["slidingWindow"],PI(i,o)),t}function MI(i,e){const t={},n=s(e,["proactiveAudio"]);return n!=null&&a(t,["proactiveAudio"],n),t}function DI(i,e,t){const n={},o=s(e,["generationConfig"]);t!==void 0&&o!=null&&a(t,["setup","generationConfig"],o);const r=s(e,["responseModalities"]);t!==void 0&&r!=null&&a(t,["setup","generationConfig","responseModalities"],r);const l=s(e,["temperature"]);t!==void 0&&l!=null&&a(t,["setup","generationConfig","temperature"],l);const c=s(e,["topP"]);t!==void 0&&c!=null&&a(t,["setup","generationConfig","topP"],c);const d=s(e,["topK"]);t!==void 0&&d!=null&&a(t,["setup","generationConfig","topK"],d);const f=s(e,["maxOutputTokens"]);t!==void 0&&f!=null&&a(t,["setup","generationConfig","maxOutputTokens"],f);const p=s(e,["mediaResolution"]);t!==void 0&&p!=null&&a(t,["setup","generationConfig","mediaResolution"],p);const g=s(e,["seed"]);t!==void 0&&g!=null&&a(t,["setup","generationConfig","seed"],g);const y=s(e,["speechConfig"]);t!==void 0&&y!=null&&a(t,["setup","generationConfig","speechConfig"],dI(i,as(i,y)));const A=s(e,["enableAffectiveDialog"]);t!==void 0&&A!=null&&a(t,["setup","generationConfig","enableAffectiveDialog"],A);const w=s(e,["systemInstruction"]);t!==void 0&&w!=null&&a(t,["setup","systemInstruction"],yI(i,ke(i,w)));const M=s(e,["tools"]);if(t!==void 0&&M!=null){let H=ni(i,M);Array.isArray(H)&&(H=H.map(I=>II(i,ti(i,I)))),a(t,["setup","tools"],H)}const D=s(e,["sessionResumption"]);t!==void 0&&D!=null&&a(t,["setup","sessionResumption"],SI(i,D));const F=s(e,["inputAudioTranscription"]);t!==void 0&&F!=null&&a(t,["setup","inputAudioTranscription"],bu());const b=s(e,["outputAudioTranscription"]);t!==void 0&&b!=null&&a(t,["setup","outputAudioTranscription"],bu());const O=s(e,["realtimeInputConfig"]);t!==void 0&&O!=null&&a(t,["setup","realtimeInputConfig"],RI(i,O));const q=s(e,["contextWindowCompression"]);t!==void 0&&q!=null&&a(t,["setup","contextWindowCompression"],xI(i,q));const Y=s(e,["proactivity"]);return t!==void 0&&Y!=null&&a(t,["setup","proactivity"],MI(i,Y)),n}function NI(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["setup","model"],ae(i,n));const o=s(e,["config"]);return o!=null&&a(t,["config"],DI(i,o,t)),t}function VI(i,e,t){const n={},o=s(e,["expireTime"]);t!==void 0&&o!=null&&a(t,["expireTime"],o);const r=s(e,["newSessionExpireTime"]);t!==void 0&&r!=null&&a(t,["newSessionExpireTime"],r);const l=s(e,["uses"]);t!==void 0&&l!=null&&a(t,["uses"],l);const c=s(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&a(t,["bidiGenerateContentSetup"],NI(i,c));const d=s(e,["lockAdditionalFields"]);return t!==void 0&&d!=null&&a(t,["fieldMask"],d),n}function kI(i,e){const t={},n=s(e,["config"]);return n!=null&&a(t,["config"],VI(i,n,t)),t}function LI(i,e){const t={},n=s(e,["name"]);return n!=null&&a(t,["name"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bI(i){const e=[];for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)){const n=i[t];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const o=Object.keys(n).map(r=>`${t}.${r}`);e.push(...o)}else e.push(t)}return e.join(",")}function FI(i,e){let t=null;const n=i.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const r=n.setup;typeof r=="object"&&r!==null?(i.bidiGenerateContentSetup=r,t=r):delete i.bidiGenerateContentSetup}else n!==void 0&&delete i.bidiGenerateContentSetup;const o=i.fieldMask;if(t){const r=bI(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)r?i.fieldMask=r:delete i.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];o.length>0&&(c=o.map(f=>l.includes(f)?`generationConfig.${f}`:f));const d=[];r&&d.push(r),c.length>0&&d.push(...c),d.length>0?i.fieldMask=d.join(","):delete i.fieldMask}else delete i.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?i.fieldMask=o.join(","):delete i.fieldMask;return i}class UI extends dn{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=kI(this.apiClient,e);r=z("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const d=FI(c,e.config);return o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),o.then(f=>LI(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OI(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["_url","name"],n);const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function BI(i,e,t){const n={},o=s(e,["pageSize"]);t!==void 0&&o!=null&&a(t,["_query","pageSize"],o);const r=s(e,["pageToken"]);t!==void 0&&r!=null&&a(t,["_query","pageToken"],r);const l=s(e,["filter"]);return t!==void 0&&l!=null&&a(t,["_query","filter"],l),n}function $I(i,e){const t={},n=s(e,["config"]);return n!=null&&a(t,["config"],BI(i,n,t)),t}function GI(i,e){const t={},n=s(e,["textInput"]);n!=null&&a(t,["textInput"],n);const o=s(e,["output"]);return o!=null&&a(t,["output"],o),t}function qI(i,e){const t={};if(s(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(e,["examples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(r=>GI(i,r))),a(t,["examples","examples"],o)}return t}function HI(i,e,t){const n={};if(s(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const o=s(e,["tunedModelDisplayName"]);if(t!==void 0&&o!=null&&a(t,["displayName"],o),s(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=s(e,["epochCount"]);t!==void 0&&r!=null&&a(t,["tuningTask","hyperparameters","epochCount"],r);const l=s(e,["learningRateMultiplier"]);if(l!=null&&a(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),s(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(s(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=s(e,["batchSize"]);t!==void 0&&c!=null&&a(t,["tuningTask","hyperparameters","batchSize"],c);const d=s(e,["learningRate"]);return t!==void 0&&d!=null&&a(t,["tuningTask","hyperparameters","learningRate"],d),n}function zI(i,e){const t={},n=s(e,["baseModel"]);n!=null&&a(t,["baseModel"],n);const o=s(e,["trainingDataset"]);o!=null&&a(t,["tuningTask","trainingData"],qI(i,o));const r=s(e,["config"]);return r!=null&&a(t,["config"],HI(i,r,t)),t}function KI(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["_url","name"],n);const o=s(e,["config"]);return o!=null&&a(t,["config"],o),t}function WI(i,e,t){const n={},o=s(e,["pageSize"]);t!==void 0&&o!=null&&a(t,["_query","pageSize"],o);const r=s(e,["pageToken"]);t!==void 0&&r!=null&&a(t,["_query","pageToken"],r);const l=s(e,["filter"]);return t!==void 0&&l!=null&&a(t,["_query","filter"],l),n}function JI(i,e){const t={},n=s(e,["config"]);return n!=null&&a(t,["config"],WI(i,n,t)),t}function YI(i,e,t){const n={},o=s(e,["gcsUri"]);if(t!==void 0&&o!=null&&a(t,["supervisedTuningSpec","trainingDatasetUri"],o),s(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function ZI(i,e){const t={},n=s(e,["gcsUri"]);return n!=null&&a(t,["validationDatasetUri"],n),t}function QI(i,e,t){const n={},o=s(e,["validationDataset"]);t!==void 0&&o!=null&&a(t,["supervisedTuningSpec"],ZI(i,o));const r=s(e,["tunedModelDisplayName"]);t!==void 0&&r!=null&&a(t,["tunedModelDisplayName"],r);const l=s(e,["description"]);t!==void 0&&l!=null&&a(t,["description"],l);const c=s(e,["epochCount"]);t!==void 0&&c!=null&&a(t,["supervisedTuningSpec","hyperParameters","epochCount"],c);const d=s(e,["learningRateMultiplier"]);t!==void 0&&d!=null&&a(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const f=s(e,["exportLastCheckpointOnly"]);t!==void 0&&f!=null&&a(t,["supervisedTuningSpec","exportLastCheckpointOnly"],f);const p=s(e,["adapterSize"]);if(t!==void 0&&p!=null&&a(t,["supervisedTuningSpec","hyperParameters","adapterSize"],p),s(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(s(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function XI(i,e){const t={},n=s(e,["baseModel"]);n!=null&&a(t,["baseModel"],n);const o=s(e,["trainingDataset"]);o!=null&&a(t,["supervisedTuningSpec","trainingDatasetUri"],YI(i,o,t));const r=s(e,["config"]);return r!=null&&a(t,["config"],QI(i,r,t)),t}function jI(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["model"],n);const o=s(e,["name"]);return o!=null&&a(t,["endpoint"],o),t}function Pf(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["state"]);o!=null&&a(t,["state"],cf(i,o));const r=s(e,["createTime"]);r!=null&&a(t,["createTime"],r);const l=s(e,["tuningTask","startTime"]);l!=null&&a(t,["startTime"],l);const c=s(e,["tuningTask","completeTime"]);c!=null&&a(t,["endTime"],c);const d=s(e,["updateTime"]);d!=null&&a(t,["updateTime"],d);const f=s(e,["description"]);f!=null&&a(t,["description"],f);const p=s(e,["baseModel"]);p!=null&&a(t,["baseModel"],p);const g=s(e,["_self"]);g!=null&&a(t,["tunedModel"],jI(i,g));const y=s(e,["distillationSpec"]);y!=null&&a(t,["distillationSpec"],y);const A=s(e,["experiment"]);A!=null&&a(t,["experiment"],A);const w=s(e,["labels"]);w!=null&&a(t,["labels"],w);const M=s(e,["pipelineJob"]);M!=null&&a(t,["pipelineJob"],M);const D=s(e,["serviceAccount"]);D!=null&&a(t,["serviceAccount"],D);const F=s(e,["tunedModelDisplayName"]);return F!=null&&a(t,["tunedModelDisplayName"],F),t}function eS(i,e){const t={},n=s(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const o=s(e,["tunedModels"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(l=>Pf(i,l))),a(t,["tuningJobs"],r)}return t}function tS(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["metadata"]);o!=null&&a(t,["metadata"],o);const r=s(e,["done"]);r!=null&&a(t,["done"],r);const l=s(e,["error"]);return l!=null&&a(t,["error"],l),t}function nS(i,e){const t={},n=s(e,["checkpointId"]);n!=null&&a(t,["checkpointId"],n);const o=s(e,["epoch"]);o!=null&&a(t,["epoch"],o);const r=s(e,["step"]);r!=null&&a(t,["step"],r);const l=s(e,["endpoint"]);return l!=null&&a(t,["endpoint"],l),t}function iS(i,e){const t={},n=s(e,["model"]);n!=null&&a(t,["model"],n);const o=s(e,["endpoint"]);o!=null&&a(t,["endpoint"],o);const r=s(e,["checkpoints"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>nS(i,c))),a(t,["checkpoints"],l)}return t}function kr(i,e){const t={},n=s(e,["name"]);n!=null&&a(t,["name"],n);const o=s(e,["state"]);o!=null&&a(t,["state"],cf(i,o));const r=s(e,["createTime"]);r!=null&&a(t,["createTime"],r);const l=s(e,["startTime"]);l!=null&&a(t,["startTime"],l);const c=s(e,["endTime"]);c!=null&&a(t,["endTime"],c);const d=s(e,["updateTime"]);d!=null&&a(t,["updateTime"],d);const f=s(e,["error"]);f!=null&&a(t,["error"],f);const p=s(e,["description"]);p!=null&&a(t,["description"],p);const g=s(e,["baseModel"]);g!=null&&a(t,["baseModel"],g);const y=s(e,["tunedModel"]);y!=null&&a(t,["tunedModel"],iS(i,y));const A=s(e,["supervisedTuningSpec"]);A!=null&&a(t,["supervisedTuningSpec"],A);const w=s(e,["tuningDataStats"]);w!=null&&a(t,["tuningDataStats"],w);const M=s(e,["encryptionSpec"]);M!=null&&a(t,["encryptionSpec"],M);const D=s(e,["partnerModelTuningSpec"]);D!=null&&a(t,["partnerModelTuningSpec"],D);const F=s(e,["distillationSpec"]);F!=null&&a(t,["distillationSpec"],F);const b=s(e,["experiment"]);b!=null&&a(t,["experiment"],b);const O=s(e,["labels"]);O!=null&&a(t,["labels"],O);const q=s(e,["pipelineJob"]);q!=null&&a(t,["pipelineJob"],q);const Y=s(e,["serviceAccount"]);Y!=null&&a(t,["serviceAccount"],Y);const H=s(e,["tunedModelDisplayName"]);return H!=null&&a(t,["tunedModelDisplayName"],H),t}function oS(i,e){const t={},n=s(e,["nextPageToken"]);n!=null&&a(t,["nextPageToken"],n);const o=s(e,["tuningJobs"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(l=>kr(i,l))),a(t,["tuningJobs"],r)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rS extends dn{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new _o(ln.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const n=await this.tuneMldevInternal(t);let o="";return n.metadata!==void 0&&n.metadata.tunedModel!==void 0?o=n.metadata.tunedModel:n.name!==void 0&&n.name.includes("/operations/")&&(o=n.name.split("/operations/")[0]),{name:o,state:Sr.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=KI(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>kr(this.apiClient,p))}else{const f=OI(this.apiClient,e);return c=z("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>Pf(this.apiClient,p))}}async listInternal(e){var t,n,o,r;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=JI(this.apiClient,e);return c=z("tuningJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),l.then(p=>{const g=oS(this.apiClient,p),y=new fu;return Object.assign(y,g),y})}else{const f=$I(this.apiClient,e);return c=z("tunedModels",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(p=>p.json()),l.then(p=>{const g=eS(this.apiClient,p),y=new fu;return Object.assign(y,g),y})}}async tuneInternal(e){var t,n;let o,r="",l={};if(this.apiClient.isVertexAI()){const c=XI(this.apiClient,e);return r=z("tuningJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>kr(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let o,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=zI(this.apiClient,e);return r=z("tunedModels",c._url),l=c._query,delete c.config,delete c._url,delete c._query,o=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),o.then(d=>tS(this.apiClient,d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sS{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const aS=1024*1024*8,lS=3,uS=1e3,cS=2,jo="x-goog-upload-status";async function fS(i,e,t){var n,o,r;let l=0,c=0,d=new wr(new Response),f="upload";for(l=i.size;c<l;){const g=Math.min(aS,l-c),y=i.slice(c,c+g);c+g>=l&&(f+=", finalize");let A=0,w=uS;for(;A<lS&&(d=await t.request({path:"",body:y,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(c),"Content-Length":String(g)}}}),!(!((n=d?.headers)===null||n===void 0)&&n[jo]));)A++,await hS(w),w=w*cS;if(c+=g,((o=d?.headers)===null||o===void 0?void 0:o[jo])!=="active")break;if(l<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const p=await d?.json();if(((r=d?.headers)===null||r===void 0?void 0:r[jo])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return p.file}async function dS(i){return{size:i.size,type:i.type}}function hS(i){return new Promise(e=>setTimeout(e,i))}class pS{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await fS(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await dS(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mS{create(e,t,n){return new gS(e,t,n)}}class gS{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Fu="x-goog-api-key";class yS{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(Fu)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Fu,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _S="gl-node/";class vS{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=_y(e,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion;const o=new yS(this.apiKey);this.apiClient=new kA({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:_S+"web",uploader:new pS,downloader:new sS}),this.models=new QA(this.apiClient),this.live=new KA(this.apiClient,o,new mS),this.chats=new z_(this.models,this.apiClient),this.caches=new G_(this.apiClient),this.files=new ov(this.apiClient),this.operations=new lI(this.apiClient),this.authTokens=new UI(this.apiClient),this.tunings=new rS(this.apiClient)}}const TS={apiKey:"AIzaSyCMGGBZDduOwQzNpPdgIZibcCB4AFPDluA",authDomain:"superfoo-3f973.firebaseapp.com",projectId:"superfoo-3f973",storageBucket:"superfoo-3f973.firebasestorage.app",messagingSenderId:"1035666447284",appId:"1:1035666447284:web:f06ba6df6da1f46a79f0e1",measurementId:"G-JM4SNNRVKW"},CS=new vS({apiKey:"AIzaSyD8DwI5G3w0JpmHDxo33qpxA1PZ-3ZeRrs"}),ES=zu(TS),AS=Eg(ES);async function IS(i){const e=await CS.models.generateContent({model:"gemini-2.0-flash",contents:`You will receive an input which may be a single word or a phrase in English or Japanese. Return a valid JSON object with the following fields:
              - "example": A natural sentence using the input phrase in its original language.
              - "meaning": The meaning of the input phrase translated into Vietnamese (not the meaning of the example).
              - "type": Either "English" or "Japanese"  the language of the input phrase.
              - "question": A multiple-choice question testing the user's understanding of the input phrase.
              - "choices": An array of 4 choices (strings). If the input is English, choices should be in Vietnamese. If the input is Japanese, choices should be in English.
              - "correctIndex": The index (03) of the correct answer inside the "choices" array.

              Only respond with a valid JSON object. Do not add explanations, extra text, or formatting.

              Let's start with the input: ${i}
              `}),t=SS(e.text);try{const n=JSON.parse(t);return console.log("Parsed JSON:",n),n}catch{return console.error(" Failed to parse JSON:",t),null}}function SS(i){return i.replace(/```json/g,"").replace(/```/g,"").trim()}async function wS(i,e="",t="",n="English"){try{const o=await IS(i);let r,l,c;o&&o.example&&o.meaning&&o.type&&(e=o.example,t=o.meaning,n=o.type,r=o.question,l=o.choices,c=o.correctIndex);const d=new Date;await Lg(Cg(AS,"vocab",i),{example:e,meaning:t,createdAt:ye.fromDate(d),type:n,question:r,choices:l,correctIndex:c}),console.log(`Saved '${i}'`)}catch(o){console.error("Failed to save word:",o.message)}}chrome.runtime.onInstalled.addListener(()=>{chrome.contextMenus.create({id:"saveSelectedText",title:"Save selected text",contexts:["selection"]})});chrome.contextMenus.onClicked.addListener(i=>{i.menuItemId==="saveSelectedText"&&wS(i.selectionText)});
